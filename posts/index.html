
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>All Posts - The first cry of Atom</title>
  <meta name="author" content="Kai Sasaki">

  
  <meta name="description" content="All Posts Noblesse Oblige in Silicon Valley To be honest, I don&rsquo;t know salesforce.com clearly because it&rsquo;s B2B company and I cannot see &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://lewuathe.github.io/posts">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="The first cry of Atom" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-44055098-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

  <body>
    <a href="/" class="home-icon">
      <img src="/images/home.png"/>
    </a>

    <div class="all-posts">
  <div class="container">
    <div class="row">
      <div class="list-title col-md-offset-3 col-md-6">
        <h4>All Posts</h4>
      </div>
    </div>
  </div>

  <div class="article-list">
    <div class="container">
      
      
      <div class="row">
        <div class="col-md-offset-3 col-md-6">
          <article>
  <h2><a href="/blog/2014/09/13/noblesse-oblige-in-silicon-valley/">Noblesse Oblige in Silicon Valley</a></h2>
  
  <p>
    <p>To be honest, I don&rsquo;t know <a href="http://salesforce.com">salesforce.com</a> clearly because it&rsquo;s B2B company and I cannot see that existence
on daily work. Though now I cannot grasp whole picture of this company yet, I want to write about charity and donation in US.</p>




  </p>
  <span class="meta">
    written 








  



<time datetime="2014-09-13T13:09:59+09:00" pubdate data-updated="true">Sep 13<span>th</span>, 2014</time>
    

in
<span class="categories">
  
    <a class='category' href='/blog/categories/opnion/'>Opnion</a>
  
</span>


  </span>

  
    <a class="full-article-link pull-right" rel="full-article" href="/blog/2014/09/13/noblesse-oblige-in-silicon-valley/">Read on &rarr;</a>
  
</article>

        </div>
      </div>
      
      
      <div class="row">
        <div class="col-md-offset-3 col-md-6">
          <article>
  <h2><a href="/blog/2014/09/12/living-in-silicon-valley/">Living in Silicon Valley</a></h2>
  
  <p>
    <p>I am not living in SF. My house is at Tokyo, Japan now. Moreover it’s the first time to visit Silicon Valley. I don’t know what I can understand from what I saw, what I felt and who I met. So it’s my review time for this trip and make use of this to know how I should live. There are 3 points.</p>




  </p>
  <span class="meta">
    written 








  



<time datetime="2014-09-12T06:06:34+09:00" pubdate data-updated="true">Sep 12<span>th</span>, 2014</time>
    

in
<span class="categories">
  
    <a class='category' href='/blog/categories/silicon-valley/'>Silicon Valley</a>
  
</span>


  </span>

  
    <a class="full-article-link pull-right" rel="full-article" href="/blog/2014/09/12/living-in-silicon-valley/">Read on &rarr;</a>
  
</article>

        </div>
      </div>
      
      
      <div class="row">
        <div class="col-md-offset-3 col-md-6">
          <article>
  <h2><a href="/blog/2014/06/19/case-class-for-swift/">Case Class for Swift</a></h2>
  
  <p>
    <p>Last week, Apple new programming language <a href="https://developer.apple.com/swift/">Swift</a> was released.
From that time I keep considering Swift looks like <a href="http://www.scala-lang.org/">Scala</a> language.
Scala has two sides as object-oriented-language and functional-programming-language. So there are many features
you should learn from scala. One of the most powerful feature of scala is pattern matching. This feature in scala context
can be applied to all type objects. It is called constructor pattern matching.</p>




  </p>
  <span class="meta">
    written 








  



<time datetime="2014-06-19T19:15:40+09:00" pubdate data-updated="true">Jun 19<span>th</span>, 2014</time>
    

in
<span class="categories">
  
    <a class='category' href='/blog/categories/case-class/'>Case class</a>, <a class='category' href='/blog/categories/scala/'>Scala</a>, <a class='category' href='/blog/categories/swift/'>Swift</a>
  
</span>


  </span>

  
    <a class="full-article-link pull-right" rel="full-article" href="/blog/2014/06/19/case-class-for-swift/">Read on &rarr;</a>
  
</article>

        </div>
      </div>
      
      
      <div class="row">
        <div class="col-md-offset-3 col-md-6">
          <article>
  <h2><a href="/blog/2014/06/13/open-source-movement-in-hardware-compan/">Welcome Open Source Movement in Hardware Company</a></h2>
  
  <p>
    <p>Today is the first day of new era for Open Source movements.</p>




<p><a href="http://www.teslamotors.com/blog/all-our-patent-are-belong-you">All Our Patent Are Belong To You</a></p>




<div style="text-align:center" markdown="1">
<figure>
<img src="/images/posts/2014-06-13-tesla/motor.jpg" />
<figure>Tesla Motor by Steve Jurvetson<a href="https://www.flickr.com/photos/jurvetson/2782565657/in/photolist-5eTnPX-kv7w5M-f7WzKj-f7WyNA-dXMDqB-6M2MHW-5eHYAq-6aJA3F-7zhWDy-4t8U5F-dXTjdG-f7WymU-f7GmqF-f7GiuB-BNTx5-6kAGXC-5t76MG-nWXsmN-6kAGoU-6aqomT-chEjh3-6kwyti-5peGWB-aXeXtc-8pSRjC-dxpQbA-atHJJo-aGXy8P-ciZHPf-f7WvB3-6kAGAd-f7Wz5Y-dZ4MiH-atAnS1-eiPF9U-6kAHnJ-dB939C-6DAEpq-dNTgjx-dXMzLa-dXTjfY-f7GjfK-f7GjLF-f7GhVc-5nwqy5-gyBgiX-dXTfQE-79tMEC-9ghJyE-brfREu">flickr</a></figcaption>
</figure>
</div>




<p>Tesla is famous for its motor products. These opened patents includes EV technologies for the future.
I think it will accelerate the speed of development of EV vehicles. So this decision plays a big role to
progress the bright future of motor technologies.</p>




<p>Above all, as a software engineer, it is great thing to spread open source movement into hardware companies.</p>


  </p>
  <span class="meta">
    written 








  



<time datetime="2014-06-13T22:00:35+09:00" pubdate data-updated="true">Jun 13<span>th</span>, 2014</time>
    

in
<span class="categories">
  
    <a class='category' href='/blog/categories/oss/'>OSS</a>, <a class='category' href='/blog/categories/open-source/'>Open Source</a>
  
</span>


  </span>

  
</article>

        </div>
      </div>
      
      
      <div class="row">
        <div class="col-md-offset-3 col-md-6">
          <article>
  <h2><a href="/blog/2014/05/26/hack-nhk/">Hack NHK</a></h2>
  
  <p>
    <p>Recently, there are a lot of hackathon in Japan. This word &ldquo;Hackathon&rdquo; also have been
familiar word to non programmers. People want to use this type of event in order to solve
any problems they have at office, home and life.</p>




<p>NHK is Japan&rsquo;s national public broadcasting organization. The name is abbreviation of &ldquo;Nippon Housou Kyoukai&rdquo;.
This organization keeps focusing to improve the quality of news broadcasting in terms of equality, accuracy and deepness.
In this weekend, Hakathon is applied to the field of broadcasting. I attended.</p>




<p><a href="http://www.nhk.or.jp/kokusaihoudou/hackathon/">http://www.nhk.or.jp/kokusaihoudou/hackathon/</a></p>




<div style="text-align:center" markdown="1">
<img src="/images/posts/2014-05-26-nhk-hackathon/board.jpg" />
</div>




  </p>
  <span class="meta">
    written 








  



<time datetime="2014-05-26T19:38:04+09:00" pubdate data-updated="true">May 26<span>th</span>, 2014</time>
    

in
<span class="categories">
  
    <a class='category' href='/blog/categories/hackathon/'>Hackathon</a>, <a class='category' href='/blog/categories/nhk/'>NHK</a>
  
</span>


  </span>

  
    <a class="full-article-link pull-right" rel="full-article" href="/blog/2014/05/26/hack-nhk/">Read on &rarr;</a>
  
</article>

        </div>
      </div>
      
      
      <div class="row">
        <div class="col-md-offset-3 col-md-6">
          <article>
  <h2><a href="/blog/2014/05/20/what-is-the-essential-factor-of-autoencoder/">What Is the Essential Factor of Autoencoder?</a></h2>
  
  <p>
    <p>The other day, I wrote neural network which implements backpropagation algorithm.
Following this program I write denoised autoencoder program by inheriting previous neural network.
Backpropagation algorithm is generally good performance in spite of the simplicity. With this code,
I can be ranked in at the <a href="http://www.kaggle.com/c/digit-recognizer/leaderboard">266th(May 20th, 2014)</a>.
So I think this implementation has no bugs. However when I use this program as autoencoder the same is not true.
With autoencoder, you should reduce dimension of input vector in order to extract essential characteristics.
These essential characteristics might be also reduced so it cannot reconstruct the same vector to input vector.
In fact after over-completed this network, I can better performance in terms of the number of accurate answers.</p>




<p>This is code.</p>




  </p>
  <span class="meta">
    written 








  



<time datetime="2014-05-20T21:08:45+09:00" pubdate data-updated="true">May 20<span>th</span>, 2014</time>
    

in
<span class="categories">
  
    <a class='category' href='/blog/categories/deep-learning/'>Deep Learning</a>, <a class='category' href='/blog/categories/machine-learning/'>Machine Learning</a>
  
</span>


  </span>

  
    <a class="full-article-link pull-right" rel="full-article" href="/blog/2014/05/20/what-is-the-essential-factor-of-autoencoder/">Read on &rarr;</a>
  
</article>

        </div>
      </div>
      
      
      <div class="row">
        <div class="col-md-offset-3 col-md-6">
          <article>
  <h2><a href="/blog/2014/04/18/dear-o/">Dear, O</a></h2>
  
  <p>
    <p>Hello, nice to meet you. I am a novice software engineer who has worked for about 2 years. An ordinary man. I have no honor, no fame and no wealth. Of course you don&rsquo;t know who I am. There is no connection between us such as email, facebook and twitter. The reason why I can mate your name and your face is no more than watching on TV. That&rsquo;s all. So in this time I dare to say that I am not familiar with you completely. Unexpectedly I don&rsquo;t know who you are in spite of writing this letter. For whom? I would like to tell the reason why I wrote this letter.</p>




<div style="text-align:center" markdown="1">
<figure>
<img src="/images/posts/2014-04-18-dearo/letter.jpg" />
<figcaption>letters by liz west on <a href="https://www.flickr.com/photos/calliope/234447967/in/photolist-mHBdk-5RPqQV-cXh1DL-2vhsbs-j7Tba3-776vPa-ajZyEo-fQmgi-5RhQdM-fKfTWx-3REdmZ-hjbY9-2C7pEL-6rX2oN-6ynR77-bD67q-Dv9uJ-dyhzBQ-82qcDP-6eQC2X-mUJC9-XStsi-DVwCv-6BKZNZ-sYMMN-8513JQ-6xQCFC-jzJhbe-8a2fw8-6tgbpA-2WigS-7ksF4s-yu5k-rMGa6-iM7AYV-jDEv9H-5rC746-5RWx65-4gr9Am-6qpt9-6Cbi7S-567fwu-94A6G9-dRwBoG-brHgHq-8EdPak-82em44-asWNj-bVUz1W-4HAhxX/">flickr</a></figcaption>
</figure>
</div>




<p></br></p>




  </p>
  <span class="meta">
    written 








  



<time datetime="2014-04-18T21:05:36+09:00" pubdate data-updated="true">Apr 18<span>th</span>, 2014</time>
    

in
<span class="categories">
  
    <a class='category' href='/blog/categories/life/'>Life</a>
  
</span>


  </span>

  
    <a class="full-article-link pull-right" rel="full-article" href="/blog/2014/04/18/dear-o/">Read on &rarr;</a>
  
</article>

        </div>
      </div>
      
      
      <div class="row">
        <div class="col-md-offset-3 col-md-6">
          <article>
  <h2><a href="/blog/2014/04/10/patterns-about-bfs-in-commetitive-programming/">Patterns About BFS in Competitive Programming</a></h2>
  
  <p>
    <p>So let&rsquo;s go back to English from today :)</p>




<p>I solved SRM612 Div1 for practice. This problem is <a href="http://community.topcoder.com/stat?c=problem_statement&amp;pm=10543">this</a>
In this post, I left out the detail of this problem because main topic of this post is pattern of <a href="http://en.wikipedia.org/wiki/Breadth-first_search">BFS</a>.
First I tried to solve this problem with some dynamic programming algorithm. But after trying, I found BFS is sufficient algorithm
to solve. So now I rewrote my program as below.</p>




  </p>
  <span class="meta">
    written 








  



<time datetime="2014-04-10T20:24:26+09:00" pubdate data-updated="true">Apr 10<span>th</span>, 2014</time>
    

in
<span class="categories">
  
    <a class='category' href='/blog/categories/bfs/'>BFS</a>, <a class='category' href='/blog/categories/competitive-programming/'>Competitive Programming</a>, <a class='category' href='/blog/categories/topcoder/'>TopCoder</a>
  
</span>


  </span>

  
    <a class="full-article-link pull-right" rel="full-article" href="/blog/2014/04/10/patterns-about-bfs-in-commetitive-programming/">Read on &rarr;</a>
  
</article>

        </div>
      </div>
      
      
      <div class="row">
        <div class="col-md-offset-3 col-md-6">
          <article>
  <h2><a href="/blog/2014/04/08/opensslfalsecui-ruo-xing-wodu-nta/">Heart Bleedを読んだ</a></h2>
  
  <p>
    <p>今日の日本時間13:00頃、OpenSSLに致命的なバグがあることがわかった。全世界で動いているSSLプロセスが影響を受ける。
簡単に言うと、メモリ上にある任意のデータを漏洩する可能性があるバグだ。
このバグはもう2年も前からあったらしいがGoogle Security TeamのNeel Mentaに見つけられたのはつい最近で、パッチがあたったのは十数時間前だ。</p>




<p><a href="https://github.com/openssl/openssl/commit/96db9023b881d7cd9f379b0c154650d6c108e9a3">Add heartbeat extension bounds check.</a></p>




<p>基本的には<a href="http://heartbleed.com/">heartbleed.com</a>に詳細が記載されていて、危険なOpenSSLのバージョン、ディストリビューションが書いてある。
対応方法も書いてある。今回はエンジニアとして、コードを読んでどういうバグだったのか理解してみたかったので書いてみる。</p>




  </p>
  <span class="meta">
    written 








  



<time datetime="2014-04-08T21:06:12+09:00" pubdate data-updated="true">Apr 8<span>th</span>, 2014</time>
    

in
<span class="categories">
  
    <a class='category' href='/blog/categories/openssl/'>OpenSSL</a>, <a class='category' href='/blog/categories/security/'>Security</a>
  
</span>


  </span>

  
    <a class="full-article-link pull-right" rel="full-article" href="/blog/2014/04/08/opensslfalsecui-ruo-xing-wodu-nta/">Read on &rarr;</a>
  
</article>

        </div>
      </div>
      
      
      <div class="row">
        <div class="col-md-offset-3 col-md-6">
          <article>
  <h2><a href="/blog/2014/03/29/wen-quan-jin-nite/">温泉津にて</a></h2>
  
  <p>
    <p>「おやすみなさい」</p>




<p>なるほど、みんな地元の人達か。温泉津で過ごす夜は少し僕を戸惑わせた。
旅館に付属していない外湯と呼ばれる湯に入りにきたため、地元の人達の憩いの場にお邪魔してしまったようだ。</p>




<div style="text-align:center" markdown="1">
<img src="/images/posts/2014-03-29-yunotsu/cat.jpg" />
</div>




<br>




<p>「じゃ、お先です」
「おやすみなさい」</p>




<p>そんなやりとりをして、みんな湯を上がっていく。僕はというとまだ湯につま先さえつけていない。何しろアツいのだ。
よくよく見てみるとみんな10秒くらいで出たり入ったりじゃないか。とりあえず入ってみるか。</p>




<p>少し鉄の味が残るアツい湯は体にいいらしいが、僕の頭にも強い刺激を与えたようだ。
この二、三日もやもやしていた気持ちが露わになってきた。</p>




  </p>
  <span class="meta">
    written 








  



<time datetime="2014-03-29T22:19:19+09:00" pubdate data-updated="true">Mar 29<span>th</span>, 2014</time>
    

in
<span class="categories">
  
    <a class='category' href='/blog/categories/life/'>Life</a>, <a class='category' href='/blog/categories/study/'>Study</a>, <a class='category' href='/blog/categories/travel/'>Travel</a>
  
</span>


  </span>

  
    <a class="full-article-link pull-right" rel="full-article" href="/blog/2014/03/29/wen-quan-jin-nite/">Read on &rarr;</a>
  
</article>

        </div>
      </div>
      
      
      <div class="row">
        <div class="col-md-offset-3 col-md-6">
          <article>
  <h2><a href="/blog/2014/03/25/shan-toshou-duan-tomu-de-to/">禅と手段と目的と</a></h2>
  
  <p>
    <p>久しぶりに日本語で書いてみる。
言葉のリズムが日本語でないと掴めない箇所があるので、やっぱり自分の母国語は日本語なんだとつくづく感じた。
言葉のリズムというのはなかなか掴みづらくて、僕の中では「つい口ずさんでみたくなる言葉」が最もリズムのいい言葉だと思っている。一昔前でいうと『<a href="http://www.amazon.co.jp/%E5%A3%B0%E3%81%AB%E5%87%BA%E3%81%97%E3%81%A6%E8%AA%AD%E3%81%BF%E3%81%9F%E3%81%84%E6%97%A5%E6%9C%AC%E8%AA%9E-%E6%96%8E%E8%97%A4-%E5%AD%9D/dp/4794210493">声に出して読みたい日本語</a>』なんていうのが流行ったけれど、あれに近いかもしれない。ただ僕の感覚はもっと俗っぽくて巷で流れているくだらないCMソングなんかはわかりやすい「つい口ずさんでみたくなる言葉」なんじゃないかと。</p>




<p>さて、手段の目的化と禅のお話。</p>




  </p>
  <span class="meta">
    written 








  



<time datetime="2014-03-25T21:01:59+09:00" pubdate data-updated="true">Mar 25<span>th</span>, 2014</time>
    

in
<span class="categories">
  
    <a class='category' href='/blog/categories/life/'>Life</a>, <a class='category' href='/blog/categories/shou-duan/'>手段</a>, <a class='category' href='/blog/categories/shan/'>禅</a>
  
</span>


  </span>

  
    <a class="full-article-link pull-right" rel="full-article" href="/blog/2014/03/25/shan-toshou-duan-tomu-de-to/">Read on &rarr;</a>
  
</article>

        </div>
      </div>
      
      
      <div class="row">
        <div class="col-md-offset-3 col-md-6">
          <article>
  <h2><a href="/blog/2014/03/19/next-tile-on-tempai/">Next Tile on Tempai</a></h2>
  
  <p>
    <p>I tried <a href="http://www.itmedia.co.jp/enterprise/articles/1004/03/news002_2.html">this problem</a>.</p>




<p>Your program receives the hand of mahjong. Returns the &ldquo;Waiting style&rdquo; of this hand.
But there are some conditions as below.</p>




<ul>
<li>There are no <em>Jihai</em>, only <em>Manzu</em></li>
<li>Make <em>Juntsu</em>, <em>Kohtsu</em> and <em>Head</em></li>
<li>Regard different order waiting as the same</li>
<li>If there are no waiting, no output</li>
</ul>




  </p>
  <span class="meta">
    written 








  



<time datetime="2014-03-19T22:57:59+09:00" pubdate data-updated="true">Mar 19<span>th</span>, 2014</time>
    

in
<span class="categories">
  
    <a class='category' href='/blog/categories/java/'>Java</a>, <a class='category' href='/blog/categories/programming/'>Programming</a>
  
</span>


  </span>

  
    <a class="full-article-link pull-right" rel="full-article" href="/blog/2014/03/19/next-tile-on-tempai/">Read on &rarr;</a>
  
</article>

        </div>
      </div>
      
      
      <div class="row">
        <div class="col-md-offset-3 col-md-6">
          <article>
  <h2><a href="/blog/2014/03/18/marble-problem/">Marble Problem</a></h2>
  
  <p>
    <p>I tried this problem.</p>




<h2>Marble</h2>




<p>There are boxes infinitely in a straight line. Each box is labeled from left side &hellip;,-2,-1,0,1,2,&hellip; to the right side.
Now <em>R</em> red marbles are in the -100th box. In the same way, <em>G</em> green mables are in the 0th box and <em>B</em> blue mables are in the 100th box.
There no other marbles in all boxes. All boxes should have one marble at most.
Repeat below process and make the number of marbles of each each at most one.</p>




<ul>
<li>Select one marble, move it left box or right box.</li>
<li>However one box must not have more than two marbles that has different colors each other</li>
</ul>




<p>Calculate minimum required steps.</p>




  </p>
  <span class="meta">
    written 








  



<time datetime="2014-03-18T21:45:14+09:00" pubdate data-updated="true">Mar 18<span>th</span>, 2014</time>
    

in
<span class="categories">
  
    <a class='category' href='/blog/categories/atcoder/'>AtCoder</a>, <a class='category' href='/blog/categories/memolization/'>memolization</a>
  
</span>


  </span>

  
    <a class="full-article-link pull-right" rel="full-article" href="/blog/2014/03/18/marble-problem/">Read on &rarr;</a>
  
</article>

        </div>
      </div>
      
      
      <div class="row">
        <div class="col-md-offset-3 col-md-6">
          <article>
  <h2><a href="/blog/2014/03/17/srm144-div1/">SRM144 Div1</a></h2>
  
  <p>
    <p>After a long time, I returned to <a href="http://www.topcoder.com/">TopCoder</a>.
I forgot to write algorithm for programming contest such as TopCoder. But previously
I realized that it is so important for me to write accurate and fast algorithm within finite time.
In order to improve my programming skill again, I returned back to the TopCoder.</p>




  </p>
  <span class="meta">
    written 








  



<time datetime="2014-03-17T21:57:38+09:00" pubdate data-updated="true">Mar 17<span>th</span>, 2014</time>
    

in
<span class="categories">
  
    <a class='category' href='/blog/categories/programming/'>Programming</a>, <a class='category' href='/blog/categories/topcoder/'>TopCoder</a>
  
</span>


  </span>

  
    <a class="full-article-link pull-right" rel="full-article" href="/blog/2014/03/17/srm144-div1/">Read on &rarr;</a>
  
</article>

        </div>
      </div>
      
      
      <div class="row">
        <div class="col-md-offset-3 col-md-6">
          <article>
  <h2><a href="/blog/2014/03/11/forget-grief-keep-data/">Forget Grief, Keep Data</a></h2>
  
  <p>
    <p>Three years ago, I walked around Shinjuku at Tokyo.
I had not yet obtained informal decision from current company for which I now work. So I walked around Shinjuku
for job hunting as pre-graduate student called &ldquo;Shukatsu-sei&rdquo; in Japanese.</p>




<p>First I wondered what happened. Then I escaped from the building shook violently.
In spite of the pleasant friday always, those who were enjoying before the weekend were not the same to the ones
of ordinary day. 2011 Tōhoku earthquake and tsunami struck Japan, my homeland.</p>




<div style="text-align:center" markdown="1">
<img src="/images/posts/2014-03-11-forget-grief/eye_catch.jpg" />
</div>




<br>




  </p>
  <span class="meta">
    written 








  



<time datetime="2014-03-11T19:48:31+09:00" pubdate data-updated="true">Mar 11<span>th</span>, 2014</time>
    

in
<span class="categories">
  
    <a class='category' href='/blog/categories/3-dot-11/'>3.11</a>, <a class='category' href='/blog/categories/earthquake/'>Earthquake</a>, <a class='category' href='/blog/categories/japan/'>Japan</a>
  
</span>


  </span>

  
    <a class="full-article-link pull-right" rel="full-article" href="/blog/2014/03/11/forget-grief-keep-data/">Read on &rarr;</a>
  
</article>

        </div>
      </div>
      
      
      <div class="row">
        <div class="col-md-offset-3 col-md-6">
          <article>
  <h2><a href="/blog/2014/03/10/difference-between-pca-and-da/">Difference Between PCA and dA</a></h2>
  
  <p>
    <p>Today I gave a presentation about Deep Learning in my office. Through this presentation, I felt
the difficulty of explanation about mathematic notion without equations. Complex concept should
be attached with some equations. Simplicity was one of the biggest purpose of my presentaion.</p>




<p>Anyway, there is a question I cannot answer clearly.</p>




<blockquote><p>What&rsquo;s the difference between <a href="http://en.wikipedia.org/wiki/Principal_component_analysis">PCA</a> and <a href="http://en.wikipedia.org/wiki/Nonlinear_dimensionality_reduction#Autoencoders">Denoised Autoencoder</a>?</p></blockquote>




<p>It was a difficult question for me. So I studied what distinguished PCA and dA primaly.</p>




  </p>
  <span class="meta">
    written 








  



<time datetime="2014-03-10T22:08:40+09:00" pubdate data-updated="true">Mar 10<span>th</span>, 2014</time>
    

in
<span class="categories">
  
    <a class='category' href='/blog/categories/machine-learning/'>Machine Learning</a>, <a class='category' href='/blog/categories/pca/'>PCA</a>, <a class='category' href='/blog/categories/da/'>dA</a>
  
</span>


  </span>

  
    <a class="full-article-link pull-right" rel="full-article" href="/blog/2014/03/10/difference-between-pca-and-da/">Read on &rarr;</a>
  
</article>

        </div>
      </div>
      
      
      <div class="row">
        <div class="col-md-offset-3 col-md-6">
          <article>
  <h2><a href="/blog/2014/03/09/logistics-regression-with-sparse-vector/">Logistics Regression With Sparse Vector</a></h2>
  
  <p>
    <p>In my project I have to develop a model that is capable of predicting the count of page view
from sparse vector data such as</p>


<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
</span><span class='line'> 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]</span></code></pre></td></tr></table></div></figure></p>

<p>However I found it was difficult to make a model which can be applied to practical use case. From sparse vector, my current model
doesn&rsquo;t look trained sufficiently. I used <a href="http://scikit-learn.org/stable/index.html">scikit-learn</a> in python.</p>




  </p>
  <span class="meta">
    written 








  



<time datetime="2014-03-09T19:54:25+09:00" pubdate data-updated="true">Mar 9<span>th</span>, 2014</time>
    

in
<span class="categories">
  
    <a class='category' href='/blog/categories/logistics-regression/'>Logistics Regression</a>, <a class='category' href='/blog/categories/machine-learning/'>Machine Learning</a>, <a class='category' href='/blog/categories/python/'>Python</a>
  
</span>


  </span>

  
    <a class="full-article-link pull-right" rel="full-article" href="/blog/2014/03/09/logistics-regression-with-sparse-vector/">Read on &rarr;</a>
  
</article>

        </div>
      </div>
      
      
      <div class="row">
        <div class="col-md-offset-3 col-md-6">
          <article>
  <h2><a href="/blog/2014/03/08/memento-pattern-in-java/">Memento Pattern in Java</a></h2>
  
  <p>
    <p>Recently, I implemented some design patterns following <a href="http://www.amazon.co.jp/%E5%A2%97%E8%A3%9C%E6%94%B9%E8%A8%82%E7%89%88Java%E8%A8%80%E8%AA%9E%E3%81%A7%E5%AD%A6%E3%81%B6%E3%83%87%E3%82%B6%E3%82%A4%E3%83%B3%E3%83%91%E3%82%BF%E3%83%BC%E3%83%B3%E5%85%A5%E9%96%80-%E7%B5%90%E5%9F%8E-%E6%B5%A9/dp/4797327030">this book</a>. This book introduces 23 design patterns that all programmers should know when you write according to OOP instructions. So now I want to write this article about some of these patterns and explain these. All codes that used in this article are put <a href="https://github.com/Lewuathe/java-GoF/tree/master/Memento">here</a></p>




  </p>
  <span class="meta">
    written 








  



<time datetime="2014-03-08T00:02:29+09:00" pubdate data-updated="true">Mar 8<span>th</span>, 2014</time>
    

in
<span class="categories">
  
    <a class='category' href='/blog/categories/design-pattern/'>Design Pattern</a>, <a class='category' href='/blog/categories/java/'>Java</a>, <a class='category' href='/blog/categories/memento/'>Memento</a>
  
</span>


  </span>

  
    <a class="full-article-link pull-right" rel="full-article" href="/blog/2014/03/08/memento-pattern-in-java/">Read on &rarr;</a>
  
</article>

        </div>
      </div>
      
      
      <div class="row">
        <div class="col-md-offset-3 col-md-6">
          <article>
  <h2><a href="/blog/2014/03/06/how-is-hashtable-written-in-java/">How Is HashMap Written in Java</a></h2>
  
  <p>
    <p>Here recently, I have a chance to read Java core API, expecially <em>HashMap</em>.
Usually, I use HashMap paying no attention to, but this code reading brought many things to me.
I can understand that how HashMap is written in Java and more this is very simple than I expected.
So in this post, I&rsquo;d like to introduce some ideas and code used in <code>java.util.HashMap</code>.</p>




  </p>
  <span class="meta">
    written 








  



<time datetime="2014-03-06T22:22:04+09:00" pubdate data-updated="true">Mar 6<span>th</span>, 2014</time>
    

in
<span class="categories">
  
    <a class='category' href='/blog/categories/hashtable/'>HashTable</a>, <a class='category' href='/blog/categories/java/'>Java</a>
  
</span>


  </span>

  
    <a class="full-article-link pull-right" rel="full-article" href="/blog/2014/03/06/how-is-hashtable-written-in-java/">Read on &rarr;</a>
  
</article>

        </div>
      </div>
      
      
      <div class="row">
        <div class="col-md-offset-3 col-md-6">
          <article>
  <h2><a href="/blog/2014/03/03/topcoder-with-intellij-idea/">TopCoder With IntelliJ IDEA</a></h2>
  
  <p>
    <p>When you try <a href="http://www.topcoder.com/">TopCoder</a>, as you know, IDE is one of the most efficient options
to write accurate code very fast. So far, <a href="https://www.eclipse.org/">Eclipse</a> is the most famous IDE in this field.
However today, I know <a href="http://www.jetbrains.com/idea/">IntelliJ IDEA</a> can also be the great editor to fight it out.
So I try to install TopCoder plugin into my IntelliJ IDEA which is called <a href="https://github.com/fadeyev/intellijcoder">IntelliJCoder</a>.</p>




  </p>
  <span class="meta">
    written 








  



<time datetime="2014-03-03T21:45:57+09:00" pubdate data-updated="true">Mar 3<span>rd</span>, 2014</time>
    

in
<span class="categories">
  
    <a class='category' href='/blog/categories/intellij-idea/'>IntelliJ IDEA</a>, <a class='category' href='/blog/categories/topcoder/'>TopCoder</a>
  
</span>


  </span>

  
    <a class="full-article-link pull-right" rel="full-article" href="/blog/2014/03/03/topcoder-with-intellij-idea/">Read on &rarr;</a>
  
</article>

        </div>
      </div>
      
      
      <div class="row">
        <div class="col-md-offset-3 col-md-6">
          <article>
  <h2><a href="/blog/2014/03/02/oobject-handler-cannot-be-called-in-php-extension/">Object Handler Cannot Be Called in Php Extension</a></h2>
  
  <p>
    <p>I have a problem.</p>




<p><a href="http://stackoverflow.com/questions/22113672/object-handler-cannot-be-called-in-php-extension">object handler cannot be called in php extension</a></p>




<p>I am developing PHP extension. However, I am not sufficient familiar with PHP extension.
So in this time, I have no answer how to solve this problem by myself.</p>




  </p>
  <span class="meta">
    written 








  



<time datetime="2014-03-02T00:38:00+09:00" pubdate data-updated="true">Mar 2<span>nd</span>, 2014</time>
    

in
<span class="categories">
  
    <a class='category' href='/blog/categories/extension/'>Extension</a>, <a class='category' href='/blog/categories/php/'>PHP</a>, <a class='category' href='/blog/categories/problem/'>Problem</a>
  
</span>


  </span>

  
    <a class="full-article-link pull-right" rel="full-article" href="/blog/2014/03/02/oobject-handler-cannot-be-called-in-php-extension/">Read on &rarr;</a>
  
</article>

        </div>
      </div>
      
      
      <div class="row">
        <div class="col-md-offset-3 col-md-6">
          <article>
  <h2><a href="/blog/2014/03/01/actor-model-with-node-cluster/">Actor Model With Node Cluster</a></h2>
  
  <p>
    <p>If you want to implement asynchronous parallel system with nodejs, the best and easiest way might be using <a href="http://nodejs.org/api/cluster.html">cluster</a>.
Cluster module is easy to use and provides you faster implementation. I wrote somewhat Actor like code that uses cluster module.</p>




  </p>
  <span class="meta">
    written 








  



<time datetime="2014-03-01T02:19:34+09:00" pubdate data-updated="true">Mar 1<span>st</span>, 2014</time>
    

in
<span class="categories">
  
    <a class='category' href='/blog/categories/actor/'>actor</a>, <a class='category' href='/blog/categories/asynchronous/'>asynchronous</a>, <a class='category' href='/blog/categories/nodejs/'>nodejs</a>
  
</span>


  </span>

  
    <a class="full-article-link pull-right" rel="full-article" href="/blog/2014/03/01/actor-model-with-node-cluster/">Read on &rarr;</a>
  
</article>

        </div>
      </div>
      
      
      <div class="row">
        <div class="col-md-offset-3 col-md-6">
          <article>
  <h2><a href="/blog/2014/02/27/tokyo-node-gakuen-11th-period/">Tokyo Node Gakuen 11th Period</a></h2>
  
  <p>
    <p>Yesterday, I took part in <a href="http://connpass.com/event/5071/">Tokyo Node Gakuen 11th period</a> for the first time.
Though I want to attend this meeting to be a node hacker for a long time, I have not been able to get a chance to do so.
About two weeks ago, I semi-completed <a href="https://github.com/Lewuathe/n42">n42</a> that implements some deep learning algorithms,
stacked denoised autoencoder, deep belief network. So time has come, and I realized that I have something to tell and
where I can convey my passions through one software stack, nodejs.</p>




  </p>
  <span class="meta">
    written 








  



<time datetime="2014-02-27T21:34:24+09:00" pubdate data-updated="true">Feb 27<span>th</span>, 2014</time>
    

in
<span class="categories">
  
    <a class='category' href='/blog/categories/deeplearning/'>DeepLearning</a>, <a class='category' href='/blog/categories/node/'>node</a>
  
</span>


  </span>

  
    <a class="full-article-link pull-right" rel="full-article" href="/blog/2014/02/27/tokyo-node-gakuen-11th-period/">Read on &rarr;</a>
  
</article>

        </div>
      </div>
      
      
      <div class="row">
        <div class="col-md-offset-3 col-md-6">
          <article>
  <h2><a href="/blog/2014/02/24/optimize-octopress-for-facebook-post/">Optimize Octopress for Facebook Post</a></h2>
  
  <p>
    <p>This blog made by <a href="http://octopress.org/">octopress</a>, ruby CMS tool.
As many others do, I also combined this tool with <a href="http://pages.github.com/">GitHub pages</a>
But this method has one fault about posting on facebook. Octopress doesn&rsquo;t include ogp properties as default. Ogp properties privide facebook meta information such as title, author, description and url. So without this meta information, you cannot get proper images when you write a post on facebook. In order to attach thumbtail image to your post, you have to write some configuration on octopress.</p>




  </p>
  <span class="meta">
    written 








  



<time datetime="2014-02-24T20:25:45+09:00" pubdate data-updated="true">Feb 24<span>th</span>, 2014</time>
    

in
<span class="categories">
  
    <a class='category' href='/blog/categories/facebook/'>facebook</a>, <a class='category' href='/blog/categories/octopress/'>octopress</a>
  
</span>


  </span>

  
    <a class="full-article-link pull-right" rel="full-article" href="/blog/2014/02/24/optimize-octopress-for-facebook-post/">Read on &rarr;</a>
  
</article>

        </div>
      </div>
      
      
      <div class="row">
        <div class="col-md-offset-3 col-md-6">
          <article>
  <h2><a href="/blog/2014/02/23/trying-word2vec-from-twitter-corpus/">Trying Word2vec From Twitter Corpus</a></h2>
  
  <p>
    <p>Do you know <a href="https://github.com/dav/word2vec">word2vec</a>? This library is one of the hottest module which provides an efficient implementation of the continuous bag-of-words and skip-gram architectures for computing vector representations of words.</p>




<p>Recently, my collegues told me what word2vec is. From that time, I want to try this library in some chance. This time, I trained this skip-gram model with twitter corpus.</p>




  </p>
  <span class="meta">
    written 








  



<time datetime="2014-02-23T17:47:16+09:00" pubdate data-updated="true">Feb 23<span>rd</span>, 2014</time>
    

in
<span class="categories">
  
    <a class='category' href='/blog/categories/corpus/'>corpus</a>, <a class='category' href='/blog/categories/twitter/'>twitter</a>, <a class='category' href='/blog/categories/word2vec/'>word2vec</a>
  
</span>


  </span>

  
    <a class="full-article-link pull-right" rel="full-article" href="/blog/2014/02/23/trying-word2vec-from-twitter-corpus/">Read on &rarr;</a>
  
</article>

        </div>
      </div>
      
      
      <div class="row">
        <div class="col-md-offset-3 col-md-6">
          <article>
  <h2><a href="/blog/2014/02/21/use-javascriptinterface-on-android/">Use JavaScriptInterface on Android</a></h2>
  
  <p>
    <p>On Android, there is a system for calling Java method from JavaScript. This is called <a href="http://developer.android.com/reference/android/webkit/JavascriptInterface.html">JavaScriptInterface</a>.
With this class, you can call Java methods run on Android application from JavaScript written on any HTML file.</p>




<p>If you want, you can write good user interface with HTML and JavaScript. And backend logic can be written by Java, Android SDK.
So this is the potential way to write Android application. Today I&rsquo;d like to introduce this way.</p>




  </p>
  <span class="meta">
    written 








  



<time datetime="2014-02-21T21:34:20+09:00" pubdate data-updated="true">Feb 21<span>st</span>, 2014</time>
    

in
<span class="categories">
  
    <a class='category' href='/blog/categories/javascript/'>JavaScript</a>, <a class='category' href='/blog/categories/android/'>android</a>
  
</span>


  </span>

  
    <a class="full-article-link pull-right" rel="full-article" href="/blog/2014/02/21/use-javascriptinterface-on-android/">Read on &rarr;</a>
  
</article>

        </div>
      </div>
      
      
      <div class="row">
        <div class="col-md-offset-3 col-md-6">
          <article>
  <h2><a href="/blog/2014/02/20/android-sdk-on-intellij-idea/">Android SDK on IntelliJ IDEA</a></h2>
  
  <p>
    <p>Eventually, I finished android lecture that is introduced on <a href="http://lewuathe.com/blog/2014/02/18/useful-shortcuts-for-intellij-idea/">previous post</a>
In this lecture, I learned how to use <a href="https://www.eclipse.org/">Eclipse</a>, <a href="http://java.com/ja/">Java</a> and of course <a href="http://developer.android.com/sdk/index.html">Android SDK</a></p>




<p>After coming home, I tried to creating a environent for android application development. However only installing Eclipse and creating same environment to lectures one
makes me tired. So I create this environment with <a href="http://www.jetbrains.com/idea/">IntelliJ IDEA</a>.</p>




  </p>
  <span class="meta">
    written 








  



<time datetime="2014-02-20T21:24:56+09:00" pubdate data-updated="true">Feb 20<span>th</span>, 2014</time>
    

in
<span class="categories">
  
    <a class='category' href='/blog/categories/android/'>Android</a>, <a class='category' href='/blog/categories/intellij-idea/'>IntelliJ IDEA</a>
  
</span>


  </span>

  
    <a class="full-article-link pull-right" rel="full-article" href="/blog/2014/02/20/android-sdk-on-intellij-idea/">Read on &rarr;</a>
  
</article>

        </div>
      </div>
      
      
      <div class="row">
        <div class="col-md-offset-3 col-md-6">
          <article>
  <h2><a href="/blog/2014/02/18/useful-shortcuts-for-intellij-idea/">Useful Shortcuts for IntelliJ IDEA</a></h2>
  
  <p>
    <p>In this week, I am attending a lecture for developing mobile application on android.
Of course I had no experience writing android applications, I have not written Java code in my life.
Through this lecture, I was so impressed by the functionality of <a href="https://www.eclipse.org/">Eclipse</a>.</p>




<p>In my life, I hate using IDE because these tools always hide a mechanism for building application.
This is why I always used emacs or vim. But today, I changed my mind. IDE is the next step for me in order to acquire new skills.
So just now I installed <a href="http://www.jetbrains.com/idea/">IntelliJ IDEA</a> which is in fashion nowadays.</p>




  </p>
  <span class="meta">
    written 








  



<time datetime="2014-02-18T21:21:10+09:00" pubdate data-updated="true">Feb 18<span>th</span>, 2014</time>
    

in
<span class="categories">
  
    <a class='category' href='/blog/categories/intellij-idea/'>IntelliJ IDEA</a>, <a class='category' href='/blog/categories/java/'>Java</a>, <a class='category' href='/blog/categories/scala/'>Scala</a>
  
</span>


  </span>

  
    <a class="full-article-link pull-right" rel="full-article" href="/blog/2014/02/18/useful-shortcuts-for-intellij-idea/">Read on &rarr;</a>
  
</article>

        </div>
      </div>
      
      
      <div class="row">
        <div class="col-md-offset-3 col-md-6">
          <article>
  <h2><a href="/blog/2014/02/17/go-and-scala-which-should-i-use/">Go and Scala, Which Should I Use?</a></h2>
  
  <p>
    <p>Today, <a href="http://www.google.com/trends/explore#q=golang%2C%20clojure&amp;cmpt=q">Go and Clojure compete with each other</a>. <a href="http://golang.org/">Go</a> will be one of the
hottest programming language in this year. This is the compiler language which can be seen as the successor C++.</p>




<p>On the other hand, <a href="http://www.scala-lang.org/">Scala</a> is the successor of Java which succeeded blending two programming paradigms, object-oriented programming and
functional programming.</p>




  </p>
  <span class="meta">
    written 








  



<time datetime="2014-02-17T22:37:59+09:00" pubdate data-updated="true">Feb 17<span>th</span>, 2014</time>
    

in
<span class="categories">
  
    <a class='category' href='/blog/categories/deep-learning/'>Deep Learning</a>, <a class='category' href='/blog/categories/machine-learning/'>Machine Learning</a>, <a class='category' href='/blog/categories/scala/'>Scala</a>, <a class='category' href='/blog/categories/golang/'>golang</a>
  
</span>


  </span>

  
    <a class="full-article-link pull-right" rel="full-article" href="/blog/2014/02/17/go-and-scala-which-should-i-use/">Read on &rarr;</a>
  
</article>

        </div>
      </div>
      
      
      <div class="row">
        <div class="col-md-offset-3 col-md-6">
          <article>
  <h2><a href="/blog/2014/02/15/yes-you-are-malala/">Yes, You Are Malala</a></h2>
  
  <p>
    <p><meta property=”og:image” content=”/images/posts/2014-02-14-you-are-malala/malala.jpg” /></p>




<div style="text-align:center" markdown="1">
<img src="/images/posts/2014-02-14-you-are-malala/malala.jpg" />
</div>




<p>We, Japanese have built high level democratic society. We have an universal suffrage system,
the rights to discuss through a lot of type media, and the constitution which guarantees our liberty of expression.
The end of the Edo era, we have kept to build these system gradually, sometimes destructively.
So, yes. We are one of the most democratic citizens in the world.</p>




  </p>
  <span class="meta">
    written 








  



<time datetime="2014-02-15T21:56:00+09:00" pubdate data-updated="true">Feb 15<span>th</span>, 2014</time>
    

in
<span class="categories">
  
    <a class='category' href='/blog/categories/democracy/'>Democracy</a>, <a class='category' href='/blog/categories/education/'>Education</a>
  
</span>


  </span>

  
    <a class="full-article-link pull-right" rel="full-article" href="/blog/2014/02/15/yes-you-are-malala/">Read on &rarr;</a>
  
</article>

        </div>
      </div>
      
      
      <div class="row">
        <div class="col-md-offset-3 col-md-6">
          <article>
  <h2><a href="/blog/2014/02/14/nn-with-nodejs/">NN With Nodejs</a></h2>
  
  <p>
    <p>2 layer newral network is added to <a href="https://github.com/Lewuathe/n42">n42</a>
This network is simple newral network which can trained throught gradient descent optimization calculation.
It is the same algorithm to the one of denoised autoencoder used by n42. So implementation itself was not diffucult.
The code is showed below.</p>




  </p>
  <span class="meta">
    written 








  



<time datetime="2014-02-14T22:23:00+09:00" pubdate data-updated="true">Feb 14<span>th</span>, 2014</time>
    

in
<span class="categories">
  
    <a class='category' href='/blog/categories/machine-learning/'>Machine learning</a>, <a class='category' href='/blog/categories/newral-network/'>Newral network</a>
  
</span>


  </span>

  
    <a class="full-article-link pull-right" rel="full-article" href="/blog/2014/02/14/nn-with-nodejs/">Read on &rarr;</a>
  
</article>

        </div>
      </div>
      
      
      <div class="row">
        <div class="col-md-offset-3 col-md-6">
          <article>
  <h2><a href="/blog/2014/02/05/restricted-boltzmann-machine-in-node/">Restricted Boltzmann Machine in Node</a></h2>
  
  <p>
    <p>n42 has restricted boltzmann machine. Restricted boltzmann machine is a kind of
autoencoder in order to extract charasteristics. In this article, I would leave out
the detail of restricted boltzmann machine. I want to introduce how the RBM is written
in node.</p>




  </p>
  <span class="meta">
    written 








  



<time datetime="2014-02-05T21:18:00+09:00" pubdate data-updated="true">Feb 5<span>th</span>, 2014</time>
    

in
<span class="categories">
  
    <a class='category' href='/blog/categories/deeplearning/'>DeepLearning</a>, <a class='category' href='/blog/categories/rbm/'>RBM</a>, <a class='category' href='/blog/categories/node/'>node</a>
  
</span>


  </span>

  
    <a class="full-article-link pull-right" rel="full-article" href="/blog/2014/02/05/restricted-boltzmann-machine-in-node/">Read on &rarr;</a>
  
</article>

        </div>
      </div>
      
      
      <div class="row">
        <div class="col-md-offset-3 col-md-6">
          <article>
  <h2><a href="/blog/2014/01/29/stacked-denoised-autoencoder-with-nodejs/">Stacked Denoised Autoencoder With Nodejs</a></h2>
  
  <p>
    <p>I developed deep leanring module which enables you to use stacked denoised autoencoder in nodejs.
This is called n42. You can train with deep learning algorithm very easily.</p>




<p><a href="https://npmjs.org/package/n42">https://npmjs.org/package/n42</a></p>




  </p>
  <span class="meta">
    written 








  



<time datetime="2014-01-29T21:38:00+09:00" pubdate data-updated="true">Jan 29<span>th</span>, 2014</time>
    

in
<span class="categories">
  
    <a class='category' href='/blog/categories/sda/'>SdA</a>, <a class='category' href='/blog/categories/autoencoder/'>autoencoder</a>, <a class='category' href='/blog/categories/nodejs/'>nodejs</a>
  
</span>


  </span>

  
    <a class="full-article-link pull-right" rel="full-article" href="/blog/2014/01/29/stacked-denoised-autoencoder-with-nodejs/">Read on &rarr;</a>
  
</article>

        </div>
      </div>
      
      
      <div class="row">
        <div class="col-md-offset-3 col-md-6">
          <article>
  <h2><a href="/blog/2014/01/26/autoencoder-with-node-dot-js/">Autoencoder With node.js</a></h2>
  
  <p>
    <p><a href="https://en.wikipedia.org/wiki/Autoencoder">Auto encoder</a> is used for deep learning. Auto encoder extract characteristics of data through
unsupervised learning. This is a kind of newral network. By using an auto encoder, you don&rsquo;t have to
be in trouble with choicing extracting algorithm, or doing yourself. Therefore, in deepleanring field,
this algorithm is used very actively. There are many implementation such as Python or Java, which are
used in machine learning frequently, but I cannot find this in nodejs. So this weekend, I wrote autoencoder in nodejs.</p>




  </p>
  <span class="meta">
    written 








  



<time datetime="2014-01-26T21:14:00+09:00" pubdate data-updated="true">Jan 26<span>th</span>, 2014</time>
    

in
<span class="categories">
  
    <a class='category' href='/blog/categories/deep-leanring/'>Deep leanring</a>, <a class='category' href='/blog/categories/autoencoder/'>autoencoder</a>, <a class='category' href='/blog/categories/node/'>node</a>
  
</span>


  </span>

  
    <a class="full-article-link pull-right" rel="full-article" href="/blog/2014/01/26/autoencoder-with-node-dot-js/">Read on &rarr;</a>
  
</article>

        </div>
      </div>
      
      
      <div class="row">
        <div class="col-md-offset-3 col-md-6">
          <article>
  <h2><a href="/blog/2014/01/21/idiomatic-mython/">Idiomatic Python ~I Will Write With This Style~</a></h2>
  
  <p>
    <p>I read a book, <em><a href="http://www.amazon.co.jp/Writing-Idiomatic-Python-2-7-3-Knupp-ebook/dp/B00B5KG0F8">Writing Idiomatic Python</a></em>
Although I usually write python codes, I have not paid attension to the style of these codes. By reading this book, I have noticed
that there are pythonic style in python codes. And I think it was good mind to write python code. There were many <em>Halmful</em>, <em>Idiomaric</em>
phrases about python code. So I&rsquo;d like to introduce some of them which I&rsquo;ll write in my own code.</p>




  </p>
  <span class="meta">
    written 








  



<time datetime="2014-01-21T13:18:00+09:00" pubdate data-updated="true">Jan 21<span>st</span>, 2014</time>
    

in
<span class="categories">
  
    <a class='category' href='/blog/categories/idiomatic/'>Idiomatic</a>, <a class='category' href='/blog/categories/python/'>Python</a>
  
</span>


  </span>

  
    <a class="full-article-link pull-right" rel="full-article" href="/blog/2014/01/21/idiomatic-mython/">Read on &rarr;</a>
  
</article>

        </div>
      </div>
      
      
      <div class="row">
        <div class="col-md-offset-3 col-md-6">
          <article>
  <h2><a href="/blog/2014/01/19/scrum-gathering-tokyo-2014-1/">Scrum Gathering Tokyo 2014</a></h2>
  
  <p>
    <p>On January 14-15, I participated <strong><a href="http://scrumgatheringtokyo.org/2014/">Scrum Gathering Tokyo 2014</a></strong>.
Though this conference cost me a little more than I can afford it,
it was great time to me as scrum master in my project. I want to arrange
the contents of these sessions, but as there were many sessions it is hard to me.
So in this entry, I cite one scrum example after another which I heard in these sessions.</p>




  </p>
  <span class="meta">
    written 








  



<time datetime="2014-01-19T21:08:00+09:00" pubdate data-updated="true">Jan 19<span>th</span>, 2014</time>
    

in
<span class="categories">
  
    <a class='category' href='/blog/categories/agile/'>Agile</a>, <a class='category' href='/blog/categories/scrum/'>Scrum</a>, <a class='category' href='/blog/categories/tokyo/'>Tokyo</a>
  
</span>


  </span>

  
    <a class="full-article-link pull-right" rel="full-article" href="/blog/2014/01/19/scrum-gathering-tokyo-2014-1/">Read on &rarr;</a>
  
</article>

        </div>
      </div>
      
      
      <div class="row">
        <div class="col-md-offset-3 col-md-6">
          <article>
  <h2><a href="/blog/2014/01/09/hack-tessel/">Hack Tessel!</a></h2>
  
  <p>
    <p><meta property=”og:image” content=”http://lewuathe.com/images/posts/2014-01-09-tessel-first/bootstrap_tessel.jpg” /></p>




<p>Yesterday, I got a <a href="http://tessel.io/">tessel</a>. With twists and turns, I overcome some obstacles for hacking this tiny but not little possibility board. So writing this post.</p>




<p>First and unfortunately, these client modules are only used for beta testers now.
So these are not opend yet. Please be understanding of this point.</p>




  </p>
  <span class="meta">
    written 








  



<time datetime="2014-01-09T21:25:00+09:00" pubdate data-updated="true">Jan 9<span>th</span>, 2014</time>
    

in
<span class="categories">
  
    <a class='category' href='/blog/categories/tessel/'>Tessel</a>, <a class='category' href='/blog/categories/node/'>node</a>
  
</span>


  </span>

  
    <a class="full-article-link pull-right" rel="full-article" href="/blog/2014/01/09/hack-tessel/">Read on &rarr;</a>
  
</article>

        </div>
      </div>
      
      
      <div class="row">
        <div class="col-md-offset-3 col-md-6">
          <article>
  <h2><a href="/blog/2013/12/30/reference-configuration-library-in-nodejs/">Reference Configuration Library in Nodejs</a></h2>
  
  <p>
    <p>I made npm module at the end of this year, <em>readonly</em>.</p>




<p><a href="https://github.com/Lewuathe/readonly">lewuathe/readonly @GitHub</a></p>




<p><a href="https://npmjs.org/package/readonly">readonly @npm</a></p>




<p>readonly is a simple reference restriction library between custom modules in node object.
When you want to configure access control of specific object from respective modules, this is good option.
For example, you made two modules, both use the same object.</p>




  </p>
  <span class="meta">
    written 








  



<time datetime="2013-12-30T20:24:00+09:00" pubdate data-updated="true">Dec 30<span>th</span>, 2013</time>
    

in
<span class="categories">
  
    <a class='category' href='/blog/categories/javascript/'>JavaScript</a>, <a class='category' href='/blog/categories/node/'>node</a>, <a class='category' href='/blog/categories/npm/'>npm</a>, <a class='category' href='/blog/categories/readonly/'>readonly</a>
  
</span>


  </span>

  
    <a class="full-article-link pull-right" rel="full-article" href="/blog/2013/12/30/reference-configuration-library-in-nodejs/">Read on &rarr;</a>
  
</article>

        </div>
      </div>
      
      
      <div class="row">
        <div class="col-md-offset-3 col-md-6">
          <article>
  <h2><a href="/blog/2013/12/23/how-to-start-krakenjs/">How to Start KrakenJS</a></h2>
  
  <p>
    <p>In this november, Paypal released KrakenJS which is web application framework based on Connect, Express.</p>




<p><a href="http://krakenjs.com/">http://krakenjs.com/</a></p>




<p>I had a chance to using this framework at the ending of this year. So I want to inform the facility of this framwork.</p>




  </p>
  <span class="meta">
    written 








  



<time datetime="2013-12-23T11:55:00+09:00" pubdate data-updated="true">Dec 23<span>rd</span>, 2013</time>
    

in
<span class="categories">
  
    <a class='category' href='/blog/categories/express/'>Express</a>, <a class='category' href='/blog/categories/kraken/'>Kraken</a>, <a class='category' href='/blog/categories/node/'>Node</a>
  
</span>


  </span>

  
    <a class="full-article-link pull-right" rel="full-article" href="/blog/2013/12/23/how-to-start-krakenjs/">Read on &rarr;</a>
  
</article>

        </div>
      </div>
      
      
      <div class="row">
        <div class="col-md-offset-3 col-md-6">
          <article>
  <h2><a href="/blog/2013/12/17/making-custom-segue/">Making Custom Segue</a></h2>
  
  <p>
    <p>In developing iOS application, have you wanted to make your own cutomized segue? UIKit provides bare segues such as
<code>push</code>, <code>modal</code>, <code>popover</code> and <code>replace</code>. These are useful in any situations. But sometimes I want to make my own transition.
So, I wrote down some tips for making your own custom animation used by segue.</p>




<h2>Make custom segue class</h2>




<p>In Xcode, add new files. The name of this class, anything is OK. But you have to set super class <code>UIStoryboardSegue</code>. Otherwise storyboard
cannot find this custom class subsequently.</p>




<p><img src="/images/posts/2013-12-17-customsegue/create-segue.png" alt="create" /></p>




<p>In this case, I named <code>FlipSegue</code></p>


<p><figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="cp">#import &lt;UIKit/UIKit.h&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="k">@interface</span> <span class="nc">FlipSegue</span> : <span class="nc">UIStoryboardSegue</span>
</span><span class='line'>
</span><span class='line'><span class="k">@end</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>And write animations like below.</p>


<p><figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="cp">#import &quot;FlipSegue.h&quot;</span>
</span><span class='line'>
</span><span class='line'><span class="k">@implementation</span> <span class="nc">FlipSegue</span>
</span><span class='line'>
</span><span class='line'><span class="k">&ndash;</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">perform</span> <span class="p">{</span>
</span><span class='line'>    <span class="n">UIViewController</span> <span class="o"><em></span><span class="n">sourceController</span> <span class="o">=</span> <span class="p">(</span><span class="n">UIViewController</span><span class="o"></em></span><span class="p">)</span><span class="n">self</span><span class="p">.</span><span class="n">sourceViewController</span><span class="p">;</span>
</span><span class='line'>    <span class="n">UIViewController</span> <span class="o"><em></span><span class="n">destinationController</span> <span class="o">=</span> <span class="p">(</span><span class="n">UIViewController</span><span class="o"></em></span><span class="p">)</span><span class="n">self</span><span class="p">.</span><span class="n">destinationViewController</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">CATransition</span> <span class="o">*</span><span class="n">transition</span> <span class="o">=</span> <span class="p">[</span><span class="n">CATransition</span> <span class="n">animation</span><span class="p">];</span>
</span><span class='line'>    <span class="n">transition</span><span class="p">.</span><span class="n">duration</span> <span class="o">=</span> <span class="mf">0.4</span><span class="p">;</span>
</span><span class='line'>    <span class="n">transition</span><span class="p">.</span><span class="n">timingFunction</span> <span class="o">=</span> <span class="p">[</span><span class="n">CAMediaTimingFunction</span> <span class="nl">functionWithName:</span><span class="n">kCAMediaTimingFunctionEaseInEaseOut</span><span class="p">];</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">// Set transition animation type</span>
</span><span class='line'>    <span class="n">transition</span><span class="p">.</span><span class="n">type</span> <span class="o">=</span> <span class="n">kCATransitionFade</span><span class="p">;</span>
</span><span class='line'>    <span class="c1">// Set transition animation subtype</span>
</span><span class='line'>    <span class="n">transition</span><span class="p">.</span><span class="n">subtype</span> <span class="o">=</span> <span class="n">kCATransitionFromTop</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">// Change animation</span>
</span><span class='line'>    <span class="p">[</span><span class="n">sourceController</span><span class="p">.</span><span class="n">navigationController</span><span class="p">.</span><span class="n">view</span><span class="p">.</span><span class="n">layer</span> <span class="nl">addAnimation:</span><span class="n">transition</span> <span class="nl">forKey:</span><span class="s">@&quot;mytransition&quot;</span><span class="p">];</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">// Transition </span>
</span><span class='line'>    <span class="p">[</span><span class="n">sourceController</span><span class="p">.</span><span class="n">navigationController</span> <span class="nl">pushViewController:</span><span class="n">destinationController</span> <span class="nl">animated:</span><span class="n">NO</span><span class="p">];</span>
</span><span class='line'>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="k">@end</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>When this segue is called, these animation settings are executed automatically. If you want to change animation, <code>type</code> and <code>subtype</code> is the core
of how the animation moves. These presets are documented in <a href="https://developer.apple.com/library/ios/documentation/GraphicsImaging/Reference/CATransition_Class/Introduction/Introduction.html">here</a>
Please see official document for detail. And then we&rsquo;ll use this segue on storyboard.</p>




<h2>Make segue with story board</h2>




<p>You need to draw your custom segue on storyboard.</p>




<p><img src="/images/posts/2013-12-17-customsegue/storyboard-segue.png" alt="storyboard" /></p>




<p>You can see <code>flip</code>, when you drag the arrow of segue on storyboard. This is your custom <code>FlipSegue</code>.
So choose this segue. And run!! Pusing source button of flip segue, your will see your custom animated transition.</p>


  </p>
  <span class="meta">
    written 








  



<time datetime="2013-12-17T23:21:00+09:00" pubdate data-updated="true">Dec 17<span>th</span>, 2013</time>
    

in
<span class="categories">
  
    <a class='category' href='/blog/categories/custom/'>Custom</a>, <a class='category' href='/blog/categories/objective-c/'>Objective-C</a>, <a class='category' href='/blog/categories/ios/'>iOS</a>, <a class='category' href='/blog/categories/iphone/'>iPhone</a>
  
</span>


  </span>

  
</article>

        </div>
      </div>
      
      
      <div class="row">
        <div class="col-md-offset-3 col-md-6">
          <article>
  <h2><a href="/blog/2013/12/13/making-widget-plugin/">Making Jenkins Widget Plugin</a></h2>
  
  <p>
    <p>This article was written for <a href="http://qiita.com/advent-calendar/2013/jenkinsci">Jenkins Advent Calendar</a> 14th day.</p>




<h2>Making Jenkins plugin</h2>




<p>Have you ever made Jenkins plugin? This is about my experience developing Jenkins plugin.
I have not written Java ever, and of course didn&rsquo;t know how to make maven projects. So while writing plugin codes,
I went this way and that, googling and trying code snippets. Then I felt that there were not enough documents for
first Jenkins plugin developers. This post however I only made widget plugin, I would be glad that this article will be useful
to the same developers as me.</p>




<h2>Getting started</h2>




<p>First, it is needed to download skelton of Jenkins plugin by using maven plugin. I used maven-3.0.5, and OSX machine.
Write below xml in <code>~/.m2/settings.xml</code></p>


<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;settings&gt;
</span><span class='line'>  &lt;pluginGroups&gt;
</span><span class='line'>    &lt;pluginGroup&gt;org.jenkins-ci.tools&lt;/pluginGroup&gt;
</span><span class='line'>  &lt;/pluginGroups&gt;
</span><span class='line'>
</span><span class='line'>  &lt;profiles&gt;
</span><span class='line'>    &lt;!&mdash; Give access to Jenkins plugins &mdash;&gt;
</span><span class='line'>    &lt;profile&gt;
</span><span class='line'>      &lt;id&gt;jenkins&lt;/id&gt;
</span><span class='line'>      &lt;activation&gt;
</span><span class='line'>        &lt;activeByDefault&gt;true&lt;/activeByDefault&gt; &lt;!&mdash; change this to false, if you don&rsquo;t like to have it on per default &mdash;&gt;
</span><span class='line'>      &lt;/activation&gt;
</span><span class='line'>      &lt;repositories&gt;
</span><span class='line'>        &lt;repository&gt;
</span><span class='line'>          &lt;id&gt;repo.jenkins-ci.org&lt;/id&gt;
</span><span class='line'>          &lt;url&gt;<a href="http://repo.jenkins-ci.org/public/&amp;lt;/url&amp;gt;">http://repo.jenkins-ci.org/public/&amp;lt;/url&amp;gt;</a>
</span><span class='line'>        &lt;/repository&gt;
</span><span class='line'>      &lt;/repositories&gt;
</span><span class='line'>      &lt;pluginRepositories&gt;
</span><span class='line'>        &lt;pluginRepository&gt;
</span><span class='line'>          &lt;id&gt;repo.jenkins-ci.org&lt;/id&gt;
</span><span class='line'>          &lt;url&gt;<a href="http://repo.jenkins-ci.org/public/&amp;lt;/url&amp;gt;">http://repo.jenkins-ci.org/public/&amp;lt;/url&amp;gt;</a>
</span><span class='line'>        &lt;/pluginRepository&gt;
</span><span class='line'>      &lt;/pluginRepositories&gt;
</span><span class='line'>    &lt;/profile&gt;
</span><span class='line'>  &lt;/profiles&gt;
</span><span class='line'>  &lt;mirrors&gt;
</span><span class='line'>    &lt;mirror&gt;
</span><span class='line'>      &lt;id&gt;repo.jenkins-ci.org&lt;/id&gt;
</span><span class='line'>      &lt;url&gt;<a href="http://repo.jenkins-ci.org/public/&amp;lt;/url&amp;gt;">http://repo.jenkins-ci.org/public/&amp;lt;/url&amp;gt;</a>
</span><span class='line'>      &lt;mirrorOf&gt;m.g.o-public&lt;/mirrorOf&gt;
</span><span class='line'>    &lt;/mirror&gt;
</span><span class='line'>  &lt;/mirrors&gt;
</span><span class='line'>&lt;/settings&gt;</span></code></pre></td></tr></table></div></figure></p>

<p>Create skelton.</p>


<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ mvn hpi:create</span></code></pre></td></tr></table></div></figure></p>

<p>Project name and artifactId will be asked as below.</p>


<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[INFO] Scanning for projects&hellip;
</span><span class='line'>[INFO]
</span><span class='line'>[INFO] &mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;
</span><span class='line'>[INFO] Building Maven Stub Project (No POM) 1
</span><span class='line'>[INFO] &mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;
</span><span class='line'>[INFO]
</span><span class='line'>[INFO] &mdash;&ndash; maven-hpi-plugin:1.106:create (default-cli) @ standalone-pom &mdash;&ndash;
</span><span class='line'>Enter the groupId of your plugin [org.jenkins-ci.plugins]: com.lewuathe.plugins
</span><span class='line'>Enter the artifactId of your plugin (normally without &lsquo;-plugin&rsquo; suffix): mytest</span></code></pre></td></tr></table></div></figure></p>

<p>Then under current directory, <code>mytest</code> project might be made. The directory tree looks like.</p>


<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>% tree mytest
</span><span class='line'>mytest
</span><span class='line'>├── pom.xml
</span><span class='line'>└── src
</span><span class='line'>    └── main
</span><span class='line'>        ├── java
</span><span class='line'>        │   └── com
</span><span class='line'>        │       └── lewuathe
</span><span class='line'>        │           └── plugins
</span><span class='line'>        │               └── mytest
</span><span class='line'>        │                   └── HelloWorldBuilder.java
</span><span class='line'>        └── resources
</span><span class='line'>            ├── com
</span><span class='line'>            │   └── lewuathe
</span><span class='line'>            │       └── plugins
</span><span class='line'>            │           └── mytest
</span><span class='line'>            │               └── HelloWorldBuilder
</span><span class='line'>            │                   ├── config.jelly
</span><span class='line'>            │                   ├── global.jelly
</span><span class='line'>            │                   ├── help-name.html
</span><span class='line'>            │                   └── help-useFrench.html
</span><span class='line'>            └── index.jelly
</span><span class='line'>
</span><span class='line'>13 directories, 7 files</span></code></pre></td></tr></table></div></figure></p>

<p>This sample project uses Builder extension point of Jenkins plugin. <a href="https://wiki.jenkins-ci.org/display/JENKINS/Extension+points#Extensionpoints-hudson.tasks.Builder">Builder extension</a> point is executed inside of the build process. If you have any process run on the way of building, you have to write the class which extends Builder. But in this article, I introduce Widget plugin. If you want to know what kind of extension points exist, please search on <a href="https://wiki.jenkins-ci.org/display/JENKINS/Extension+points">this page</a></p>




<p>Before explaining about Widget plugin, let me say how to run this plugins.</p>


<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ mvn hpi:run</span></code></pre></td></tr></table></div></figure></p>

<p>With above command, maven can download packages on which this plugin project depends and run Jenkins test server on 8080 port.</p>


<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># Access below host!
</span><span class='line'><a href="http://localhost:8080/jenkins/">http://localhost:8080/jenkins/</a></span></code></pre></td></tr></table></div></figure></p>

<p>You can look at Jenkins server! There is all you have to do before developing your own Jenkins plugin. Let&rsquo;s get started.</p>




<h2>Write Widget plugin</h2>




<p>My Jenkins plugin is put on <a href="https://github.com/jenkinsci/hckrnews-plugin">this repository</a>. With this plugin you can see hacker news top time-line on Jenkins dashboard.
From <a href="https://wiki.jenkins-ci.org/display/JENKINS/Hckrnews+Plugin">there</a>, it can be downloaded.
Screen shot was taken as below.</p>




<p><img src="/images/posts/2013-12-13-jenkins-widget-plugin/hckrnews-screenshot.png" alt="screenshot" /></p>




<p>By examing this plugin&rsquo;s source code, I want to list up the points I had trouble in completing this plugin.</p>




<h2>Correspondence of Jelly file and Java class</h2>




<p>In Jenkins, <a href="http://stapler.kohsuke.org/what-is.html">Stapler</a> is used in order to map URL and Java objects.</p>




<blockquote><p>Stapler is a library that &ldquo;staples&rdquo; your application objects to URLs, making it easier to write web applications. The core idea of Stapler is to automatically assign URLs for your objects, creating an intuitive URL hierarchy.</p></blockquote>




<p>At first, I cannot grasp what that means and practically which objects are mapped to jelly files. In conclusion, this is the correspond directory files.
Please look at <code>src/main/java</code> and <code>src/main/resources</code> directory of your project. It looks the same structure, doesn&rsquo;t it? So, in these directory, the correnspondence between Java class and jelly filesis made.
For example on hckrnews-plugin source tree, <code>java/com/lewuathe/plugins/hckrnews/HckrnewsWidget.java</code> corresponds to <code>com/lewuathe/plugins/hckrnews/HckrnewsWidget/</code>.
The former is what model or controller, and the latter is view in the context of MVC.</p>


<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>├── java
</span><span class='line'>│   └── com
</span><span class='line'>│       └── lewuathe
</span><span class='line'>│           └── plugins
</span><span class='line'>│               └── hckrnews
</span><span class='line'>│                   └── HckrnewsWidget.java  // &lt;&mdash; This is controller
</span><span class='line'>└── resources
</span><span class='line'>    ├── com
</span><span class='line'>    │   └── lewuathe
</span><span class='line'>    │       └── plugins
</span><span class='line'>    │           └── hckrnews
</span><span class='line'>    │               └── HckrnewsWidget
</span><span class='line'>    │                   └── index.jelly     // &lt;&mdash; This is view which corresponds to above controller, HckrnewsWidget.java
</span><span class='line'>    └── index.jelly</span></code></pre></td></tr></table></div></figure></p>

<h2>Calling view method</h2>




<p>In <code>HckrnewsWidget.java</code>, news static class in child class of Widget extension points is written.</p>


<p><figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="nd">@Extension</span>
</span><span class='line'><span class="kd">public</span> <span class="kd">class</span> <span class="nc">HckrnewsWidget</span> <span class="kd">extends</span> <span class="n">Widget</span> <span class="o">{</span>
</span><span class='line'><span class="c1">// &hellip;.</span>
</span><span class='line'>    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">News</span> <span class="o">{</span>
</span><span class='line'>        <span class="kd">private</span> <span class="n">String</span> <span class="n">title</span><span class="o">;</span>
</span><span class='line'>        <span class="kd">private</span> <span class="n">String</span> <span class="n">url</span><span class="o">;</span>
</span><span class='line'>        <span class="kd">private</span> <span class="n">String</span> <span class="n">points</span><span class="o">;</span>
</span><span class='line'>        <span class="kd">private</span> <span class="n">String</span> <span class="n">postedBy</span><span class="o">;</span>
</span><span class='line'>
</span><span class='line'>        <span class="kd">public</span> <span class="n">String</span> <span class="nf">getTitle</span><span class="o">()</span> <span class="o">{</span> <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">title</span><span class="o">;</span> <span class="o">}</span>
</span><span class='line'>        <span class="kd">public</span> <span class="n">String</span> <span class="nf">getUrl</span><span class="o">()</span> <span class="o">{</span> <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">url</span><span class="o">;</span> <span class="o">}</span>
</span><span class='line'>        <span class="kd">public</span> <span class="n">String</span> <span class="nf">getPoints</span><span class="o">()</span> <span class="o">{</span> <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">points</span><span class="o">;</span> <span class="o">}</span>
</span><span class='line'>        <span class="kd">public</span> <span class="n">String</span> <span class="nf">getPostedBy</span><span class="o">()</span> <span class="o">{</span> <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">postedBy</span><span class="o">;</span> <span class="o">}</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'><span class="c1">// &hellip;.</span>
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>Ordinary getter of News object. So it comes to index.jelly file.</p>


<p><figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="o">&lt;</span><span class="nl">j:</span><span class="n">jelly</span> <span class="nl">xmlns:</span><span class="n">j</span><span class="o">=</span><span class="s">&quot;jelly:core&quot;</span> <span class="nl">xmlns:</span><span class="n">st</span><span class="o">=</span><span class="s">&quot;jelly:stapler&quot;</span> <span class="nl">xmlns:</span><span class="n">d</span><span class="o">=</span><span class="s">&quot;jelly:define&quot;</span> <span class="nl">xmlns:</span><span class="n">l</span><span class="o">=</span><span class="s">&quot;/lib/layout&quot;</span> <span class="nl">xmlns:</span><span class="n">t</span><span class="o">=</span><span class="s">&quot;/lib/hudson&quot;</span> <span class="nl">xmlns:</span><span class="n">f</span><span class="o">=</span><span class="s">&quot;/lib/form&quot;</span> <span class="nl">xmlns:</span><span class="n">i</span><span class="o">=</span><span class="s">&quot;jelly:fmt&quot;</span><span class="o">&gt;</span>
</span><span class='line'><span class="o">&lt;</span><span class="nl">l:</span><span class="n">pane</span> <span class="n">width</span><span class="o">=</span><span class="s">&quot;3&quot;</span> <span class="n">title</span><span class="o">=</span><span class="s">&quot;Hacker News Top&quot;</span><span class="o">&gt;</span>
</span><span class='line'><span class="o">&lt;</span><span class="n">tr</span><span class="o">&gt;</span>
</span><span class='line'>  <span class="o">&lt;</span><span class="n">th</span> <span class="n">class</span><span class="o">=</span><span class="s">&quot;pane&quot;</span><span class="o">&gt;</span><span class="n">Title</span><span class="o">&lt;/</span><span class="n">th</span><span class="o">&gt;</span>
</span><span class='line'>  <span class="o">&lt;</span><span class="n">th</span> <span class="n">class</span><span class="o">=</span><span class="s">&quot;pane&quot;</span><span class="o">&gt;</span><span class="n">Points</span><span class="o">&lt;/</span><span class="n">th</span><span class="o">&gt;</span>
</span><span class='line'>  <span class="o">&lt;</span><span class="n">th</span> <span class="n">class</span><span class="o">=</span><span class="s">&quot;pane&quot;</span><span class="o">&gt;</span><span class="n">Posted</span> <span class="n">by</span><span class="o">&lt;/</span><span class="n">th</span><span class="o">&gt;</span>
</span><span class='line'><span class="o">&lt;/</span><span class="n">tr</span><span class="o">&gt;</span>
</span><span class='line'><span class="o">&lt;</span><span class="nl">j:</span><span class="n">forEach</span> <span class="n">var</span><span class="o">=</span><span class="s">&quot;news&quot;</span> <span class="n">items</span><span class="o">=</span><span class="s">&quot;${it.newslist}&quot;</span><span class="o">&gt;</span>
</span><span class='line'>  <span class="o">&lt;</span><span class="n">tr</span><span class="o">&gt;</span>
</span><span class='line'>    <span class="o">&lt;</span><span class="n">td</span> <span class="n">align</span><span class="o">=</span><span class="s">&quot;left&quot;</span> <span class="n">class</span><span class="o">=</span><span class="s">&quot;pane&quot;</span> <span class="n">style</span><span class="o">=</span><span class="s">&quot;width:10px;&quot;</span><span class="o">&gt;&lt;</span><span class="n">a</span> <span class="n">href</span><span class="o">=</span><span class="s">&quot;${news.url}&quot;</span><span class="o">&gt;</span><span class="n">$</span><span class="o">{</span><span class="n">news</span><span class="o">.</span><span class="na">title</span><span class="o">}&lt;/</span><span class="n">a</span><span class="o">&gt;&lt;/</span><span class="n">td</span><span class="o">&gt;</span>
</span><span class='line'>    <span class="o">&lt;</span><span class="n">td</span> <span class="n">class</span><span class="o">=</span><span class="s">&quot;pane&quot;</span> <span class="n">align</span><span class="o">=</span><span class="s">&quot;right&quot;</span><span class="o">&gt;</span><span class="n">$</span><span class="o">{</span><span class="n">news</span><span class="o">.</span><span class="na">points</span><span class="o">}&lt;/</span><span class="n">td</span><span class="o">&gt;</span>
</span><span class='line'>    <span class="o">&lt;</span><span class="n">td</span> <span class="n">class</span><span class="o">=</span><span class="s">&quot;pane&quot;</span> <span class="n">align</span><span class="o">=</span><span class="s">&quot;right&quot;</span><span class="o">&gt;</span><span class="n">$</span><span class="o">{</span><span class="n">news</span><span class="o">.</span><span class="na">postedBy</span><span class="o">}&lt;/</span><span class="n">td</span><span class="o">&gt;</span>
</span><span class='line'>  <span class="o">&lt;/</span><span class="n">tr</span><span class="o">&gt;</span>
</span><span class='line'><span class="o">&lt;/</span><span class="nl">j:</span><span class="n">forEach</span><span class="o">&gt;</span>
</span><span class='line'><span class="o">&lt;/</span><span class="nl">l:</span><span class="n">pane</span><span class="o">&gt;</span>
</span><span class='line'><span class="n">Last</span> <span class="nl">Updated:</span> <span class="n">$</span><span class="o">{</span><span class="n">it</span><span class="o">.</span><span class="na">lastupdatedstr</span><span class="o">}</span>
</span><span class='line'><span class="o">&lt;/</span><span class="nl">j:</span><span class="n">jelly</span><span class="o">&gt;</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>The detail of Jelly syntax is not explained in this time. In this template file, <code>it</code> refers to the correspondence object in logic of stapler,
in other words that&rsquo;s <code>HckrnewsWidget.java</code>. So when you writes as <code>it.newslist</code>, this calls</p>


<p><figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="nd">@Extension</span>
</span><span class='line'><span class="kd">public</span> <span class="kd">class</span> <span class="nc">HckrnewsWidget</span> <span class="kd">extends</span> <span class="n">Widget</span> <span class="o">{</span>
</span><span class='line'><span class="c1">//&hellip;</span>
</span><span class='line'>    <span class="kd">public</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">News</span><span class="o">&gt;</span> <span class="nf">getNewslist</span><span class="o">()</span> <span class="o">{</span>
</span><span class='line'>            <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">newsList</span><span class="o">;</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'><span class="c1">//&hellip;</span>
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>Then <code>index.jelly</code> can get newslist. But you should take care of the casing of method name. If you write <code>getNewsList</code>, it can be called. Types are below.</p>




<ul>
<li>getNewslist : it.newslist is called</li>
<li>getNewsList : it.newList is called</li>
<li>getNewslist : it.newsList is <em>not</em> called</li>
</ul>




<p>So it looks like auto casting to a captal letter is only applied to the first letter. It is necessary to arrange the type of posteror letters.</p>




<h2>Making Wiki</h2>




<p>It might be rare case which only I experienced. Jenkins wiki page can not be created automatically.
Of course, it is taken for granted that writing down your wiki url on pom.xml.</p>


<p><figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="o">&lt;</span><span class="n">project</span> <span class="n">xmlns</span><span class="o">=</span><span class="s">&quot;<a href="http://maven.apache.org/POM/4.0.0&amp;quot;">http://maven.apache.org/POM/4.0.0&amp;quot;</a></span> <span class="nl">xmlns:</span><span class="n">xsi</span><span class="o">=</span><span class="s">&quot;<a href="http://www.w3.org/2001/XMLSchema-instance&amp;quot;">http://www.w3.org/2001/XMLSchema-instance&amp;quot;</a></span> <span class="nl">xsi:</span><span class="n">schemaLocation</span><span class="o">=</span><span class="s">&quot;<a href="http://maven.apache.org/POM/4.0.0">http://maven.apache.org/POM/4.0.0</a> <a href="http://maven.apache.org/maven-v4_0_0.xsd&amp;quot;">http://maven.apache.org/maven-v4_0_0.xsd&amp;quot;</a></span><span class="o">&gt;</span>
</span><span class='line'><span class="c1">//&hellip;</span>
</span><span class='line'>  <span class="o">&lt;</span><span class="n">url</span><span class="o">&gt;</span><span class="nl"><a href="http:">http:</a></span><span class="c1">//wiki.jenkins-ci.org/display/JENKINS/Hckrnews+Plugin&lt;/url&gt;</span>
</span><span class='line'><span class="c1">//&hellip;</span>
</span><span class='line'><span class="o">&lt;/</span><span class="n">project</span><span class="o">&gt;</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>But this is not the trigger of creating Jenkins wiki page :( You have to make your own page yourself.
I misunderstood about making wiki pages on this point. After you make your own wiki page, let&rsquo;s add a tag.</p>




<p><img src="/images/posts/2013-12-13-jenkins-widget-plugin/add-tag.png" alt="add-tag" /></p>




<p>After you add tag, your wiki page will be listed on <a href="https://wiki.jenkins-ci.org/display/JENKINS/Plugins">this page</a>. It will be easier to search for users.</p>




<h1>After all</h1>




<p>This experience taught me many things about plugin development, Jenkins extension points and of course <strong>Java</strong> !!
Conversly if you have no experience of Java, you can also make your own Jenkins plugin about two weeks.
And I want to keep making Jenkins plugins when idea comes to me.</p>




<p>Last but not least, write your test codes in your plugin. With maven, you can run JUnit very easily.
If there are no test codes in the plugin of continuous integration tool, Jenkins, it sounds like mistaking the means for the end, doesn&rsquo;t it?</p>




<p>Viva great continuous integration! Thank you.</p>


  </p>
  <span class="meta">
    written 








  



<time datetime="2013-12-13T21:14:00+09:00" pubdate data-updated="true">Dec 13<span>th</span>, 2013</time>
    

in
<span class="categories">
  
    <a class='category' href='/blog/categories/jenkins/'>Jenkins</a>, <a class='category' href='/blog/categories/widget/'>Widget</a>, <a class='category' href='/blog/categories/plugin/'>plugin</a>
  
</span>


  </span>

  
</article>

        </div>
      </div>
      
      
      <div class="row">
        <div class="col-md-offset-3 col-md-6">
          <article>
  <h2><a href="/blog/2013/12/09/agile-samurai-basecamp-in-tokyo/">Agile Samurai Basecamp in Tokyo <2></a></h2>
  
  <p>
    <p>This entry follows previous post.
The practical methods about TDD are explained in this section.</p>




<p>And also, it is written as an article of <a href="http://qiita.com/advent-calendar/2013/tddadventjp">TDD advent calendar on 10th day</a>.</p>




<h2>How to start TDD? Takuto Wada(twada)</h2>




<p>The left wing of agile is what about team environment, management, scrum, iteration and standup meeting. On the other hand, the right wing of agile is not perceived enough to ordinary people.
It&rsquo;s CI/CD and automation. These are also as important as the formers. There is apparent difference between making software and keeping making software. Agile programming always requires refactoring.
In TDD process, refactoring is the core process. You cannot say that you achieve TDD without refactoring your program.</p>




<h3>Write running code, and then write clean code</h3>




<p>Making Good design previously is difficult task. Besides we don&rsquo;t know what is good design on the system undefined yet. Software and program are too complex for us to understand perfectly.
So we cannot avoid progressing development with positivism notion. In other words, write code first! However we cannot solve all problems yet. The codes once confirmed as what runs with no bugs
are not willing to be refactored. We are afraid of changing running code. TDD enables us to pass over these fears. The concrete cycle of TDD is below.</p>




<h3>TDD cycle</h3>




<ol>
<li>Make TODO list</li>
<li>Write test code first</li>
<li>Running test and fail (<em>Red phase</em>)</li>
<li>Write product code</li>
<li>Running test and success (<em>Green phase</em>)</li>
<li>Refactoring product code with keeping Green</li>
<li>Repeat 1~6 process</li>
</ol>




<p>The most important process in these 7 phases is refactoring. If you result in failure of TDD, the main reason is to neglect refactoring your product code. It needs more power of the will.
So it is better to insert refactoring into TDD process. You don&rsquo;t do refactoring as an addition, but do as necessary process.</p>




<p><img src="/images/posts/2013-12-10-samurai-2/golden_cycle.jpg" alt="Golden Cycle" /></p>




<h3>The secrets of TDD</h3>




<p>To achive TDD, you should know how to start TDD at your daily work.</p>




<h3><em>Small start one by one</em></h3>




<p>You should make small TODO list as possible. It is good to reduce each task within the span which you can complete red, green and refactoring cycle in 15~30minutes.
The more fast you can complete, the better your TODO list is.</p>




<h3><em>Tackle one enemy in one time</em></h3>




<p>However, if you can reduce each task in small unit, starting all tasks at one time is not good work. As Samurai(Musashi Miyamoto) did, you have to also complete tasks one by one.
You can concentrate the essentials of each task,</p>




<h3><em>You are the first user</em></h3>




<p>When you write test code, you should take care of the usability. The interface of your product code is determined when you write your test code.
So before write your test code and while writing your test code, your should try and make the interface better bacause you are the first user of your product.
The only way to know how user friendly your product is using it yourself. In other words, let&rsquo;s test it.</p>




<h3><em>Test your uncertain</em></h3>




<p>The purpose of TDD is not mainly to guarantee software quality, but to take your ease in order to sleep peacefully. If there are no automatic test codes, it is horror.
The every time you release your products, you are to end up with praying for the success of the release. Or in order to assure that there are no bugs in your software,
you might have to many overtime work. That&rsquo;s too bad :(. To avoid this situation, test codes are selected and written under the criteria of how this test makes you peaceful.</p>




<h3><em>Knit a lifeline</em></h3>




<p>This is relevant to previous item. Compiled a lot of test codes will help you when you are in danger or crisis. This test codes become a lifeline knitted over many layers
It will support you in any situation strongly.</p>




<h3><em>The essencial goal of TDD</em></h3>




<p>The best goal of TDD is keeping your health. This means your code health, your team health and of course your code health. Bacause of TDD, all developers can go home early,
take a meal with your family and friends, make your product with peaceful mind. This is the essential goal of TDD for all software engineers. Conquering your anxiety and keeping you healthy.</p>




<h1>After session</h1>




<p>This goal made me realize why I am a software engineer again. Programming, writing code should always be fun. It should always be what makes me happy.
If you are unhappy with writing code as work, it mistakes the means for the end, doesn&rsquo;t it? TDD is the one way of making my life as software engineer more joyful.
That mind must not be forgot whenever I type my test code.</p>




<p>The each line of your test codes makes you happy, I believe.</p>


  </p>
  <span class="meta">
    written 








  



<time datetime="2013-12-09T20:16:00+09:00" pubdate data-updated="true">Dec 9<span>th</span>, 2013</time>
    

in
<span class="categories">
  
    <a class='category' href='/blog/categories/agile/'>Agile</a>, <a class='category' href='/blog/categories/samurai/'>Samurai</a>, <a class='category' href='/blog/categories/tdd/'>TDD</a>
  
</span>


  </span>

  
</article>

        </div>
      </div>
      
      
      <div class="row">
        <div class="col-md-offset-3 col-md-6">
          <article>
  <h2><a href="/blog/2013/12/08/whatt-going-on-at-agile-samurai-basecamp/">Agile Samurai Basecamp in Tokyo <1></a></h2>
  
  <p>
    <p>At work, I am a scrum padawan, not yet master :&ndash;)</p>




<p>Through developing with agile team, I was taught what scrum is, product backlog is, sprint is.</p>




<p>In order to accelerate this growth as an agile programmer, I took part in TDD section of <a href="http://www.agilesamuraibasecamp.org/">Agile Samurai Basecamp</a>.
TDD(Test Driven Development) is the most interesting method in my mind. So I wanted to know how to progress TDD in my daily work.
This article includes TDD core process which I study in basecamp and what I thought for the future career as a programmer.</p>




<h2>Keynote : Shintarou Kakutani</h2>




<p>He is the translator of <em><a href="http://pragprog.com/book/jtrap/the-agile-samurai">The Agile Samurai</a></em> .
He answered the questions  who is agile samurai, what agile teams are for.</p>




<h3>Who is agile samurai?</h3>




<p><img src="/images/posts/2013-12-08-samurai-1/samurai.jpg" alt="samurai" /></p>




<p>Agile team must keep to delivering valuable software every week. It doesn&rsquo;t mean just delivering lecture or lesson,
but codes which run as what you and your customer expects. To achieve this, it is very important to tackle problems as <em>&ldquo;whole one team&rdquo;</em>  which includes
your customers. Customers decide what you make, then your decide how you make. Delivering values to customer and tackling problems as whole one team is the
core concept of <em><a href="http://pragprog.com/book/jtrap/the-agile-samurai">The Agile Samurai</a></em> .</p>




<h3>Why did you write more Agile book?</h3>




<p>There were already many agile books in stores. Why another agile book is needed at that time?
In the past, there were no books which compiled main below 7 books which explains agile practice for detail.</p>




<ul>
<li><a href="http://www.amazon.co.jp/XP%E3%82%A8%E3%82%AF%E3%82%B9%E3%83%88%E3%83%AA%E3%83%BC%E3%83%A0%E3%83%BB%E3%83%97%E3%83%AD%E3%82%B0%E3%83%A9%E3%83%9F%E3%83%B3%E3%82%B0%E5%85%A5%E9%96%80%E2%80%95%E3%82%BD%E3%83%95%E3%83%88%E3%82%A6%E3%82%A7%E3%82%A2%E9%96%8B%E7%99%BA%E3%81%AE%E7%A9%B6%E6%A5%B5%E3%81%AE%E6%89%8B%E6%B3%95-%E3%82%B1%E3%83%B3%E3%83%88-%E3%83%99%E3%83%83%E3%82%AF/dp/489471275X">Extream programming explained</a></li>
<li><a href="http://www.amazon.co.jp/Refactoring-Improving-Existing-Addison-Wesley-Technology/dp/0201485672/ref=sr_1_1?s=english-books&amp;ie=UTF8&amp;qid=1386502275&amp;sr=1-1&amp;keywords=refactoring">Refactoring</a></li>
<li><a href="http://www.amazon.co.jp/XP%E3%82%A8%E3%82%AF%E3%82%B9%E3%83%88%E3%83%AA%E3%83%BC%E3%83%A0%E3%83%BB%E3%83%97%E3%83%AD%E3%82%B0%E3%83%A9%E3%83%9F%E3%83%B3%E3%82%B0%E5%AE%9F%E8%A1%8C%E8%A8%88%E7%94%BB-The-Series-%E3%82%B1%E3%83%B3%E3%83%88-%E3%83%99%E3%83%83%E3%82%AF/dp/4894713411/ref=sr_1_cc_1?s=aps&amp;ie=UTF8&amp;qid=1386502308&amp;sr=1-1-catcorr&amp;keywords=%E3%82%A8%E3%82%AF%E3%82%B9%E3%83%88%E3%83%AA%E3%83%BC%E3%83%A0%E3%83%97%E3%83%AD%E3%82%B0%E3%83%A9%E3%83%9F%E3%83%B3%E3%82%B0%E3%80%80%E5%AE%9F%E8%A1%8C%E8%A8%88%E7%94%BB">Extream programming planning</a></li>
<li><a href="http://www.amazon.co.jp/XP%E3%82%A8%E3%82%AF%E3%82%B9%E3%83%88%E3%83%AA%E3%83%BC%E3%83%A0%E3%83%BB%E3%83%97%E3%83%AD%E3%82%B0%E3%83%A9%E3%83%9F%E3%83%B3%E3%82%B0%E5%B0%8E%E5%85%A5%E7%B7%A8-XP%E5%AE%9F%E8%B7%B5%E3%81%AE%E6%89%8B%E5%BC%95%E3%81%8D-The-XP-Series/dp/4894714914/ref=sr_1_1?s=books&amp;ie=UTF8&amp;qid=1386502350&amp;sr=1-1&amp;keywords=%E3%82%A8%E3%82%AF%E3%82%B9%E3%83%88%E3%83%AA%E3%83%BC%E3%83%A0%E3%83%97%E3%83%AD%E3%82%B0%E3%83%A9%E3%83%9F%E3%83%B3%E3%82%B0%E3%80%80%E5%B0%8E%E5%85%A5%E7%B7%A8">Extream programming installed</a></li>
<li><a href="http://www.amazon.co.jp/%E3%83%86%E3%82%B9%E3%83%88%E9%A7%86%E5%8B%95%E9%96%8B%E7%99%BA%E5%85%A5%E9%96%80-%E3%82%B1%E3%83%B3%E3%83%88-%E3%83%99%E3%83%83%E3%82%AF/dp/4894717115/ref=sr_1_2?s=books&amp;ie=UTF8&amp;qid=1386502385&amp;sr=1-2&amp;keywords=Test+Driven+Development+by+example">Test Driven Development by example</a></li>
<li><a href="http://www.amazon.co.jp/User-Stories-Applied-Software-Development-ebook/dp/B0054KOL74/ref=sr_1_cc_1?s=aps&amp;ie=UTF8&amp;qid=1386502435&amp;sr=1-1-catcorr&amp;keywords=User+Stories+applied">User stories applied</a></li>
<li><a href="http://www.amazon.co.jp/%E3%82%A2%E3%82%B8%E3%83%A3%E3%82%A4%E3%83%AB%E3%81%AA%E8%A6%8B%E7%A9%8D%E3%82%8A%E3%81%A8%E8%A8%88%E7%94%BB%E3%81%A5%E3%81%8F%E3%82%8A-~%E4%BE%A1%E5%80%A4%E3%81%82%E3%82%8B%E3%82%BD%E3%83%95%E3%83%88%E3%82%A6%E3%82%A7%E3%82%A2%E3%82%92%E8%82%B2%E3%81%A6%E3%82%8B%E6%A6%82%E5%BF%B5%E3%81%A8%E6%8A%80%E6%B3%95~-Mike-Cohn/dp/4839924023/ref=sr_1_1?s=books&amp;ie=UTF8&amp;qid=1386502473&amp;sr=1-1&amp;keywords=%E3%82%A2%E3%82%B8%E3%83%A3%E3%82%A4%E3%83%AB%E3%81%AA%E8%A6%8B%E7%A9%8D%E3%82%82%E3%82%8A%E3%81%A8%E8%A8%88%E7%94%BB%E4%BD%9C%E3%82%8A">Agile Estimating and Planning</a></li>
</ul>




<p><em><a href="http://pragprog.com/book/jtrap/the-agile-samurai">The Agile Samurai</a></em> collects the essences of these books. In addition to these concepts, this book add new stuff.
So it&rsquo;s inception deck. If you want to know about inception deck, read this book. And the session of inception deck was also held at this bootcamp. This is important concept of agile practice.</p>




<h3>Why a hero in this book is called &ldquo;Samurai&rdquo;?</h3>




<p>The author, Jonathan Rasmusson likes <em>&ldquo;<a href="http://www.amazon.com/Way-Peaceful-Warrior-Changes-Lives/dp/0915811898">Peaceful Warrior</a>&rdquo;</em> . Initial title of &ldquo;Agile samurai&rdquo; was &ldquo;Agile peaceful warrior&rdquo; after this novel title. But it was not grasped by other people who have not read this book. So collaborators recommended him the word, &ldquo;Samurai&rdquo; which means same notion as peaceful warrior. &ldquo;Samurai&rdquo; is more perspicuous than &ldquo;peaceful warrior&rdquo; to the people of all over the world. Master sensei is also only the notion, not real samurai characters who lived in Japan.</p>




<h3>What is the agile practice?</h3>




<p>Agile development means the way of keeping feedback under the cooperative environment. To achieve team&rsquo;s goal, taking action requires cooperative environment of your team. All members must have the sense of ownership of their products. This thought makes good mood and necessary environment. But this practice can be accomplished only by your learning with on-the-job training. There is no secret ingredient. It&rsquo;s just you.</p>




<h3>Last but not least</h3>




<ol>
<li>Sharing what you learn with others</li>
<li>Keep searching the better answers</li>
<li>Enjoy!</li>
</ol>




<p>Enjoy your agile life!</p>


  </p>
  <span class="meta">
    written 








  



<time datetime="2013-12-08T19:29:00+09:00" pubdate data-updated="true">Dec 8<span>th</span>, 2013</time>
    

in
<span class="categories">
  
    <a class='category' href='/blog/categories/agile/'>Agile</a>, <a class='category' href='/blog/categories/basecaml/'>Basecaml</a>, <a class='category' href='/blog/categories/tdd/'>TDD&#8221;</a>
  
</span>


  </span>

  
</article>

        </div>
      </div>
      
      
      <div class="row">
        <div class="col-md-offset-3 col-md-6">
          <article>
  <h2><a href="/blog/2013/12/05/closure-with-async-dot-js/">Closure With Async.js</a></h2>
  
  <p>
    <p>You may use <a href="https://npmjs.org/package/async">Async.js</a> at least one time when you develop with nodejs.</p>




<blockquote><p>Async is a utility module which provides straight-forward, powerful functions for working with asynchronous JavaScript.</p></blockquote>




<p>So if you want to write asynchronous code with JavaScript, I recommend you to use it. It&rsquo;s easy to use, simple syntax.
However I had trouble with using Async.js in the context of giving dynamic task array. In this article, I want to share
how to write dynamic task array given to Async.js module.</p>




<h2>Problem</h2>




<p>I wrote like a below code with nodejs.</p>


<p><figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="kd">var</span> <span class="nx">async</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;async&#39;</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// Total task is 10 which is executed in parallel</span>
</span><span class='line'><span class="kd">var</span> <span class="nx">TASK_NUM</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// All task functions are put in taskList</span>
</span><span class='line'><span class="kd">var</span> <span class="nx">taskList</span> <span class="o">=</span> <span class="p">[];</span>
</span><span class='line'><span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">TASK_NUM</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">taskList</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">i</span><span class="p">);</span>
</span><span class='line'>        <span class="nx">callback</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="nx">i</span><span class="p">);</span>
</span><span class='line'>    <span class="p">});</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="nx">async</span><span class="p">.</span><span class="nx">parallel</span><span class="p">(</span><span class="nx">taskList</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">results</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">results</span><span class="p">);</span>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>When you run this code, I obtained below output.</p>


<p><figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="mi">10</span>
</span><span class='line'><span class="mi">10</span>
</span><span class='line'><span class="mi">10</span>
</span><span class='line'><span class="mi">10</span>
</span><span class='line'><span class="mi">10</span>
</span><span class='line'><span class="mi">10</span>
</span><span class='line'><span class="mi">10</span>
</span><span class='line'><span class="mi">10</span>
</span><span class='line'><span class="mi">10</span>
</span><span class='line'><span class="mi">10</span>
</span><span class='line'><span class="p">[</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span> <span class="p">]</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>This didn&rsquo;t fit my expectation. I thought all tasks should get i-th argument. So each task&rsquo;s output
is i-th number, if i-th task runs. However in this case, all task&rsquo;s output is 10. Why closure in function(In JavaScript, <code>function</code> makes variable scope, called closure) might not be effective?</p>




<h2>Answer</h2>




<p>There is answer in <a href="http://stackoverflow.com/questions/12472448/async-parallel-with-functions-dynamic-array">StackOverflow</a>.</p>




<blockquote><p>A closure doesn&rsquo;t &ldquo;trap&rdquo; the value that an outer variable had at the time it was created; it &ldquo;traps&rdquo; a reference to whatever value the outer variable has at the time it&rsquo;s executed (which in this case won&rsquo;t be until well after your for loop has finished.</p></blockquote>




<p>So in this case, closure does not make scope when it is <strong>declared</strong>, but <strong>executed</strong>. The variable <code>i</code> resulted in 10 after <code>for</code> loop in this code. And then each tasks will be executed under the condition that variable <code>i</code> is 10. I understood why these odd phenomenon was occured.</p>




<h2>How to write</h2>




<p>How should I write in order to execute this code as I expected in advance. Same page showed me the answer.</p>


<p><figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="kd">var</span> <span class="nx">deleteFunction</span> <span class="o">=</span> <span class="nx">makeDeleteFunction</span><span class="p">(</span><span class="nx">i</span><span class="p">,</span> <span class="nx">callback</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>Writing wrapper function which wraps my original tasks makes scope under given argument <code>i</code>. When you declare task, you should not make task function directly, but should give parameters which trapped in declaration context to the wrapper function. Here is my sample that is corresponds to above code.</p>


<p><figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="kd">var</span> <span class="nx">async</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;async&#39;</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// Wrapper function</span>
</span><span class='line'><span class="kd">function</span> <span class="nx">makeTask</span><span class="p">(</span><span class="nx">i</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">return</span> <span class="kd">function</span><span class="p">(</span><span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">i</span><span class="p">);</span>
</span><span class='line'>        <span class="nx">callback</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="nx">i</span><span class="p">);</span>
</span><span class='line'>    <span class="p">};</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// Total task is 10 which is executed in parallel</span>
</span><span class='line'><span class="kd">var</span> <span class="nx">TASK_NUM</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// All task functions are put in taskList</span>
</span><span class='line'><span class="kd">var</span> <span class="nx">taskList</span> <span class="o">=</span> <span class="p">[];</span>
</span><span class='line'><span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">TASK_NUM</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">taskList</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">makeTask</span><span class="p">(</span><span class="nx">i</span><span class="p">));</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="nx">async</span><span class="p">.</span><span class="nx">parallel</span><span class="p">(</span><span class="nx">taskList</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">results</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">results</span><span class="p">);</span>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>Then output is given as I expected.</p>


<p><figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="mi">0</span>
</span><span class='line'><span class="mi">1</span>
</span><span class='line'><span class="mi">2</span>
</span><span class='line'><span class="mi">3</span>
</span><span class='line'><span class="mi">4</span>
</span><span class='line'><span class="mi">5</span>
</span><span class='line'><span class="mi">6</span>
</span><span class='line'><span class="mi">7</span>
</span><span class='line'><span class="mi">8</span>
</span><span class='line'><span class="mi">9</span>
</span><span class='line'><span class="p">[</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span> <span class="p">]</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>If you write dynamic task function with Async.js, notice these fact.</p>


  </p>
  <span class="meta">
    written 








  



<time datetime="2013-12-05T20:29:00+09:00" pubdate data-updated="true">Dec 5<span>th</span>, 2013</time>
    

in
<span class="categories">
  
    <a class='category' href='/blog/categories/javascript/'>JavaScript</a>, <a class='category' href='/blog/categories/node/'>Node</a>, <a class='category' href='/blog/categories/async/'>async</a>
  
</span>


  </span>

  
</article>

        </div>
      </div>
      
      
      <div class="row">
        <div class="col-md-offset-3 col-md-6">
          <article>
  <h2><a href="/blog/2013/12/04/the-left-one/">The LEFT ONE</a></h2>
  
  <p>
    <iframe src="http://www.slideshare.net/slideshow/embed_code/28845284" width="427" height="356" frameborder="0" marginwidth="0" marginheight="0" scrolling="no" style="border:1px solid #CCC;border-width:1px 1px 0;margin-bottom:5px" allowfullscreen> </iframe>




<p> <div style="margin-bottom:5px"> <strong> <a href="https://www.slideshare.net/lewuathe/left-one" title="THE LEFT ONE" target="_blank">THE LEFT ONE</a> </strong> from <strong><a href="http://www.slideshare.net/lewuathe" target="_blank">Kai Sasaki</a></strong> </div></p>




<p>I decided to do. I always did so.
It&rsquo;s my challenge for my future, and my hapiness.</p>




<p>So I wrote it. Not to forget my footsteps.</p>


  </p>
  <span class="meta">
    written 








  



<time datetime="2013-12-04T23:07:00+09:00" pubdate data-updated="true">Dec 4<span>th</span>, 2013</time>
    

in
<span class="categories">
  
    <a class='category' href='/blog/categories/opnion/'>opnion</a>, <a class='category' href='/blog/categories/policy/'>policy</a>
  
</span>


  </span>

  
</article>

        </div>
      </div>
      
      
      <div class="row">
        <div class="col-md-offset-3 col-md-6">
          <article>
  <h2><a href="/blog/2013/12/01/how-do-i-change-my-homeland-with-open-data/">How Do I Change My Homeland With Open Data?</a></h2>
  
  <p>
    <p>Open data will change the world, and nations. How do I change my homeland with open data?</p>




<p>I find this article today
<a href="http://www.soumu.go.jp/menu_news/s-news/01ryutsu02_02000081.html">http://www.soumu.go.jp/menu_news/s-news/01ryutsu02_02000081.html</a></p>




<p>This is the software application contest using open data given by Ministry of Internal Affairs and Communications. I am interested in this content from two view points.</p>




<p>First, as a software developer, I am interested technologies used for mobile applications such as iOS or Android. For my engineer career and satisfying my interest, I want develop mobile applications this time.</p>




<p>Second, I want to develop an application which is able to answer social problems such as economic gap, social security, low birthrate and longevity. Open data enables us to develop such applications easily. I think all software should be developed and used for making our society good place. Solving all problems is real hacker mind. With open data, I want to make our homeland better place.</p>




<p>Given data listed below.</p>




<ol>
<li>Administration data stored local authorities.</li>
<li>Usability and cost of social capital</li>
<li>Information for travellers</li>
<li>Disaster prevention data</li>
<li>Information of transportation system</li>
<li>A large variety of statistics data</li>
</ol>




<p>I cannot understand what these data is completely. This contest deadline is February, 2014. There is not much time for me, but enough.</p>




<h2>My open data library.</h2>




<p>Already I have developed a library for iOS.</p>




<p><a href="https://github.com/Lewuathe/LEStatsRequest">https://github.com/Lewuathe/LEStatsRequest</a></p>




<p>LEStatsRequest is the API client of statistics of Japan government. This library contributes open data movement in Japan. You can obtain official data with this client espacially in iOS device. iOS device is restricted memory capacity, so this library parses response XML and make useful objects. With this library, you can use Japan open data easily. If you have some interest in open data, please check it.</p>




<p>In the future, open data surely changes our life. Our involvement with government and society will require our more positiveness. I think this is good thing for current closed our society.</p>




<p>I want to make the use of my ability for our society.</p>


  </p>
  <span class="meta">
    written 








  



<time datetime="2013-12-01T19:09:00+09:00" pubdate data-updated="true">Dec 1<span>st</span>, 2013</time>
    

in
<span class="categories">
  
    <a class='category' href='/blog/categories/data/'>data</a>, <a class='category' href='/blog/categories/open/'>open</a>
  
</span>


  </span>

  
</article>

        </div>
      </div>
      
      
      <div class="row">
        <div class="col-md-offset-3 col-md-6">
          <article>
  <h2><a href="/blog/2013/11/28/my-first-jenkins-plugin/">My First Jenkins Plugin</a></h2>
  
  <p>
    <p>Released my first Jenkins plugin</p>




<p><a href="https://github.com/jenkinsci/hckrnews-plugin">https://github.com/jenkinsci/hckrnews-plugin</a></p>




<p><img src="/images/posts/2013-11-28-hckrnews-plugin/screen-shot.png" alt="Screen shot" /></p>




<p>With this plugin, you can read hacker news top time line sitting in front of CI server.
So you can read top topics about technology and so on at the same time building your project. Does it sound good?</p>




<h2>How to publish Jenkins plugin?</h2>




<h3>Make GitHub repository</h3>




<p>Normal Maven project needs only src/ and pom.xml. Jenkins plugin project is not exception.
Write right .gitignore, and ignore target/ and work/ directory. These are not necessary.</p>




<h3>Create new jenkins-ci account</h3>




<p>Visit <a href="https://jenkins-ci.org/account/">here</a>. Create your new account.</p>




<h3>Write settings.xml your account information</h3>




<p>Your account name, and password got from above process should be written in <code>~/.m2/settings.xml</code> like below.</p>


<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;settings&gt;
</span><span class='line'> ・・・
</span><span class='line'>  &lt;servers&gt;
</span><span class='line'>    &lt;server&gt;
</span><span class='line'>      &lt;id&gt;maven.jenkins-ci.org&lt;/id&gt;
</span><span class='line'>      &lt;username&gt;XXXXXX&lt;/username&gt;
</span><span class='line'>      &lt;password&gt;XXXXXX&lt;/password&gt;
</span><span class='line'>    &lt;/server&gt;
</span><span class='line'>  &lt;/servers&gt;
</span><span class='line'>  ・・・
</span><span class='line'>&lt;/settings&gt;</span></code></pre></td></tr></table></div></figure></p>

<h3>Application for forking repository</h3>




<p>Send an email to community <a href="https://groups.google.com/forum/#!forum/jenkinsci-ja">mailing list</a> in Japan. If you want to send other community, search <a href="http://jenkins-ci.org/content/mailing-lists">here</a>
Soon your repository is forked to original jenkinsci organization.</p>




<h3>Modify pom.xml</h3>




<p>Add some line. SCM repository url should be written in your project <code>pom.xml</code></p>


<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;scm&gt;
</span><span class='line'>    &lt;connection&gt;scm:git:ssh://github.com/jenkinsci/XXXXXXXX.git&lt;/connection&gt;
</span><span class='line'>    &lt;developerConnection&gt;scm:git:ssh://git@github.com/jenkinsci/XXXXXXXX.git&lt;/developerConnection&gt;
</span><span class='line'>    &lt;url&gt;<a href="https://github.com/jenkinsci/XXXXXXXX.git&amp;lt;/url&amp;gt;">https://github.com/jenkinsci/XXXXXXXX.git&amp;lt;/url&amp;gt;</a>
</span><span class='line'>&lt;/scm&gt;</span></code></pre></td></tr></table></div></figure></p>

<h3>Release!</h3>




<p>Type below command.</p>


<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ mvn release:prepare release:perform</span></code></pre></td></tr></table></div></figure></p>

<p>One this your should pay attention to is not to add <code>-Dusername</code> and <code>-Dpassword</code> options. These are not used for GitHub but jenkinsci.org
Congratulations!!</p>




<h3>Future</h3>




<p>In fact, I make this plugin with no experience of writing Java, of course maven.
Therefore I have to study these tool and Java grammar. In addition to this, I learned how to write some design patterns with coding in accordance with OO programming.</p>




<p>I also wrote some test codes with JUnit in maven. TDD is the method with which I want to develop. In this time, first I wrote unit test code and second logic code. This is fun for me because my code&rsquo;s quality seems to be kept easily. I want to keep writing test code first. This is the best practice for my developing.</p>




<p>This plugin has only simple functions, however, this experience is sufficient value as software engineer.
In the future, I will seize the moment and make more my own plugins.</p>




<p>Ultimately, please use this plugin. It brings to you a new continuous integration life.</p>




<p>Thank you.</p>


  </p>
  <span class="meta">
    written 








  



<time datetime="2013-11-28T21:15:00+09:00" pubdate data-updated="true">Nov 28<span>th</span>, 2013</time>
    

in
<span class="categories">
  
    <a class='category' href='/blog/categories/java/'>Java</a>, <a class='category' href='/blog/categories/jenkins/'>Jenkins</a>, <a class='category' href='/blog/categories/maven/'>Maven</a>, <a class='category' href='/blog/categories/plugin/'>plugin</a>
  
</span>


  </span>

  
</article>

        </div>
      </div>
      
      
      <div class="row">
        <div class="col-md-offset-3 col-md-6">
          <article>
  <h2><a href="/blog/2013/11/22/maifalseriteiripoto/">マイノリティ・リポート</a></h2>
  
  <p>
    <p>この夏にあったことだ。</p>




<p><img src="/images/posts/2013-11-22-minority/tie.jpg" alt="tie" /></p>




<p>一般的に社会人が半ズボンを履いて会社へ行くことは「正しくない」ことだと考えられている。
でもこの夏はとっても暑かったので、半ズボンがどれだけ許されるのか知りたいということもありいろいろなズボンで会社に行ってみた。
長ズボン、七分丈、膝の見える短パン。長さや柄を混ぜこぜにして出勤してみた。</p>




<p>そうしたところ、柄やメーカーにかかわらず膝が見えると「それ、(会社に履いてくるの)大丈夫？」と聞いてくる人がいることがわかった。
なるほど、膝が見えるとダメらしい。というわけでいちいちめんどくさいので夏の後半はどんなに暑くても七分丈にすることにした。</p>




<h2>「正しい」と「正しくない」</h2>




<p>ところでどうして、短パンは「正しくない」と判断されて、長ズボンは「正しい」と判断されるんだろうか。
どうして、規則に「反している」、「反していない」と言われないんだろうか。あるいは規則がどうして「正しい」と判断されるんだろうか。
社会人としてスーツを着てくることが「正しい」と考える人は多いと思う。でもどうしてそれを「多くの人がやっているから」とか、「規則で決まっているから」
とか言わないんだろう。どうして「正しい」という価値が入ってしまうんだろう。</p>




<p>もし僕が社会人としてスーツは「正しくない」じゃないと言ったらどうなんだろう。</p>




<p>「そんな風に思うやつはお前だけだ」と言われるかもしれない。
だとしたら、スーツを着る理由は「正しい」からではなく、「大勢がそうしている」からだ。</p>




<p>「昔からそうだったんだ」と言われるかもしれない。
だとしたら、スーツを着る理由は「正しい」からではなく、「昔からそうしている」からだ。</p>




<p>「スーツには社会人として必要な機能が備わっているからだ」と言われるかもしれない。
だとしたら、スーツを着る理由は「正しい」からではなく、「社会人として必要な機能が備わっている」からだ。</p>




<p>僕が言いたいのは「正しい」、「正しくない」という価値判断をむやみに加えて論理的な理由付けをうやむやにしてしまうのは良くないことだと思うということ。</p>




<p>「正しい」、「正しくない」は人によって違う。
でもポケットがいっぱいあって便利というのはだれにとってもほぼ同じ感覚だ。</p>




<p>何か規則を決めたり、考えを広めるときに「正しい」というラベルをはらないとそれを広めることが難しいと感じることがある。
だから人はむやみにこれは「正しい」、あれは「正しくない」ということを必ず言ってしまうのだと思う。</p>




<p>別にいいと思う。「正しさ」なんて大義名分をはらなくても、理屈が通っていれば。
「便利だから」、「暖かいから」、「毎日着る洋服に迷うことがないから」、「どんなお店にも入れるから」。
それでいいじゃないか。</p>




<h2>桃太郎がいなければ鬼もいない</h2>




<p>結果として一緒じゃないかと思うかもしれない。理屈が通っていようが通っていまいが、お前がスーツを着ろと言われることは同じじゃないかと。
でも全然違うんだ。正義の味方は悪の秘密結社を必要とする。</p>




<p>アンパンマンはバイキンマンが必要だし名探偵コナンは殺人犯が必要だ。桃太郎では鬼がいなければ話ははじまらないし、ショッカー軍団がいなければ仮面ライダーは何もしないだろう。</p>




<p>「正しい」意見は必ず「正しくない」意見を必要とする。</p>




<p>彼らのせいで必ず悪者が作られる。確かに「作られる」。
本当は正義の反対側はもうひとつの正義にすぎない。「正しい」といった瞬間に「正しくない」意見ができる。そして、「正しくない」意見を排除しようとする。
本当はもうひとつの「正しさ」であるはずの意見が排除される理由になってしまう。</p>




<p>「暖かい洋服だから」という意見に「寒い洋服でいい」という意見が間違っているとも劣っているとも思わない。</p>




<p>ただ「正しいから」と言ってしまうと「正しくないものでいい」というのはなんだかおかしい。本人は正しくなくていいと思っているのかもしれないが、僕は言ってあげたい。</p>




<p>「君の意見も同じように正しいんだ」と。</p>




<p>だから決して「正しい」意見というものを言わないで欲しい。半ズボンを履くのも「不快に感じる人がいるから」とか、「風邪をひきやすいから」とかそう言って欲しい。
決してそれらが「正しい」わけではないけれど。</p>


  </p>
  <span class="meta">
    written 








  



<time datetime="2013-11-22T11:13:00+09:00" pubdate data-updated="true">Nov 22<span>nd</span>, 2013</time>
    

in
<span class="categories">
  
    <a class='category' href='/blog/categories/minority/'>minority</a>, <a class='category' href='/blog/categories/opnion/'>opnion</a>
  
</span>


  </span>

  
</article>

        </div>
      </div>
      
      
      <div class="row">
        <div class="col-md-offset-3 col-md-6">
          <article>
  <h2><a href="/blog/2013/11/16/developing-jenkins-plugin-on-vagrant/">Developing Jenkins Plugin on Vagrant</a></h2>
  
  <p>
    <p>Recently I investigate the scalability of Jenkins. In my idea, I want to make hot standby Jenkins server with NFS. So the plugins which enable us to do that are required. And for my study, I decided to develop on Vagrant and VirtualBox. It costs me very little because there is no need to get real server.  So in this post, I will describe how to set up your jenkins plugin environment on your vagrant Ubuntu.</p>




<h2>Start vagrant</h2>




<p>My <code>Vagrantfile</code> is below. Before this, you should download precise64 box on vagrant <a href="http://www.vagrantbox.es/">site</a></p>


<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># &ndash;<em>&ndash; mode: ruby &ndash;</em>&ndash;
</span><span class='line'># vi: set ft=ruby :
</span><span class='line'>
</span><span class='line'>Vagrant.configure(&ldquo;2&rdquo;) do |config|
</span><span class='line'>  # Every Vagrant virtual environment requires a box to build off of.
</span><span class='line'>  config.vm.box = &ldquo;ubuntu&rdquo;
</span><span class='line'>
</span><span class='line'>  # Create a forwarded port mapping which allows access to a specific port
</span><span class='line'>  # within the machine from a port on the host machine. In the example below,
</span><span class='line'>  # accessing &ldquo;localhost:8080&rdquo; will access port 80 on the guest machine.
</span><span class='line'>  config.vm.network :forwarded_port, guest: 8080, host: 8080
</span><span class='line'>
</span><span class='line'> end</span></code></pre></td></tr></table></div></figure></p>

<p>Jenkins plugin server starts on port 8080. So you need to write guest port 8080. Host port can be written any number.
And start vagrant.</p>


<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ vagrant up</span></code></pre></td></tr></table></div></figure></p>

<h2>Set up maven3</h2>




<p>Jenkins plugins are build with Maven. In this time, Maven3 can build sample plugin easily, so I recommend that you download maven3.</p>


<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ sudo apt-get install maven</span></code></pre></td></tr></table></div></figure></p>

<h2>Write settings.xml</h2>




<p>Write settings.xml as below.</p>


<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;settings&gt;
</span><span class='line'>  &lt;pluginGroups&gt;
</span><span class='line'>    &lt;pluginGroup&gt;org.jenkins-ci.tools&lt;/pluginGroup&gt;
</span><span class='line'>  &lt;/pluginGroups&gt;
</span><span class='line'>
</span><span class='line'>  &lt;profiles&gt;
</span><span class='line'>    &lt;!&mdash; Give access to Jenkins plugins &mdash;&gt;
</span><span class='line'>    &lt;profile&gt;
</span><span class='line'>      &lt;id&gt;jenkins&lt;/id&gt;
</span><span class='line'>      &lt;activation&gt;
</span><span class='line'>        &lt;activeByDefault&gt;true&lt;/activeByDefault&gt; &lt;!&mdash; change this to false, if you don&rsquo;t like to have it on per default &mdash;&gt;
</span><span class='line'>      &lt;/activation&gt;
</span><span class='line'>      &lt;repositories&gt;
</span><span class='line'>        &lt;repository&gt;
</span><span class='line'>          &lt;id&gt;repo.jenkins-ci.org&lt;/id&gt;
</span><span class='line'>          &lt;url&gt;<a href="http://repo.jenkins-ci.org/public/&amp;lt;/url&amp;gt;">http://repo.jenkins-ci.org/public/&amp;lt;/url&amp;gt;</a>
</span><span class='line'>        &lt;/repository&gt;
</span><span class='line'>      &lt;/repositories&gt;
</span><span class='line'>      &lt;pluginRepositories&gt;
</span><span class='line'>        &lt;pluginRepository&gt;
</span><span class='line'>          &lt;id&gt;repo.jenkins-ci.org&lt;/id&gt;
</span><span class='line'>          &lt;url&gt;<a href="http://repo.jenkins-ci.org/public/&amp;lt;/url&amp;gt;">http://repo.jenkins-ci.org/public/&amp;lt;/url&amp;gt;</a>
</span><span class='line'>        &lt;/pluginRepository&gt;
</span><span class='line'>      &lt;/pluginRepositories&gt;
</span><span class='line'>    &lt;/profile&gt;
</span><span class='line'>  &lt;/profiles&gt;
</span><span class='line'>  &lt;mirrors&gt;
</span><span class='line'>    &lt;mirror&gt;
</span><span class='line'>      &lt;id&gt;repo.jenkins-ci.org&lt;/id&gt;
</span><span class='line'>      &lt;url&gt;<a href="http://repo.jenkins-ci.org/public/&amp;lt;/url&amp;gt;">http://repo.jenkins-ci.org/public/&amp;lt;/url&amp;gt;</a>
</span><span class='line'>      &lt;mirrorOf&gt;m.g.o-public&lt;/mirrorOf&gt;
</span><span class='line'>    &lt;/mirror&gt;
</span><span class='line'>  &lt;/mirrors&gt;
</span><span class='line'>&lt;/settings&gt;</span></code></pre></td></tr></table></div></figure></p>

<h2>JDK!!</h2>




<p>I failed to create my plugin in this time bacause of lack of JDK. Ubuntu 12.04 LTS doesn&rsquo;t have JDK in own image. You have to install it.</p>


<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ sudo apt-get install default-jdk</span></code></pre></td></tr></table></div></figure></p>

<h2>Build plugin</h2>




<p>Building plugin with maven command.</p>


<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ mvn install</span></code></pre></td></tr></table></div></figure></p>

<p>And demonstrate your plugin.</p>


<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ mvn hpi:run</span></code></pre></td></tr></table></div></figure></p>

<p>You can see Jenkins web UI on <a href="http://localhost:8080/jenkins">http://localhost:8080/jenkins</a> unless maven command has not exit.
So now, I can get multi Jenkins server for mutual mount on NFS. My Jenkins study has been continued.</p>


  </p>
  <span class="meta">
    written 








  



<time datetime="2013-11-16T21:09:00+09:00" pubdate data-updated="true">Nov 16<span>th</span>, 2013</time>
    

in
<span class="categories">
  
    <a class='category' href='/blog/categories/jenkins/'>Jenkins</a>, <a class='category' href='/blog/categories/ubuntu/'>Ubuntu</a>, <a class='category' href='/blog/categories/vagrant/'>Vagrant</a>
  
</span>


  </span>

  
</article>

        </div>
      </div>
      
      
      <div class="row">
        <div class="col-md-offset-3 col-md-6">
          <article>
  <h2><a href="/blog/2013/11/10/nu-li-falseli-you/">頑張る理由</a></h2>
  
  <p>
    <p>読んだ。</p>




<p><a href="http://karigari.hatenablog.com/entry/2013/11/06/000000">http://karigari.hatenablog.com/entry/2013/11/06/000000</a></p>




<p>全く自分にとって新しいことでなくても、文字に起こされると驚くことがある。概念は知っていても言葉は知らない、そんな感じだ。自分が何か努力したり頑張ったり、そういったことを何のためにしているか。</p>




<p>答えは「自分のため」いつもそう答えていた。その答えは今でも変わらないけれど、その概念のエイリアスがあるとしたら、「やった事実はなくならないから」じゃないだろうか。</p>




<p>僕自身は今まで努力してきたことが報われることもあったし、報われないこともあった。努力でなんでも叶えられるとも思わないけれど、努力してやってやれないこともないんじゃないかと漠然と感じている。
だから僕はやりたいことがあったら努力したらいいんじゃないかと思う派だ（派閥があるとすればだけど）それが叶うとか叶わないとかあんまり関係なく頑張ってみればいいんじゃないかと体が知っているからだ。</p>




<p>でもだからそれを言葉にできない。もちろん言葉にできないから答えを知らないんだけれど、「やった事実はなくならない」という言葉はその答えなんじゃないかと感じた。</p>




<h3>やった事実はなくならない</h3>




<p>今までも頑張ってきていろんな結果が出てきたけれど、確かにやったことはなくなってないよなーって思う。受験勉強で覚えたこととか大体忘れたし、学生の時水泳もやっていたけれど、もうお腹だけぽっこり出始めてきたし運動してない。
それでもなくなってないよって思う。やっぱり体がそれを知っている。人間の体って1年の間にほぼ入れ替わるらしいからそれを知っていた体もほぼほぼなくなっているんだけど、それでもなくなってないよな。</p>




<p>多分、努力することの大切さを知っている人はこのことが分かっているんだと思う。夢は必ず叶うとか、諦めずにいればなんとかなるとか。本当はそういうことじゃなくてただ、「なくならないよ」って言いたいんだと思う。
結果はどうあれなくならない。それが失敗でも成功でも誰かに横取りされても盗まれても。自分が頑張った事実はなくならない。</p>




<p>そのなくならなかったものが役に立つとか全くわからない。けれどもなくならなかったものが体の中に幾つかあるっていうのはとても気持ちのいいものだ。なんて言うんだろう。体の中に金庫がある感じ。でも鍵は持ってない。
その中にいろいろ大事なものが入っているんだけれど自分にも開け方がわからなくてそれが使うこともできない。でも中に大事な何かが入っていることはわかって、頑張ったり努力したりするといつの間にかそこにものが入っていくことも
知っている。そういう感覚。</p>




<p>努力した結果はどうだか知らないけれど、努力した事実はなくならないことはわかってる。</p>




<p>多分そのことも努力した結果なくならなかった&#8221;事実&#8221;だと思う。</p>


  </p>
  <span class="meta">
    written 








  



<time datetime="2013-11-10T15:12:00+09:00" pubdate data-updated="true">Nov 10<span>th</span>, 2013</time>
    

in
<span class="categories">
  
    <a class='category' href='/blog/categories/life/'>Life</a>, <a class='category' href='/blog/categories/study/'>Study</a>
  
</span>


  </span>

  
</article>

        </div>
      </div>
      
      
      <div class="row">
        <div class="col-md-offset-3 col-md-6">
          <article>
  <h2><a href="/blog/2013/11/09/scikit-learndecross-validation/">scikit-learnでCross Validation</a></h2>
  
  <p>
    <p>だんだんとscikit-learnとMachine Learningに慣れてきた。
今回はCross ValidationとGrid Searchをやってみた。</p>




<h3>Cross Validation</h3>




<p>詳しいことは<a href="http://ja.wikipedia.org/wiki/%E4%BA%A4%E5%B7%AE%E6%A4%9C%E5%AE%9A">Wikipedia</a>に書いてある。
Cross Validationはモデルの妥当性を検証する方法のひとつ。一般的に開発用のデータは訓練データと検証データに分かれる。
しかし、このまま行ってしまうと折角の訓練データが減ってしまうことになる上に、訓練データの選び方によって汎化性能が下がってしまう可能性がある。
Wikipediaに書いてあるもののホールド・アウト検定がこれに当たる。一般にはこれはCross Validationにはあたらない。</p>




<p>ここに書いてあるK-分割交差検定がこれに当たる。K-分割交差検定では開発用のデータをK個に分割しK-1個を訓練用に、残りの一つを検証用に使いモデルの正当性を計算する。
これにより使える訓練データが増えると同時に、これらを訓練データを変えることにより、汎化性能を上げることができる。</p>




<p>scikit-learnで具体的にどのように行うのか書いてみた。訓練に使ったデータとしてはKaggleの<a href="http://www.kaggle.com/c/data-science-london-scikit-learn">Data Science London</a>で出されているものを用いた。</p>




<h3>SVM</h3>




<p>まずは単純にサポートベクターマシンでクラス分けをさせた時のコード</p>


<p><figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="c"># &ndash;<em>&ndash; coding: utf-8 &ndash;</em>&ndash;</span>
</span><span class='line'>
</span><span class='line'><span class="kn">import</span> <span class="nn">os</span>
</span><span class='line'><span class="kn">import</span> <span class="nn">sys</span>
</span><span class='line'><span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">svm</span>
</span><span class='line'><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
</span><span class='line'><span class="kn">import</span> <span class="nn">csv</span>
</span><span class='line'>
</span><span class='line'><span class="k">if</span> <span class="n"><strong>name</strong></span> <span class="o">==</span> <span class="s">&quot;<strong>main</strong>&quot;</span><span class="p">:</span>
</span><span class='line'>    <span class="n">train_feature_file</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">genfromtxt</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="s">&quot;../data/train.csv&quot;</span><span class="p">,</span> <span class="s">&quot;rb&quot;</span><span class="p">),</span> <span class="n">delimiter</span><span class="o">=</span><span class="s">&quot;,&quot;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
</span><span class='line'>    <span class="n">train_label_file</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">genfromtxt</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="s">&quot;../data/trainLabels.csv&quot;</span><span class="p">,</span> <span class="s">&quot;rb&quot;</span><span class="p">),</span> <span class="n">delimiter</span><span class="o">=</span><span class="s">&quot;,&quot;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">train_features</span> <span class="o">=</span> <span class="p">[]</span>
</span><span class='line'>    <span class="n">train_labels</span> <span class="o">=</span> <span class="p">[]</span>
</span><span class='line'>    <span class="k">for</span> <span class="n">train_feature</span><span class="p">,</span> <span class="n">train_label</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">train_feature_file</span><span class="p">,</span> <span class="n">train_label_file</span><span class="p">):</span>
</span><span class='line'>        <span class="n">train_features</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">train_feature</span><span class="p">)</span>
</span><span class='line'>        <span class="n">train_labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">train_label</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">train_features</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">train_features</span><span class="p">)</span>
</span><span class='line'>    <span class="n">train_labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">train_labels</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">clf</span> <span class="o">=</span> <span class="n">svm</span><span class="o">.</span><span class="n">SVC</span><span class="p">(</span><span class="n">C</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">cache_size</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">class_weight</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">coef0</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">degree</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">gamma</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">kernel</span><span class="o">=</span><span class="s">&quot;rbf&quot;</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=&ndash;</span><span class="mi">1</span><span class="p">,</span> <span class="n">probability</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span><span class="n">random_state</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">shrinking</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_features</span><span class="p">,</span> <span class="n">train_labels</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">test_feature_file</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">genfromtxt</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="s">&quot;../data/test.csv&quot;</span><span class="p">,</span> <span class="s">&quot;rb&quot;</span><span class="p">),</span> <span class="n">delimiter</span><span class="o">=</span><span class="s">&quot;,&quot;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">test_features</span> <span class="o">=</span> <span class="p">[]</span>
</span><span class='line'>    <span class="k">print</span> <span class="s">&quot;Id,Solution&quot;</span>
</span><span class='line'>    <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span>
</span><span class='line'>    <span class="k">for</span> <span class="n">test_feature</span> <span class="ow">in</span> <span class="n">test_feature_file</span><span class="p">:</span>
</span><span class='line'>        <span class="k">print</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;,&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test_feature</span><span class="p">)[</span><span class="mi">0</span><span class="p">]))</span>
</span><span class='line'>        <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>このモデルをCross Validationで検証してみる。</p>


<p><figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="k">def</span> <span class="nf">get_score</span><span class="p">(</span><span class="n">clf</span><span class="p">,</span> <span class="n">train_features</span><span class="p">,</span> <span class="n">train_labels</span><span class="p">):</span>
</span><span class='line'>    <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">cross_validation</span><span class="o">.</span><span class="n">train_test_split</span><span class="p">(</span><span class="n">train_features</span><span class="p">,</span> <span class="n">train_labels</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</span><span class='line'>    <span class="k">print</span> <span class="n">clf</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>cross_validation.train_test_splitは一定の割合が検証用データとなるように開発用データを分割する関数。この場合は<code>test_size=0.4</code>を指定したので、40%のデータを検証用として使うことになる。
<code>fit</code>が60%の訓練データで行うもので、scoreが残された40%のデータで検証を行いその正答率を出してくれる。これがこのモデルの、このテストデータにおける正当性となる。もちろんこれが高ければ高いほどよいが
汎化性能が高いかどうかはここからでは読み取ることができない。そのためK分割を行うことでK回の検証を行うことができる。これらのスコアを平均することで汎化性能も含めたモデルの正当性を表すことができる。</p>


<p><figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="k">def</span> <span class="nf">get_accuracy</span><span class="p">(</span><span class="n">clf</span><span class="p">,</span> <span class="n">train_features</span><span class="p">,</span> <span class="n">train_labels</span><span class="p">):</span>
</span><span class='line'>    <span class="n">scores</span> <span class="o">=</span> <span class="n">cross_validation</span><span class="o">.</span><span class="n">cross_val_score</span><span class="p">(</span><span class="n">clf</span><span class="p">,</span> <span class="n">train_features</span><span class="p">,</span> <span class="n">train_labels</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</span><span class='line'>    <span class="k">print</span><span class="p">(</span><span class="s">&quot;Accuracy: </span><span class="si">%0.2f</span><span class="s"> (+/&ndash; </span><span class="si">%0.2f</span><span class="s">)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">scores</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">scores</span><span class="o">.</span><span class="n">std</span><span class="p">()</span> <span class="o">*</span> <span class="mi">2</span><span class="p">))</span>
</span></code></pre></td></tr></table></div></figure></p>

<p><code>cross_validation_cross_val_score</code>でこれらの検証のすべてのscoreを得ることができる。<code>cv</code>はK分割の分割の個数を指定することができる。今回は開発用のデータを10個に分割し10回の検証を行う。
scoresには10個のscoreが入ったリストが返ってくる。これの平均をAccuracyとして出している。これで汎化性能も含めたモデルの正当性を得ることができるが、モデルパラメータのチューニングを手で行う必要がある。
手で調整して、Accuracyを計算するというのは非常に手間なのでGrid Searchというアルゴリズムでこのチューニングをある程度自動化することができる。</p>




<h3>Grid Search</h3>




<p>パラメータの範囲を指定することで経験的に最適なパラメータの組を探索する方法がGrid Search。Pythonで行うには以下のように書く。</p>


<p><figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="k">def</span> <span class="nf">grid_search</span><span class="p">(</span><span class="n">train_features</span><span class="p">,</span> <span class="n">train_labels</span><span class="p">):</span>
</span><span class='line'>    <span class="n">param_grid</span> <span class="o">=</span> <span class="p">[</span>
</span><span class='line'>        <span class="p">{</span><span class="s">&#39;C&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">1000</span><span class="p">],</span> <span class="s">&#39;kernel&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s">&#39;linear&#39;</span><span class="p">]},</span>
</span><span class='line'>        <span class="p">{</span><span class="s">&#39;C&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">1000</span><span class="p">],</span> <span class="s">&#39;gamma&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.001</span><span class="p">,</span> <span class="mf">0.0001</span><span class="p">],</span> <span class="s">&#39;kernel&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s">&#39;rbf&#39;</span><span class="p">]},</span>
</span><span class='line'>    <span class="p">]</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">clf</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">svm</span><span class="o">.</span><span class="n">SVC</span><span class="p">(</span><span class="n">C</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">param_grid</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=&ndash;</span><span class="mi">1</span><span class="p">)</span>
</span><span class='line'>    <span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_features</span><span class="p">,</span> <span class="n">train_labels</span><span class="p">)</span>
</span><span class='line'>    <span class="k">print</span> <span class="n">clf</span><span class="o">.</span><span class="n">best_estimator_</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>param_gridに指定することでこの範囲を指定することができる。n_jobsに並列に計算を行うプロセス数を指定することができる。-1を指定するとコア数をデフォルト選ぶようになっている。与えられた訓練データに対してGrid Searchを行う。
時間は少しかかるが、この訓練データに対して最もスコアが高くなるようなモデルパラメータを選ぶことができる。この訓練データを実際のテストデータに使うことができる。</p>




<h3>まとめ</h3>




<p>PRMLには実際の機械学習のプロセスみたいなものがあまり細かく書かれていないのでKaggleに提出されているコードとかを実際にみて、こういったプロセスが分かるようになってきた。
あとscikit-learnが便利すぎて、機械学習の学習アルゴリズムだけじゃなくて特徴抽出とかモデルパラメータの最適化なども整備されていたことに驚いた。</p>


  </p>
  <span class="meta">
    written 








  



<time datetime="2013-11-09T21:56:00+09:00" pubdate data-updated="true">Nov 9<span>th</span>, 2013</time>
    

in
<span class="categories">
  
    <a class='category' href='/blog/categories/cross-validation/'>Cross Validation</a>, <a class='category' href='/blog/categories/python/'>Python</a>, <a class='category' href='/blog/categories/scikit-learn/'>scikit-learn</a>
  
</span>


  </span>

  
</article>

        </div>
      </div>
      
      
      <div class="row">
        <div class="col-md-offset-3 col-md-6">
          <article>
  <h2><a href="/blog/2013/11/03/tf-idfdetagufu-ke/">TF-IDFでタグ付け</a></h2>
  
  <p>
    <p>Kaggleで挑戦できそうな問題があったのでチャレンジしてみた。</p>




<p><a href="http://www.kaggle.com/c/facebook-recruiting-iii-keyword-extraction">http://www.kaggle.com/c/facebook-recruiting-iii-keyword-extraction</a></p>




<p>Stack Exchange(Stack Overflowみたいなもの)にあるテキストとそのタグデータを訓練データとして
同様にStack Exchangeにあるページからタグを類推せよという問題。
多分キーワード抽出を行う方法がうまく行くんじゃないかと思いやってみた。</p>




<h2>TF-IDFアルゴリズム</h2>




<p><img src="/images/posts/2013-11-03-tfidf/equation.png" alt="Equation" /></p>




<p>基本的にはTF-IDFを使ってみる。これは文書中のtokenの重要度をその頻度と、他の文書にどれくらいないかの指標
の積として表すアルゴリズム。コードで書くと下のような感じ。</p>


<p><figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
</span><span class='line'><span class="n">term</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">Target</span> <span class="n">Term</span><span class="o">&gt;</span>
</span><span class='line'><span class="n">include_document_num</span> <span class="o">=</span> <span class="nb">len</span><span class="p">([</span><span class="n">d</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">all_documents</span> <span class="k">if</span> <span class="n">term</span> <span class="ow">in</span> <span class="n">d</span><span class="p">])</span>
</span><span class='line'><span class="n">word_score</span> <span class="o">=</span> <span class="n">term_frequency</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span> <span class="n">all_document_num</span> <span class="o">/</span> <span class="n">include_document_num</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>term_frquencyはその文書中にどれくらいその単語が出てきたか。多くの場合は正規化してある。
その後ろの項は全文書中にその単語を含む文書がどれくらいあるかの比の逆数。これは他の文書にその単語がなければないほど大きくなるので、その単語がその文書のキーワードとして十分に機能することを示唆している。
TF-IDFのTFはTerm FrequencyでIDFはInversed Document Frequencyの略だ。</p>




<p>今回はTestデータの各文書の単語として有効な単語(htmlタグや各種記法は省くようにした)についてword_scoreを計算し、その中から正規化されたscoreが10%を超えたものをその文書のキーワードとして抽出するようにしてみた。
プログラムのコアの部分は以下のような形になった。</p>


<p><figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="c"># 全テストデータ</span>
</span><span class='line'><span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">test_file</span><span class="p">:</span>
</span><span class='line'>    <span class="c"># テストデータとしてタイトルもあるのでこいつも利用してみる</span>
</span><span class='line'>    <span class="n">title_tokens</span> <span class="o">=</span> <span class="n">nltk</span><span class="o">.</span><span class="n">word_tokenize</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span class='line'>
</span><span class='line'>  <span class="c"># 英数字意外の文字を取り除いた</span>
</span><span class='line'>    <span class="n">tokens</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">r&quot;\W+&quot;</span><span class="p">,</span> <span class="n">nltk</span><span class="o">.</span><span class="n">clean_html</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
</span><span class='line'>
</span><span class='line'>  <span class="c"># ここは自分でかってに付け足した部分。タイトルに含まれる単語達は特別扱いして10個余分に足しておく</span>
</span><span class='line'>  <span class="c"># 本当はここは文書中の何%とかにした方が各文書でのタイトルの重要度にばらつきがでなくていいのかもしれない</span>
</span><span class='line'>    <span class="k">for</span> <span class="n">title_token</span> <span class="ow">in</span> <span class="n">title_tokens</span><span class="p">:</span>
</span><span class='line'>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">):</span>
</span><span class='line'>            <span class="n">tokens</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">title_token</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>  <span class="c"># 同じ単語のscoreを計算しても意味ないので重複を消しておく</span>
</span><span class='line'>    <span class="n">uniqTokens</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">tokens</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>  <span class="c"># 各tokenのscoreを計算。実際の計算はNLTKに任せた</span>
</span><span class='line'>    <span class="n">tf_idf_scores</span> <span class="o">=</span> <span class="p">{}</span>
</span><span class='line'>    <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">uniqTokens</span><span class="p">:</span>
</span><span class='line'>        <span class="n">tf_idf_scores</span><span class="p">[</span><span class="n">token</span><span class="p">]</span> <span class="o">=</span> <span class="n">collection</span><span class="o">.</span><span class="n">tf_idf</span><span class="p">(</span><span class="n">token</span><span class="p">,</span> <span class="n">tokens</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>  <span class="c"># scoreでソート</span>
</span><span class='line'>    <span class="n">sorted_tf_idf_scores</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">tf_idf_scores</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span class='line'>
</span><span class='line'>  <span class="c"># 10%を超えたものをkeywordsとして登録</span>
</span><span class='line'>    <span class="n">keywords</span> <span class="o">=</span> <span class="p">[</span> <span class="n">k</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">sorted_tf_idf_scores</span> <span class="k">if</span> <span class="n">v</span> <span class="o">&gt;</span> <span class="mf">0.1</span><span class="p">]</span>
</span><span class='line'>  <span class="c"># 1個もないのは変なので1番scoreが高いものだけでも抽出しておく</span>
</span><span class='line'>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">keywords</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
</span><span class='line'>        <span class="n">keywords</span> <span class="o">=</span> <span class="p">[</span> <span class="n">sorted_tf_idf_scores</span><span class="p">[</span><span class="o">&ndash;</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="p">]</span>
</span><span class='line'>
</span><span class='line'>  <span class="c"># ファイル出力</span>
</span><span class='line'>    <span class="n">result_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;</span><span class="si">%s</span><span class="s">,</span><span class="se">&amp;quot;</span><span class="si">%s</span><span class="se">&amp;quot;\n</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">keywords</span><span class="p">)))</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>訓練データがあまりにもデカイので、ちょっと全部は訓練できない。
一部の訓練データに対して試してみて余分はかなり出てくるけれど、抜けは割りとない。</p>


<p><figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="err">推定キーワード</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span><span class="s">&quot;an without type file image check uploaded mime&quot;</span>
</span><span class='line'><span class="err">正解キーワード</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span><span class="s">&quot;php image-processing file-upload upload mime-types&quot;</span>
</span></code></pre></td></tr></table></div></figure></p>

<p><figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="err">推定キーワード</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span><span class="s">&quot;How ctrl press prevent firefox closing&quot;</span>
</span><span class='line'><span class="err">正解キーワード</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span><span class="s">&quot;firefox&quot;</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>image-processingとか、そもそもそういう単語を文書に含んでなかったらこの方法だと抽出できない。もっと関係抽出とか固有表現認識とかしないといけないかも。あとタイトルの重みを強くし過ぎたせいか&#8221;How&#8221;とか&#8221;Can&#8221;とかの単語も結構入ってきてしまう。Stack ExchangeとかStack Overflowって自分が書くときを考えてみてもそうだけど、単純に疑問文書くことも多いから単純にタイトルにキーワードが含まれているだろうという考えは甘いかも。</p>




<p>もう少しチューニングしてみる。あと訓練データが600万件近くあるのでできるだけたくさん利用できるように工夫したい。
(マシンスペックと時間を考えても100万件が今の限界・・・)</p>


  </p>
  <span class="meta">
    written 








  



<time datetime="2013-11-03T22:28:00+09:00" pubdate data-updated="true">Nov 3<span>rd</span>, 2013</time>
    

in
<span class="categories">
  
    <a class='category' href='/blog/categories/machine-learning/'>Machine Learning</a>, <a class='category' href='/blog/categories/kaggle/'>kaggle</a>
  
</span>


  </span>

  
</article>

        </div>
      </div>
      
      
      <div class="row">
        <div class="col-md-offset-3 col-md-6">
          <article>
  <h2><a href="/blog/2013/10/25/osswoshi-u%2C-zuo-ru/">OSSを使う、作る</a></h2>
  
  <p>
    <p>昨日、以前作ったOSSのライブラリにpatchが送られてきた。</p>




<p><a href="https://github.com/Lewuathe/passport-yj">https://github.com/Lewuathe/passport-yj</a></p>




<p><img src="/images/posts/2013-10-25-oss/code.png" alt="passport-yj" /></p>




<p>友人とかなり昔に作ったので、存在を忘れていたとまではいかないがpatchが送られてきたときは驚いた。何したらいいんだろうという感じだった。
patchの内容はpassport-yjの依存しているpassportモジュールの仕様が変わったから対応したらーということで送ってくれた。</p>




<p>僕は正直passportの仕様をキャッチアップできていなかったので、こうやってpatchが送られてきて嬉しかった。</p>




<p>自分たちが作ったソフトウェアがよりよくなるということ、そして何よりどこかの誰かが使ってくれているということが目で見える形で分かったからだ。</p>




<p>patchを送ってくれた人は少なくとも日本人ではあるみたいだけれど僕とは縁もゆかりもない人だ。(もっとも顔写真もなにもないので、縁もゆかりも本当にないのかもよくわからない)
そんな人がどこかでこのライブラリを使って、改善点があったのでpatchを送ってくれた。送られたpatchを落としてきてテストして動作を確認する。僕自身も今までに大きなプロジェクト、小さなプロジェクトにちょこちょこpatchを送っていた。そこでディスカッションをしたり、取り込んでもらえたりもらえなかったり。そのコードはそういう意味で書いてあるのかと疑問が氷解したり。</p>




<p>そして気づいた。ああ、これがOSSへの貢献なんじゃないかと。</p>




<p>LinuxとかWebKitとか、大きなプロジェクトへの貢献を夢見てなんとなく憧れを抱いていたけど、今自分がやっていたことは紛れもなくOSS活動じゃないか。ずっとやりたいと思っていたことをいつの間にか僕はやっていた。誰かが仕事から帰ってちょこちょこっと作った小さなライブラリ僕が使い、僕が週末に作った小さなモジュールをどこかの誰かが使う。その誰かは日本の人かもしれないし、外国の人かもしれないし、人間ですらないかもしれない。(さっき見たら<a href="https://github.com/Lewuathe/node-jp">node-jp</a>はbotっぽいのにたくさんforkされてた)そういうコードを介した会話みたいなものはまさにソーシャルコーディングだし、僕はそれがやりたかった。</p>




<p>誰かが少しだけ世界を良くしようと思って作ったものを、他の誰かが使って実際に世界を少しだけ良くしている。大きさとか規模はあんまり関係なくて自分がそれを感じることができるかどうか。僕は見ず知らずの人からpatchが送られてくることでそれを感じた。</p>




<p>またいつでもpatchが来てもいいように、折角なので自動化テストを書いておこう。</p>




<p>きっと世界が少しだけ良くなると思う。</p>


  </p>
  <span class="meta">
    written 








  



<time datetime="2013-10-25T21:53:00+09:00" pubdate data-updated="true">Oct 25<span>th</span>, 2013</time>
    

in
<span class="categories">
  
    <a class='category' href='/blog/categories/oss/'>OSS</a>
  
</span>


  </span>

  
</article>

        </div>
      </div>
      
      
      <div class="row">
        <div class="col-md-offset-3 col-md-6">
          <article>
  <h2><a href="/blog/2013/10/20/dockerwoshi-tutemiyou/">Dockerで仮想化をはじめよう</a></h2>
  
  <p>
    <p>仮想環境構築の方法のひとつに<a href="http://www.docker.io/">Docker</a>を使ってみた。いままではVirtualBoxを使ってVagrantからつないでいく方法をやってみたけれど、仮想マシンをいちいち立ち上げる方法はどうも遅いのでDockerというもので試してみた。</p>




<p>Dockerの特徴は以下記事から抜粋。</p>




<p><a href="http://apatheia.info/blog/2013/06/17/docker/">http://apatheia.info/blog/2013/06/17/docker/</a></p>




<ul>
<li>仮想マシンを立ち上げるわけではなく、ホスト内の隔離された環境で動作するため起動が速い。<a href="http://linuxcontainers.org/">LXC</a>という技術のことらしい。ここでこの隔離されたシステムのことを <strong>コンテナ</strong> という。</li>
<li>AUFSを使っている。起動したときはディレクトリを重ねあわせておいて、更新の際に別の場所に書き込むというファイルシステムっぽい。立ち上げ時にイメージコピーがいらないので起動が軽い。</li>
</ul>




<h2>動かしてみた</h2>




<p>環境は以下で行った</p>




<ul>
<li>MacOSX 10.8</li>
<li>VirtualBox 4.2</li>
<li>vagrant 1.2.4</li>
</ul>




<p>他にUbuntu LTS12.04が入ったマシンを持っていたのでVagrant使わずにそっちでトライしたら32bitだとだめらしい。どうもUbuntu日本語コミュニティには32bitイメージしかなかったのでぼけーっと入れたらそっちになってしまったみたい。また入れなおすのもとりあえずめんどくさいのでMacのVagrantにUbuntu仮想マシンを立ち上げてその上にDockerを起動させるという構成。</p>




<p><a href="http://docs.docker.io/en/latest/installation/vagrant/">ここ</a>に従えば特に問題なくいけた。</p>


<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ git clone <a href="https://github.com/dotcloud/docker.git">https://github.com/dotcloud/docker.git</a>
</span><span class='line'>$ cd docker
</span><span class='line'>$ vagrant up</span></code></pre></td></tr></table></div></figure></p>

<p>ここまでで10minくらいかかる。でも悪いのはVirtualBoxとvagrant。</p>


<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># dockerが起動するか見てみる
</span><span class='line'>$ docker
</span><span class='line'># サブコマンドがだーっと出る</span></code></pre></td></tr></table></div></figure></p>

<h2>イメージをダウンロード</h2>


<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ sudo docker pull ubuntu</span></code></pre></td></tr></table></div></figure></p>

<h2>先ほどのコンテナ内でスクリプトを動作させる</h2>


<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># sudo docker run &lt;実行対象コンテナ&gt; &lt;コマンド(引数あってもいい)&gt;
</span><span class='line'>$ sudo docker run ubuntu /bin/echo hello world</span></code></pre></td></tr></table></div></figure></p>

<p>別にsudoはなくてもいい
これらはDockerのコンテナ内で実行されているコマンドだが、いまいち仮想ホスト立てている感じにならない。それを感じるためにはDockerをdaemon化させる必要がある。</p>




<h2>コマンドをdaemon化させる</h2>




<p>走らせるコマンドを定義する。このコマンドはコンテナのIDを返す。このIDをもとにそのコンテナで何がおきているかを見る
-dはコマンドをdaemon化させるオプション</p>


<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ CONTAINER_ID=$(sudo docker run -d ubuntu /bin/sh -c &ldquo;while true; do echo hello world; sleep 1; done&rdquo;)</span></code></pre></td></tr></table></div></figure></p>

<p>そして起動させる。</p>


<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ sudo docker logs $CONTAINER_ID</span></code></pre></td></tr></table></div></figure></p>

<p>さっきのコンテナIDが返ってくるのでこいつを<code>docker logs</code>に渡してやると実行されているコマンドの値が見えるようになる。たただしこれは実行が終わったら返ってくるのでリアルタイムにコマンドの結果を見たければ<code>attach</code>を使う</p>


<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ sudo docker attach $CONTAINER_ID</span></code></pre></td></tr></table></div></figure></p>

<p>ここまで適当にやっていったら、いっぱいコンテナができてしまったので確認してみる。dockerが起動したコマンドたちを確認する場合は<code>ps</code>サブコマンドを使う。</p>


<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ docker ps
</span><span class='line'>ID                  IMAGE               COMMAND                CREATED             STATUS              PORTS
</span><span class='line'>4841794938a7        ubuntu:12.04        /bin/sh -c while tru   7 minutes ago       Up 7 minutes          <br/>
</span><span class='line'>79b862e271bc        ubuntu:12.04        /bin/sh -c while tru   8 minutes ago       Up 8 minutes                <br/>
</span><span class='line'>bee9d7a00611        ubuntu:12.04        /bin/sh -c while tru   9 minutes ago       Up 9 minutes           </span></code></pre></td></tr></table></div></figure></p>

<p>こいつらをとめたければ<code>stop</code>を使う</p>


<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ sudo docker stop 4841794938a7
</span><span class='line'>4841794938a7
</span><span class='line'>
</span><span class='line'>$ sudo docker ps
</span><span class='line'>ID                  IMAGE               COMMAND                CREATED             STATUS              PORTS
</span><span class='line'>79b862e271bc        ubuntu:12.04        /bin/sh -c while tru   13 minutes ago      Up 13 minutes           <br/>
</span><span class='line'>bee9d7a00611        ubuntu:12.04        /bin/sh -c while tru   14 minutes ago      Up 14 minutes                    </span></code></pre></td></tr></table></div></figure></p>

<h2>まとめ</h2>




<p>今回のチュートリアルは<a href="http://docs.docker.io/en/latest/examples/hello_world/#running-examples">ここ</a>からすべてとった。Dockerかなり簡単だけれど、いまいちコマンドをひとつひとつ打っているだけな気がして仮想マシンをたてて、実行している感じがあまりしない。ここで実際にWebアプリとか作ることとかもできるっぽいのでもうちょっと見ていこうかと。</p>


  </p>
  <span class="meta">
    written 








  



<time datetime="2013-10-20T20:30:00+09:00" pubdate data-updated="true">Oct 20<span>th</span>, 2013</time>
    

in
<span class="categories">
  
    <a class='category' href='/blog/categories/docker/'>Docker</a>
  
</span>


  </span>

  
</article>

        </div>
      </div>
      
      
      <div class="row">
        <div class="col-md-offset-3 col-md-6">
          <article>
  <h2><a href="/blog/2013/10/18/masutasenseihaxu-wotukanai/">マスターセンセイは嘘をつかない</a></h2>
  
  <p>
    <p>仕事で、あるアジャイルプロジェクトに関わってきた。</p>




<p>スクラムマスターとなり、初めてのアジャイルプロジェクトを進めてもう3ヶ月ほどになる。</p>




<p>今日、アジャイルのススメ方についてこれまでも指導をくれていた人から幾つか言葉をもらったので
これまでの３ヶ月、これからのこと、アジャイルですすめることの本質とか考えてみたのでまとめる。</p>




<p>ちなみにこの人は僕の中ではマスターセンセイと呼んでいるので、以下同一人物。</p>




<h2>無理はしない</h2>




<p>アジャイルの根底にある本質を一言で表せと言われたらこの言葉になると思う。無理はしないというと消極的に思われるかもしれないので
足るを知ると言ってもいいかもしれない。自分たちに何ができて何ができないかをきちんと知ろうという姿勢はあるような気がする。
毎日のデイリースクラムに遅刻してくるメンバーがいたら彼が来られるようにしてあげるか、あるいは彼が来られる時間にしてあげるかだ。
もちろん無理はあってはいけないから彼が無理しなくては来られないのであれば前者はなしだ。プロジェクトを進める上で無理はあってはいけない。
それはリスクの増加につながるからだ。</p>




<p><img src="/images/posts/2013-10-18-agile_scrum/daily_scrum.png" alt="Daily Scrum" /></p>




<h2>「使うかもしれない」はきっと「使わない」</h2>




<p>今考えられるユーザストーリとか、タスクとか。スクラムにあったら便利かもと思うようなツールとかスキーマとか。そういうものを
必要になっていないのに取り出しはじめるのは良くないということ。具体的に言おう。僕達は各タスクに「優先度シール」なるものを
貼っていたときがある。これはプロダクトバックログがまだ優先度順に並んでいなくてコンポーネントごとに貼り付けてしまっていたことが
原因だった。（つまり優先順位順に並べることができなかった）その中でも何を優先するべきかを表示するラベルを僕達は作った。そして捨てた。
もうユーザストーリリストごとにタスクをリストアップできるようになったからだ。それでも「優先度シール」あっても良かったかもしれない。
だっていつか「使うかもしれない」。またプロダクトバックログの順序がばらばらになる時がくるかもしれない。
悩んでいるとマスターセンセイは教えてくれた。</p>




<blockquote><p>でもそれは捨てるべきなんだ。</p></blockquote>




<p><img src="/images/posts/2013-10-18-agile_scrum/rolex.png" alt="Trash" /></p>




<p>必要になったらまた作ればいい。アジャイルというのは小回りを効かせるために身軽さを求めるものなのかもしれない。
プロジェクトのフレームワークに必要のなくなった「もの」は基本的にはその場から捨ててしまうのがいい。
アジャイルをすすめる前に決めたインセプションデッキの問いのひとつにはこんなものがある。</p>




<p>「なぜ僕たちはここにいるのか」</p>




<p>この「使うかもしれない」を増やしていくとこの問に答えづらくなっていってしまうんじゃないかな。と僕は思う。</p>




<p>ちなみにマスターセンセイは『<a href="http://www.amazon.co.jp/%E3%83%88%E3%83%A8%E3%82%BF%E3%81%AE%E7%89%87%E3%81%A5%E3%81%91-OJT%E3%82%BD%E3%83%AA%E3%83%A5%E3%83%BC%E3%82%B7%E3%83%A7%E3%83%B3%E3%82%BA/dp/4806145483">トヨタの片付け</a>』という本も紹介してくれた。</p>




<h2>兼務はしない</h2>




<p>１人が１度に抱えるタスクは最大で２つまでだ。これは『<a href="http://www.amazon.co.jp/%E3%82%A2%E3%82%B8%E3%83%A3%E3%82%A4%E3%83%AB%E3%81%AA%E8%A6%8B%E7%A9%8D%E3%82%8A%E3%81%A8%E8%A8%88%E7%94%BB%E3%81%A5%E3%81%8F%E3%82%8A-~%E4%BE%A1%E5%80%A4%E3%81%82%E3%82%8B%E3%82%BD%E3%83%95%E3%83%88%E3%82%A6%E3%82%A7%E3%82%A2%E3%82%92%E8%82%B2%E3%81%A6%E3%82%8B%E6%A6%82%E5%BF%B5%E3%81%A8%E6%8A%80%E6%B3%95~-Mike-Cohn/dp/4839924023/ref=sr_1_1?s=books&amp;ie=UTF8&amp;qid=1382104183&amp;sr=1-1&amp;keywords=%E3%82%A2%E3%82%B8%E3%83%A3%E3%82%A4%E3%83%AB%E3%81%AA%E8%A6%8B%E7%A9%8D%E3%82%82%E3%82%8A%E3%81%A8%E8%A8%88%E7%94%BB%E3%81%A5%E3%81%8F%E3%82%8A">アジャイルな見積もりと計画づくり</a>』の中で語られているデータにもとづいている。その中で語られていることはこうだ。</p>




<ul>
<li>マルチタスク化は生産性に甚大な悪影響を与える</li>
<li>クラークとウィールライトによるマルチタスク化の研究で、個人が3つ以上の作業を並行して進めると、価値を生み出す作業に使える時間が大幅に減少することがわかった</li>
<li>2つの作業を変更に進めると、片方の作業が進められなくなったときに、もう片方の作業に切り替えることができるため、効率があがる</li>
</ul>




<p>僕達はずっと兼務を続けていた。しかも兼務をしているにもかかわらずアジャイルの中でのタスク割り振りまで重複して行ってしまっていた。これはまずい。
これは理由はどうあれ効率が落ちるからだ。データが示している。タスクAとタスクBをこなす必要があるのであれば、必ずAの次にBだ(もちろんBの次にAでもいいが同時はダメだ)
本の中では2つのタスクは気分転換の意味もあり、少しではあるが１０%ほど効率があがると書いてあるが、僕達はそもそもが兼務で集まったチームなのでダメだ。
人間は最大のパフォーマンスを発揮して且つ１度にできることは１つなのだと思う。マスターセンセイはこう言っていた。</p>




<blockquote><p>僕達みたいな普通の人がマルチタスクで片手間に作ったものなんて大したものができないんだよ</p></blockquote>




<p><img src="/images/posts/2013-10-18-agile_scrum/enough.png" alt="Enough!" /></p>




<p>非凡な才能溢れる人間でない限りは複数のことを１度に進めてはいけない。</p>




<h2>おまじないなんてない</h2>




<p>アジャイルで進めているプラクティスはどれもデータにもとづいて考えられたものだ。だからそこにおまじないはない。「どうしてこれをやっているんだろう」と思ったら
それは調べるべきだ。きっと答えはある。僕達はバーンダウンチャートを書いていく上で正規のタスク見積もり線の上に３掛けした線をもう一本引いていた。
どうしてかって。僕達がお手本にしていたプロジェクトが行っていたからだ。でもその理由は知らない。さりげなくそのことについてマスターセンセイに聞いた。</p>




<blockquote><p>上の線は本来はメンバーの持てるのすべての時間を表す。そこから７掛けして見積もり線を出せば各タスクのバッファを考えずにスプリント単位でずれを吸収してくれるんだよ</p></blockquote>




<p>なるほど、そういうことだったのか。</p>




<p>ちなみにこの７割という数字も多くのプロジェクトを研究して出した数字らしい。</p>




<p><img src="/images/posts/2013-10-18-agile_scrum/magic.png" alt="magic" /></p>




<p>教訓：疑問に思ったら調べろ</p>




<h2>まとめ</h2>




<p>３ヶ月で何が分かるかというぐらいアジャイルは奥深い。けれど最後に書いたようにアジャイルスクラムは魔法のメソッドなんてものではなくて、自分で考え試行錯誤していかなくちゃいけないものだとわかった。</p>




<p>でもひとつ大事なことは、アジャイルには「無理をしない」という点で１つ筋が通っているような気がした。できるものはできないし、できないものはできない。そのことをなんとなしに言ってしまうのではなくきちんと計測可能な数値で考えることができるフレームワークがアジャイルスクラムなのだと思う。</p>


  </p>
  <span class="meta">
    written 








  



<time datetime="2013-10-18T22:25:00+09:00" pubdate data-updated="true">Oct 18<span>th</span>, 2013</time>
    

in
<span class="categories">
  
    <a class='category' href='/blog/categories/agile/'>Agile</a>
  
</span>


  </span>

  
</article>

        </div>
      </div>
      
      
      <div class="row">
        <div class="col-md-offset-3 col-md-6">
          <article>
  <h2><a href="/blog/2013/10/04/paseputoronfalseshi-zhuang/">Scalaでパーセプトロンを作った</a></h2>
  
  <p>
    <p>PRMLの線形識別モデルの章の内容。PRMLの中に書いてある線形識別モデルをざっと実装しようと思っていたけれど、
最小二乗法に依る識別とフィッシャーの線形識別は割りとけちょんけちょんにけなされているイメージだったので、とりあえずおいておくことにします。</p>




<p>というわけでパーセプトロンを作ってみたよ。
今回もソースは<a href="https://github.com/PhysicsEngine/cpi-stats">ここ</a></p>




<p>パーセプトロンは誤分類を行ったデータに対してのみパーセプトロン基準にもとづいて重みベクトルを変化させていくアルゴリズム。このアルゴリズムは基本的には
2クラスの分類にだけしか使えないが、線形分類可能なデータ集合に対しては有限ステップで必ず分類できるモデルを構築できるという特徴と持つ。すごい！</p>




<h2>パーセプトロン規準</h2>


<p><figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'><span class="k">val</span> <span class="n">phi</span> <span class="k">=</span> <span class="nc">DenseVector</span><span class="o">(</span><span class="mf">1.0</span><span class="o">,</span> <span class="n">point</span><span class="o">(</span><span class="mi">0</span><span class="o">),</span> <span class="n">point</span><span class="o">(</span><span class="mi">1</span><span class="o">))</span>
</span><span class='line'><span class="n">phi</span> <span class="o"><em></span> <span class="n">point</span><span class="o">(</span><span class="mi">2</span><span class="o">)</span> <span class="o"></em></span> <span class="nc">_eta</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>データ点にバイアスを加えたベクトルphiとデータ点の目的値(-1, 1)の積がパーセプトロン規準になる。この値は正しく分類されているデータに対しては常に正の値になる。つまりこの値が負の場合だけ重みベクトルを更新するように書くことができる。</p>




<p>こんな感じに書いた。</p>


<p><figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'><span class="n">plist</span><span class="o">.</span><span class="n">foreach</span> <span class="o">{</span>
</span><span class='line'>  <span class="n">point</span> <span class="k">=&gt;</span> <span class="o">{</span>
</span><span class='line'>    <span class="k">val</span> <span class="n">phi</span> <span class="k">=</span> <span class="nc">DenseVector</span><span class="o">(</span><span class="mf">1.0</span><span class="o">,</span> <span class="n">point</span><span class="o">(</span><span class="mi">0</span><span class="o">),</span> <span class="n">point</span><span class="o">(</span><span class="mi">1</span><span class="o">))</span>
</span><span class='line'>      <span class="k">if</span> <span class="o">((</span><span class="nc"><em>w</span><span class="o">.</span><span class="n">t</span> <span class="o"><em></span> <span class="n">phi</span><span class="o">).</span><span class="n">apply</span><span class="o">(</span><span class="mi">0</span><span class="o">)</span> <span class="o"></em></span> <span class="n">point</span><span class="o">(</span><span class="mi">2</span><span class="o">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>        <span class="nc"></em>w</span> <span class="o">+=</span> <span class="n">phi</span> <span class="o"><em></span> <span class="n">point</span><span class="o">(</span><span class="mi">2</span><span class="o">)</span> <span class="o"></em></span> <span class="nc">_eta</span>
</span><span class='line'>      <span class="o">}</span>
</span><span class='line'>  <span class="o">}</span>
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>すべての点に対してパーセプトロン規準に従い更新処理をかける。PRMLでは確率的最急降下アルゴリズムで更新をかける式が書いてあったので後でそちらも試してみる。
ここで注意しておきたいのは、パーセプトロンでは学習中に重みベクトルが変化すると正しく分類されていたパターンも誤分類されてしまうことがある。そのため、すべてのパターンが正しく分類されているかを再度検証する必要がある。</p>


<p><figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'><span class="n">plist</span><span class="o">.</span><span class="n">foreach</span> <span class="o">{</span>
</span><span class='line'>  <span class="n">point</span> <span class="k">=&gt;</span> <span class="o">{</span>
</span><span class='line'>    <span class="k">val</span> <span class="n">phi</span> <span class="k">=</span> <span class="nc">DenseVector</span><span class="o">(</span><span class="mf">1.0</span><span class="o">,</span> <span class="n">point</span><span class="o">(</span><span class="mi">0</span><span class="o">),</span> <span class="n">point</span><span class="o">(</span><span class="mi">1</span><span class="o">))</span>
</span><span class='line'>      <span class="k">if</span> <span class="o">((</span><span class="nc">_w</span><span class="o">.</span><span class="n">t</span> <span class="o"><em></span> <span class="n">phi</span><span class="o">).</span><span class="n">apply</span><span class="o">(</span><span class="mi">0</span><span class="o">)</span> <span class="o"></em></span> <span class="n">point</span><span class="o">(</span><span class="mi">2</span><span class="o">)</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>        <span class="n">correct</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span class='line'>      <span class="o">}</span>
</span><span class='line'>  <span class="o">}</span>
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>この<code>correct</code>がデータ点と等しくなったら学習を終える。
パーセプトロンははじめに線形分離可能なモデルならば<em>必ず</em>分離できるモデルを構築できるが、そうでない場合はいつまでも収束しない。そのため、もしそのようなデータ集合を与えた場合は上記の<code>correct</code>はずっとデータ点数を同じにならない。</p>




<p>今回は2次元上に2クラスの学習用データ集合を生成。それぞれのクラスの平均、共分散行列は固定で書いてあとは良きにはからってpylabに生成してもらった。</p>




<p>さて、実際にどのような感じか見てみる。</p>




<p><img src="/images/posts/2013-10-04-perceptron/N=100.png" alt="N=100" /></p>




<p>初期の重みベクトルはすべて要素が1の単純なベクトルで行った。それでもこの処理にかかったステップ数は３とかなり少ない。
PRMLではパーセプトロン学習アルゴリズムが収束するのに必要なステップ数はかなり多いと書いてあったけれど思っていたよりは少ない。もちろん2次元空間上で、尚且つたかだかデータ点数が100なので総結論づけれれないけれど、あくまでも思っていたよりかはということ。</p>




<p>結構分類が難しそうなものもやってみた。</p>




<p><img src="/images/posts/2013-10-04-perceptron/difficult.png" alt="難しそう" /></p>




<p>きちんと分類できている。これも重みベクトルの初期値は同じ。ステップ数も変わらない。つまりあくまでも初期値と線形分離可能性に大きく依存するので、あんまりクラス集合が近いとか遠いとか関係ないみたい。そこら辺は最小二乗法と大きく違うところ。</p>




<p>線形分離不可能なものもやってみた。</p>




<p><img src="/images/posts/2013-10-04-perceptron/impossible.png" alt="線形分離不可能" /></p>




<p>はい、やっぱりダメ。実際には収束しないので途中でプログラムを切って得た画像。</p>




<p>10minくらい走らせたけどダメだった。終わらない。</p>




<h2>確率的最急降下法</h2>




<p>さっきまでは全点を選んでの最急降下法で重みベクトルを更新していったけれど、PRMLに書いてあるように確立的最急降下法で計算してみるとどうだろう。計算コスト的にはかなり小さくなるはずだけれど、ステップ数も増えなければ最急降下法での計算の方が良さそう。どうなるか試してみたい。</p>




<p>実装としては以下のようにした。</p>


<p><figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'><span class="k">val</span> <span class="n">index</span> <span class="k">=</span> <span class="nc">Math</span><span class="o">.</span><span class="n">floor</span><span class="o">(</span><span class="nc">Math</span><span class="o">.</span><span class="n">random</span><span class="o">()<em></span><span class="n">plist</span><span class="o">.</span><span class="n">length</span><span class="o">).</span><span class="n">toInt</span>
</span><span class='line'><span class="k">val</span> <span class="n">point</span> <span class="k">=</span> <span class="n">plist</span><span class="o">(</span><span class="n">index</span><span class="o">)</span>
</span><span class='line'><span class="k">val</span> <span class="n">phi</span> <span class="k">=</span> <span class="nc">DenseVector</span><span class="o">(</span><span class="mf">1.0</span><span class="o">,</span> <span class="n">point</span><span class="o">(</span><span class="mi">0</span><span class="o">),</span> <span class="n">point</span><span class="o">(</span><span class="mi">1</span><span class="o">))</span>
</span><span class='line'><span class="k">if</span> <span class="o">((</span><span class="nc">_w</span><span class="o">.</span><span class="n">t</span> <span class="o"></em></span> <span class="n">phi</span><span class="o">).</span><span class="n">apply</span><span class="o">(</span><span class="mi">0</span><span class="o">)</span> <span class="o"><em></span> <span class="n">point</span><span class="o">(</span><span class="mi">2</span><span class="o">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>  <span class="nc">_w</span> <span class="o">+=</span> <span class="n">phi</span> <span class="o"></em></span> <span class="n">point</span><span class="o">(</span><span class="mi">2</span><span class="o">)</span> <span class="o">*</span> <span class="nc">_eta</span>
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>データ点の中からランダムに1点を選び、その点に対してパーセプトロン規準に従い重みベクトルを更新する。</p>




<p>さて、やってみた。</p>




<p><img src="/images/posts/2013-10-04-perceptron/step=3.png" title="step=3" alt="step=3" /><img src="/images/posts/2013-10-04-perceptron/step=1069.png" title="step=1069" alt="step=1069" /></p>




<p>分類結果は当然変わらない。線形分類可能なら必ず収束する。左が先ほどまでの全点選択での最急降下法。右が確率的最急降下法。</p>




<p>ただしステップ数が大きく異なる。全点選択はステップ数3に対して確率的最急降下法はステップ数が1069！</p>




<p>確率的に降下方向を選ぶのは全点選ぶのと対して変わらないとどっかに(PRMLではない)書いてあったのに、結構違う。
もちろん全点選択の場合は1ステップで今回200点のループを回しているので実質600ほどのパーセプトロン規準での計算を行っている。それでも確率的最急降下法の方が多い。</p>




<p>個人的には確率的最急降下法は計算コストもかからないし、精度も対して落ちないかなり良さげなアルゴリズムだと思っていたのでちょっと意外だった。まあもちろんデータ点の数や状態、あとは重みベクトルの初期値なんかでもいろいろ変わってくると思うので一概には言えないですよね。</p>




<p>パーセプトロン奥が深いです</p>


  </p>
  <span class="meta">
    written 








  



<time datetime="2013-10-04T23:10:00+09:00" pubdate data-updated="true">Oct 4<span>th</span>, 2013</time>
    

in
<span class="categories">
  
    <a class='category' href='/blog/categories/machine-learning/'>Machine Learning</a>, <a class='category' href='/blog/categories/perceptron/'>Perceptron</a>
  
</span>


  </span>

  
</article>

        </div>
      </div>
      
      
      <div class="row">
        <div class="col-md-offset-3 col-md-6">
          <article>
  <h2><a href="/blog/2013/09/29/moderuebidensufalseping-jia/">モデルエビデンスの評価</a></h2>
  
  <p>
    <p>作ったプログラムは以下においたよ。</p>




<p><a href="https://github.com/PhysicsEngine/cpi-stats">https://github.com/PhysicsEngine/cpi-stats</a></p>




<p>ここで作成した線形回帰モデルのエビデンス評価をしてみた。
モデルエビデンスはざっくり言うと、訓練データを与える尤度を周辺化した値。つまり、そのデータを与える可能性が最も高いものを選ぶことができればパラメタの複雑さなどを自分で判断しなくてもよいというメリットがある。</p>




<p>今回、実装したのは基底関数を多項式とした場合で各目標値には加法性のガウスノイズがのる前提で計算を行った。</p>




<p>超パラメタalpha(モデルパラメタのばらつき)とbeta(ガウスノイズの精度)はそれぞれ0.0001、15.0にした。推定の方法としてはベイズ推定の予測分布を計算して行った。</p>


<p><figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'><span class="c1">// Mはモデルパラメタの数</span>
</span><span class='line'><span class="k">val</span> <span class="n">bayesRegression</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">BayesRegression</span><span class="o">(</span><span class="n">M</span><span class="o">,</span> <span class="mf">0.0001</span><span class="o">,</span> <span class="mf">15.0</span><span class="o">)</span>
</span></code></pre></td></tr></table></div></figure></p>

<h1>モデルエビデンスの評価</h1>




<p>基本的にはPRML(3.86)式に従った。</p>


<p><figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'><span class="c1">// Alphaはパラメタの分布の事前分布のばらつきを表す超パラメタ</span>
</span><span class='line'><span class="c1">// Betaはガウスノイズの精度を表す超パラメタ</span>
</span><span class='line'><span class="c1">// eMnの最大尤度での二乗和誤差</span>
</span><span class='line'><span class="o">(</span><span class="n">M</span><span class="o">/</span><span class="mf">2.0</span><span class="o">)</span> <span class="o"><em></span> <span class="nc">Math</span><span class="o">.</span><span class="n">log</span><span class="o">(</span><span class="nc">Alpha</span><span class="o">)</span> <span class="o">+</span> <span class="o">(</span><span class="n">xlist</span><span class="o">.</span><span class="n">length</span><span class="o">/</span><span class="mf">2.0</span><span class="o">)</span> <span class="o"></em></span> <span class="nc">Math</span><span class="o">.</span><span class="n">log</span><span class="o">(</span><span class="nc">Beta</span><span class="o">)</span> <span class="o">&ndash;</span> <span class="n">eMn</span> <span class="o">&ndash;</span> <span class="mi">1</span><span class="o">/</span><span class="mf">2.0</span> <span class="o"><em></span> <span class="nc">Math</span><span class="o">.</span><span class="n">log</span><span class="o">(</span><span class="n">det</span><span class="o">(</span><span class="n">inv</span><span class="o">(</span><span class="nc">_sN</span><span class="o">)))</span> <span class="o">&ndash;</span> <span class="n">xlist</span><span class="o">.</span><span class="n">length</span> <span class="o">/</span> <span class="mf">2.0</span> <span class="o"></em></span> <span class="nc">Math</span><span class="o">.</span><span class="n">log</span><span class="o">(</span><span class="mi">2</span> <span class="o">*</span> <span class="nc">Math</span><span class="o">.</span><span class="nc">PI</span><span class="o">)</span>
</span></code></pre></td></tr></table></div></figure></p>

<p><img src="/images/posts/2013-09-29-ModelEvidense/evidense.png" alt="モデルエビデンス" /></p>




<p>モデルエビデンスをモデルパラメタの複雑さ2~100の間でプロットした。赤線はM=4の位置。M=4で最大となっていることがわかる。というわけでそれぞれの主要な位置で実際のモデルのグラフをプロットしてみた</p>




<h2>M=3の場合</h2>




<p>なんか直線っぽく見えるけれど、二次関数です。ほぼあってないのでエビデンスもすごい低い。二乗和誤差関数の値も大きい。
このモデルはエビデンスを求めなくても選ばれなさそう。</p>




<p><img src="/images/posts/2013-09-29-ModelEvidense/M=3.png" alt="M=3" /></p>




<h2>M=4の場合</h2>




<p>エビデンスが最大のモデル。見た目かなりよくfittingしている。</p>




<p><img src="/images/posts/2013-09-29-ModelEvidense/M=4.png" alt="M=4" /></p>




<h2>M=9の場合</h2>




<p>むむ、M=4の場合と対して変わらない。</p>




<p><img src="/images/posts/2013-09-29-ModelEvidense/M=9.png" alt="M=9" /></p>




<h2>M=15の場合</h2>




<p>これもあんまり変わらない。対数尺度で見た時に10程度の差しかないからか。この差はエビデンスでみると大して大きな差ではないのかもしれない。</p>




<p><img src="/images/posts/2013-09-29-ModelEvidense/M=15.png" alt="M=15" /></p>




<h2>M=30の場合</h2>




<p>over fittingし始めた。M=15とM=30で大きく異るところはエビデンスの値というよりは訓練データ集合が25個だからそれより多いか少ないかの違いな気がする。</p>




<p>直感的には基底関数を多項式にしているので最尤推定で行うと訓練データ集合よりもモデルパラメータの数が多いとすべての点を通るようなグラフになる。今回はベイズ推定で行っているので事前分布のお陰で全点を通るなんてことはないけれど、それでも過学習をし始める分岐点としては訓練データの数になるかもしれない。</p>




<p>x=1付近でしか過学習してないのが気になるけれど。</p>




<p><img src="/images/posts/2013-09-29-ModelEvidense/M=30.png" alt="M=30" /></p>




<h2>M=100の場合</h2>




<p>もう右側(x=1付近)のグラフはめちゃめちゃ。でもx=0付近はそんなにおかしくないのはなぜだろう。事前分布における精度は常に一定なのでそんなに場所によってばらついたりしなさそうなんだけど。</p>




<p><img src="/images/posts/2013-09-29-ModelEvidense/M=100.png" alt="M=100" /></p>




<h1>まとめ</h1>




<p>評価値xによって過学習したりしてなかったりするのが気になるけれど、全体としてはエビデンス関数を最大化するようなモデルパラメタMを選ぶことによって、最適なモデルを作ることができそう。PRMLにも書いてあったけれど、「目で見りゃいいじゃん」というのはもっと高次元になった場合に通用しなくなるので、解析的にモデルを評価できる手法は有用。しかも割と時間もそんなにかからない。(Scalaでモデル100個の評価を行ったけれど1~2秒ほど)</p>




<p>超パラメタ、alphaとbetaに関しても評価してエビデンスを最大化してみるとよりよいモデルが得られるのかも。</p>


  </p>
  <span class="meta">
    written 








  



<time datetime="2013-09-29T10:17:00+09:00" pubdate data-updated="true">Sep 29<span>th</span>, 2013</time>
    

in
<span class="categories">
  
    <a class='category' href='/blog/categories/moderuebidensu/'>モデルエビデンス</a>, <a class='category' href='/blog/categories/ji-jie-xue-xi/'>機械学習</a>
  
</span>


  </span>

  
</article>

        </div>
      </div>
      
      
      <div class="row">
        <div class="col-md-offset-3 col-md-6">
          <article>
  <h2><a href="/blog/2013/09/28/devopsday-tokyo-2013nixing-tutekitayo/">DevOpsDay Tokyo 2013に行ってきたよ</a></h2>
  
  <p>
    <p><img src="/images/posts/2013-09-28-DevOpsDay/DevOpsDay-2013.jpg" alt="ノベルティ" /></p>




<p>印象に残った話しをざっとまとめてみる。なぜならBlogをかくまでがDev Ops Dayだから！！</p>




<h1>&ldquo;Making Operations Visible&rdquo; Nick Galbreath</h1>




<p>使いやすいツールとか紹介</p>




<p>DevOpsとはコミュニケーション（マシン間、人間の間、組織の間）</p>




<p>ビジネス側から見えないから価値がない</p>




<p>DevとOpsとBizで相互不信的な感じになると Destructiveですよね。だから、データを使おう（運用としてだけではなく、会社の仕組みとして）</p>




<p>ビジネス視点でのDevOpsと大事なことはコミュニケーションだと言い切ったところが新鮮だった。</p>




<p>Graphiteという統計可視化ツールの話。</p>




<p><a href="https://github.com/graphite-project">https://github.com/graphite-project</a></p>




<p>Diamond brightcoveは使いやすい</p>




<p>StatsDの話。
リアルタイムに統計計算をしてくれる。ログイン回数とか。それをGraphiteに書き込んでいく。特徴的なのはUDPパケットで送信を行うところ。そのためアプリケーション自体には過負荷にならない。またハンドリングとか要らないからエラーが起きない、必要ない。</p>




<h1>&ldquo;introduction to Sensu&rdquo; Sean Porter</h1>




<p>Sensuのお話。いろいろな機能をひとつにまとめて使いやすくしたよ。大事なコンセプトは以下。</p>




<ul>
<li>Autmatic client registration</li>
<li>Utilize existing Nagios checks</li>
<li>Handle network interrunptions</li>
<li>Easy to drive with CM(chef)</li>
<li>Easy to scale out</li>
<li><strong>API</strong></li>
</ul>




<p>Sonial（スポンサー）でしばらく使ってみて役に立つことがわかった</p>




<p>Sensuのワークフローとしては</p>




<ol>
<li>Check</li>
<li>Result</li>
<li>Event</li>
<li>Handle</li>
</ol>




<p>マシンの集まりに対して設定できる(roleみたいなものが設定できる)
JSONの設定ファイルを書いていくだけで使える。割と設定は簡単そう。
SensuはChefと相性が良さそう。</p>




<p>PagerDutyはテキストにもとづいてロボットが電話をかけてくる。日本で作りたい場合はTwilio使ってみましょうということだった。USBに入れられたVirtualBoxのimage入りのsandboxが配られた。すごいセットアップ簡単！
個人的にはGraphiteは見た目あんまりかっこよくないけど、SensuのSenseはいい（笑）</p>




<p>Chef + Sensu + PagerDutyは使えそう。今度自前で立ててみたい。</p>




<p>そして、お昼ごはん！久々の石巻復興弁当！</p>




<p><img src="/images/posts/2013-09-28-DevOpsDay/DevOpsDay-2013_2.jpg" alt="石巻復興弁当" /></p>




<p>途中からスポンサーさんのセッション。</p>




<p>Microsoftの偉大さと力強さを改めて実感。</p>




<h1>&ldquo;Taking Devops to the Next Level&rdquo; Max Martin</h1>




<p>puppet labsの話 DepOpの次の段階へ。
Chefがもてはやされているけれど、Puppetも頑張っているよという話。
最近以下のアップデートとか頑張ったよ。</p>




<ul>
<li>Puppet3.x</li>
<li>Hiera integration</li>
<li>PuppetDB</li>
<li>Mcollective2.x</li>
<li>Geppetto</li>
<li>Puppet Forge</li>
<li>Puppet3.xは2.xとくらべてだいぶパフォーマンス上がったよ</li>
<li>PuppetDBはClojureで書かれているよ、BaseはPostgreSQL、JVM上で動くよ</li>
</ul>




<p>僕は用事があったのでここまで。DevOpsの概念というかスタンスみたいなものが結構聞けたのが収穫。技術的には、Sensuは自前で立てていろいろ弄ってみたいなと思った。</p>




<p>朝早起きだったから眠かったけれど、楽しいセッションばかりで良かった！</p>


  </p>
  <span class="meta">
    written 








  



<time datetime="2013-09-28T10:37:00+09:00" pubdate data-updated="true">Sep 28<span>th</span>, 2013</time>
    

in
<span class="categories">
  
    <a class='category' href='/blog/categories/devopsday/'>DevOpsDay</a>, <a class='category' href='/blog/categories/tokyo/'>Tokyo</a>
  
</span>


  </span>

  
</article>

        </div>
      </div>
      
      
      <div class="row">
        <div class="col-md-offset-3 col-md-6">
          <article>
  <h2><a href="/blog/2013/09/20/neo4jfalseshi-ifang-1/">Neo4jの使い方(1)</a></h2>
  
  <p>
    <p>Neo4jを使ってみたよ。とりあえず触ってみたかったのでインストールはせずに<a href="http://gist.neo4j.org/">GraphGist</a>を使ってCypherの書き方を勉強してみた。</p>




<h1>Cypherって？</h1>




<p>グラフデータベースを操作するためのSQLのこと。他のグラフデータベースに利用されているのかは知らないけれどNeo4jに関してはこのCypherを使ってデータを操作する。SQLを知らないとMySQLに対して何もできないのと同じようにCypherを知らないとNeo4jを何もできない。今回はこのCypherの基本的な構文や書き方を書いてみる。</p>




<p>本家のドキュメントは<a href="http://docs.neo4j.org/chunked/milestone/cypher-query-lang.html">ここ</a>だよ</p>




<h1>ノードの作成</h1>


<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>CREATE (n:Actor {name:&ldquo;Doraemon&rdquo;})</span></code></pre></td></tr></table></div></figure></p>

<p>Actorは型。nameは属性。nはマッチさせるときの記述子</p>




<h2>エッジの作成</h2>


<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>MATCH (actor:Actor)
</span><span class='line'>WHERE actor.name = &ldquo;Doraemon&rdquo;
</span><span class='line'>CREATE (n:Actor {name:&ldquo;Nobita&rdquo;})
</span><span class='line'>CREATE (actor)&ndash;[:HELP]&ndash;&gt;(n)</span></code></pre></td></tr></table></div></figure></p>

<p>Actor型の中でnameがDoraemonのものを探す。見つけたらNobitaを作成し、その間にHELP型のエッジを作成する。</p>




<h2>UNIQUEで作成する</h2>




<p>エッジを同じものを複製したくなければ<code>CREATE UNIQUE</code>を使う</p>


<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>MATCH (actor:Actor)
</span><span class='line'>WHERE actor.name = &ldquo;Doraemon&rdquo;
</span><span class='line'>CREATE UNIQUE (actor)&ndash;[r:ACTED_IN]&ndash;&gt;(movie:Movie {title:&ldquo;Mugen Sankenshi&rdquo;})
</span><span class='line'>RETURN r;</span></code></pre></td></tr></table></div></figure></p>

<h2>属性の変更</h2>


<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>MATCH (actor:Actor)
</span><span class='line'>WHERE actor.name = &ldquo;Doraemon&rdquo;
</span><span class='line'>SET actor.birth_year = 2020
</span><span class='line'>RETURN actor.name, actor.birth_year;</span></code></pre></td></tr></table></div></figure></p>

<h2>全てのノードの列挙</h2>


<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>MATCH (actor:Actor)
</span><span class='line'>RETURN actor as <code>All Actors</code>;</span></code></pre></td></tr></table></div></figure></p>

<h1>パターンマッチ</h1>




<p>グラフデータベースの検索は基本的にパターンマッチを使って行う。既にいくつか出てきたけれどパターンマッチには<code>MATCH</code>文を使う。</p>




<h2>エッジのマッチ</h2>


<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>(a)&ndash;[r]&ndash;&gt;(b)</span></code></pre></td></tr></table></div></figure></p>

<p>ノードは丸括弧で囲み、エッジは角括弧で囲む。</p>


<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>(a)&ndash;[r:HELP]&ndash;&gt;(b)</span></code></pre></td></tr></table></div></figure></p>

<p>型にもマッチさせたいときに型も書く。
無向グラフであれば矢印にはしない.</p>


<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>(a)&mdash;(b)</span></code></pre></td></tr></table></div></figure></p>

<p>複数のタイプにorでマッチさせたいときには縦棒を使う</p>


<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>(a)&ndash;[r:TYPE1|TYPE2]&ndash;&gt;(b)</span></code></pre></td></tr></table></div></figure></p>

<h2>Optional relationship</h2>




<p>マッチしない場合にはその要素だけnullを返して欲しい場合には<code>?</code>を使う。</p>


<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>START me = node(*)
</span><span class='line'>MATCH (me)&mdash;&gt;(friend)&ndash;[?]&ndash;&gt;(friend_of_friend)
</span><span class='line'>RETURN friend,friend_of_friend</span></code></pre></td></tr></table></div></figure></p>

<p>この場合にはこの関係にマッチしないノードがあった場合にはそこの欄だけnullになる。関係があるかないかまだわからないけれど、とりあえずすべての見てみたい場合に有効。</p>




<p>エッジの個数を指定したい場合は<code>*</code>を使う</p>


<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>START me = node(4)
</span><span class='line'>MATCH (me)&ndash;[?*2]&ndash;&gt;(friend)
</span><span class='line'>RETURN friend</span></code></pre></td></tr></table></div></figure></p>

<p>自分から２つ関係をまたいだ友達だけ返す。範囲指定も可能。</p>


<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>START me = node(4)
</span><span class='line'>MATCH (me)&ndash;[?*2..4]&ndash;&gt;(friend)
</span><span class='line'>RETURN friend</span></code></pre></td></tr></table></div></figure></p>

<p>2から4までの関係をまたいだ友達。</p>




<h2>パスの割り当て</h2>




<p>マッチしたパスを見たい場合があるときは、そのまま代入させてしまえばいい。</p>


<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>START me = node(3)
</span><span class='line'>MATCH p1 = (me)&ndash;[*2]&ndash;(friendOfFriend)
</span><span class='line'>CREATE p2 = (me)&ndash;[:MARRIED_TO]&ndash;&gt;(wife {name:&ldquo;Gunhild&rdquo;})
</span><span class='line'>CREATE UNIQUE p3 = wife-[:KNOWS]-friendOfFriend
</span><span class='line'>RETURN p1,p2,p3</span></code></pre></td></tr></table></div></figure></p>

<h1>参照構文</h1>




<p>要素の検索、参照に必要な４つの構文(START, MATCH, WHERE, RETURN)に関して</p>




<h2>START</h2>




<p>STARTは探索を行うためのアンカーとなるノード、またはエッジを決める構文。</p>




<p>以下のようなグラフがあったときに</p>


<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>START n = node(1)</span></code></pre></td></tr></table></div></figure></p>

<p>と書くとnにnodeの1がバインドされ、これを使って探索することが可能。</p>




<p><img src="/images/posts/2013-09-20-neo4j-1/graph.png" alt="Graphの例" /></p>




<p>複数ノード、または全てのノードに対して処理を行いたい場合はこんな感じ。</p>


<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>START n = node(1,2,3)
</span><span class='line'>RETURN n</span></code></pre></td></tr></table></div></figure></p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>START n = node(*)
</span><span class='line'>RETURN n</span></code></pre></td></tr></table></div></figure></p>

<p>アンカーとなるエッジをバインドさせたい場合は以下のように書く。</p>


<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>START r = relationship(0)
</span><span class='line'>RETURN r</span></code></pre></td></tr></table></div></figure></p>

<p>複数の点から始めるにはこんな感じ。(このやり方が知りたかった)</p>


<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>START a = node(1), b = node(2)
</span><span class='line'>RETURN a,b</span></code></pre></td></tr></table></div></figure></p>

<h2>MATCH</h2>




<p>nodeやエッジにパターンマッチさせるための構文。
STARTなしでもMATCHは使えることはさっき書いたけれど、この場合でのどちらにしろCypherはすべてのノードを探索して始点となるノードを探すことになる。</p>




<p>すべてのノードを得たい場合は簡単。CypherはSTARTを指定しなければすべてのノードを探索するので、条件がなければすべてのノードにマッチする。</p>


<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>MATCH n
</span><span class='line'>RETURN n</span></code></pre></td></tr></table></div></figure></p>

<p>ラベルにマッチさせたいときはコロンで区切る</p>


<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>MATCH n:Actor
</span><span class='line'>RETURN n</span></code></pre></td></tr></table></div></figure></p>

<p>エッジもマッチに含めてよい</p>


<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>MATCH (director)&mdash;&gt;(movie)
</span><span class='line'>WHERE director.name = &ldquo;Oliver Stone&rdquo;
</span><span class='line'>RETURN movie.title</span></code></pre></td></tr></table></div></figure></p>

<p>エッジにラベルをマッチさせてもよい</p>


<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>MATCH (movie)&lt;&ndash;[r:ACTED_IN]&ndash;(actor)
</span><span class='line'>WHERE actor.name = &ldquo;Tom Hanks&rdquo;
</span><span class='line'>RETURN movie.title</span></code></pre></td></tr></table></div></figure></p>

<p>エッジの数でマッチさせることもできる</p>


<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>MATCH (martin)&ndash;[:ACTED_IN*1..2]&ndash;(x)
</span><span class='line'>WHERE martin.name = &ldquo;Martin Sheen&rdquo;
</span><span class='line'>RETURN x</span></code></pre></td></tr></table></div></figure></p>

<h2>WHERE</h2>




<p>MATCHで引っかかったものをfilterにかける処理を行う文</p>


<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>MATCH n
</span><span class='line'>WHERE n.name = &ldquo;Takeshi&rdquo; XOR (n.age &lt; 30 AND n.name = &ldquo;Nobita&rdquo;) OR NOT (n.name = &ldquo;Suneo&rdquo; OR n.name = &ldquo;Dekisugi&rdquo;)
</span><span class='line'>RETURN n</span></code></pre></td></tr></table></div></figure></p>

<p>名前がたけしである場合か、30際以下ののび太である場合かスネオでも出来杉でもない場合のノードが返ってくる
MATCHでラベルを使うこともできたが、WHEREでも可能</p>


<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>MATCH n
</span><span class='line'>WHERE n:Actor
</span><span class='line'>RETURN n</span></code></pre></td></tr></table></div></figure></p>

<p>Actorだけが返ってくる。また正規表現も使える</p>


<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>MATCH n
</span><span class='line'>WHERE n.name =~ &ldquo;T.*&rdquo;
</span><span class='line'>RETURN n</span></code></pre></td></tr></table></div></figure></p>

<p>多分&#8221;Takeshi&#8221;が返ってくる。ある属性があるかないかで取る場合はHASを使う</p>


<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>MATCH n
</span><span class='line'>WHERE HAS(n.belt)
</span><span class='line'>RETURN n</span></code></pre></td></tr></table></div></figure></p>

<p>belt属性があるものが得られる。</p>




<h2>RETURN</h2>




<p>返り値を選択するのがRETURN文だけれどここで数を返した、平均を返したりといったことができる。</p>


<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>MATCH (n)&mdash;&gt;(x)
</span><span class='line'>WHERE n.name = &ldquo;X&rdquo;
</span><span class='line'>RETURN n, count(*)</span></code></pre></td></tr></table></div></figure></p>

<p>MATCHした数が返ってくる。</p>


<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>MATCH (n)&ndash;[r]&ndash;&gt;(x)
</span><span class='line'>WHERE n.name = &ldquo;Nobita&rdquo;
</span><span class='line'>RETURN type&reg;</span></code></pre></td></tr></table></div></figure></p>

<p>エッジのラベルが返ってくる。KNOWSとか。
SQLと同じように他にもSUMとかAVGとか使えるみたい。</p>




<p>大体基本的な構文はわかってきたので、次はGraphGistを使ってもう少し複雑なものを作ってみようかな。</p>


  </p>
  <span class="meta">
    written 








  



<time datetime="2013-09-20T21:33:00+09:00" pubdate data-updated="true">Sep 20<span>th</span>, 2013</time>
    


  </span>

  
</article>

        </div>
      </div>
      
      
      <div class="row">
        <div class="col-md-offset-3 col-md-6">
          <article>
  <h2><a href="/blog/2013/09/18/zhi-shi-biao-xian-falsetamefalsedetagou-zao/">知識表現のためのデータ構造</a></h2>
  
  <p>
    <h2>知識表現</h2>




<blockquote><p>知識表現（ちしきひょうげん）、KR（Knowledge Representation）は、推論を導けるような知識の表現、およびその方法を開発する人工知能研究の領域である。</p><footer><strong>From</strong> <cite><a href='http://ja.wikipedia.org/wiki/%E7%9F%A5%E8%AD%98%E8%A1%A8%E7%8F%BE'>ja.wikipedia.org/wiki/&hellip;</a></cite></footer></blockquote>




<p>人工知能って何って考えたときにぼんやりと、何かの入力に対して何らかの&#8221;知識&#8221;を使って出力を行う機械というふうに考えていた。そもそも漠然とはしている答えではあるものの、じゃあ&#8221;知識&#8221;って何？どうやって得ればいいの？どうやって持っていればいいの？という考えになる。それに答えを与えるのが知識表現(Knowledge Representation)だ。</p>




<p>この知識のデータ構造は推論がしやすい形で持っているのがいい。そしてさらに、表現力がちょうどよい方がいい。なぜなら表現力が高ければ高いほど、記述自体は簡潔になるが、推論に一貫性が持たせられないかもしれない。逆に表現力が低いと非常に煩雑な記述を行わないといけないかもしれない。そのためこのちょうどとい程度の表現力の知識表現は大事だ。</p>




<h3>フレーム構造</h3>




<p>RDBMSみたいなもの。知識を事柄の名称、事柄の属性、属性の値で表現する。RDBMS的にいうとPKとカラム名、カラム値に対応するのかな。</p>




<p><img src="https://raw.github.com/Lewuathe/lewuathe.github.io/source/ownimage/frame.png" alt="フレーム構造" /></p>




<p>ただフレーム構造はその事柄の属性をすべて列挙することが非常にむずかしいことがわかっている(フレーム問題)</p>




<h3>スクリプト構造</h3>




<p>スクリプト構造は手続き的な知識の知識表現に使える。</p>




<p><img src="https://raw.github.com/Lewuathe/lewuathe.github.io/source/ownimage/script.png" alt="スクリプト構造" /></p>




<h3>格文法</h3>




<p>動詞を中心にとらえて、用言的概念と体言的概念に整理する。少しむずかしいが概念を文法として理解しようという試み。情報通信研究機構で開発が続くEDR電子化辞書などの用いられているらしい。</p>




<h3>概念依存理論</h3>




<p>どんな言語にも共通する根源的な意味を抽出して、それらの意味ですべてを表現しようという試み。すべての文章を11の動詞の組み合わせと名詞、修飾概念などを組み合わせて表現。各文法はどちらかというと「関係」に重きをおいた表現方法だが、概念依存理論は「概念」それ自身をを中心に据えている。</p>




<p><img src="https://raw.github.com/Lewuathe/lewuathe.github.io/source/ownimage/gainen.png" alt="概念依存理論" /></p>




<h3>意味ネットワーク</h3>




<p>意味ネットワークは物事をその関係性から評価しようという試み。今まで出てきた属性や、承継関係、動作対象なども「関係」として表すことができるので、すべての知識をノードとエッジで表せる。この方法のよいところは、物事を関係性から理解しようとするので、その物事について関係性が現れるまで評価する必要がないところだと思う。実際人間と同じように考えるのであれば、ある物事を理解しようとするときにそれを直ちに理解しようとするよりは、まず周りとの関係性（それがどのような関係性であれ）から埋めていくことが多い。初対面の人を知ろうとするときに、その人の職業、年齢、性別、住所などから理解しようとすることと同じだ。</p>




<h2>結論</h2>




<p>結論というと言い過ぎかもしれない。僕自身が考えたこととしては知識を表現する上であるオブジェクトの属性や承継関係などをそれぞれ区別して理解しようとするとあまりに煩雑にすぎる気がした。そのためもっと上位のネットワーク構造という形から知識を表現できるようにするといいんじゃないかと思った。実際上記のすべての知識表現はノードとエッジという構造で表現できそうだ。つまり意味ネットワークとしての知識表現をベースにしたものが最も適していると思う。</p>




<p>さて、知識の表現方法は分かった。じゃあこれをどうやってデータとして持てばいいんだろう。ちょうどいいところに最近ではNoSQLの一つとしてグラフ志向データベースというものがあるらしい。これは文字通りデータをノードとエッジの組み合わせで表現する方法。ノード間の関係性などが探索するのに非常に適していいるらしい。最も有名なところではNeo4Jというものがある。</p>




<p><a href="http://www.neo4j.org/">http://www.neo4j.org/</a></p>




<p>なんだかここがGraphGistコンテストみたいなものをやっているっぽいので、勉強がてらやってみようかと。多分次回はNeo4Jに関して書くかも。</p>


  </p>
  <span class="meta">
    written 








  



<time datetime="2013-09-18T21:15:00+09:00" pubdate data-updated="true">Sep 18<span>th</span>, 2013</time>
    


  </span>

  
</article>

        </div>
      </div>
      
      
      <div class="row">
        <div class="col-md-offset-3 col-md-6">
          <article>
  <h2><a href="/blog/2013/09/17/baiasu-bariansufen-jie/">バイアス-バリアンス分解</a></h2>
  
  <p>
    <p>今回はモデルのバイアスとバリアンスを前回までの正則化最小二乗法のモデルを使って計算してみたよ。線形回帰モデルのバイアスとバリアンスはトレードオフの関係にあって、表現力の高いモデルを用いるとバイアスは小さくなるがバリアンスは大きくなってしまう。逆にバリアンスの小さいモデルを用いるとデータによる差が小さくなる代わりに全ての予測値の平均が理想的な回帰関数から離れていってしまう。</p>




<p>20通りの異なる訓練データ集合に対して正則化パラメータを調整して、訓練させてみた。</p>




<h3>λ=1.1の場合</h3>




<p><img src="https://raw.github.com/PhysicsEngine/cpi-stats/master/results/lambda1.1.png" alt="lambda=1.1" /></p>




<p>正則化パラメータが大きい場合は複雑なモデルに対するペナルティが大きくなるので、このようにバリアンスが小さく抑えられる。けれども表現力の豊かなモデルが抑えられるのでそもそも訓練データから理想的な曲線を表現できるほどのモデルになってないことがわかる。ぱっと見、さっきの正則化パラメータが小さい場合よりもずっとsin関数に見えないものができあがってしまった。</p>




<h3>λ= 0.0000001の場合</h3>




<p><img src="https://raw.github.com/PhysicsEngine/cpi-stats/master/results/lambda0.0000000001.png" alt="lambda=0.000000001" /></p>




<p>正則化パラメータが小さい場合、次元数の高いモデルに対するペナルティが低くなるので過学習を起こしやすい。この場合、それぞれの訓練データにひきずられて様々な回帰モデルが構成されてしまった。さっきよりはなんとなくsin関数に見えるけれど、あんまり、ここからどのデータが一番よいのかを決めるのも難しいし、何よりどれもかなり異なっているので全体として理想的な回帰曲線がわからない。</p>




<h3>平均をとってみた</h3>




<p>なんとなくsin関数に見えるということは平均をとると、正しい回帰曲線になるんではないだろうか。ということでバリアンスが高くて訓練データに引きずられてしまっている場合の平均をとってみる</p>




<p><img src="https://raw.github.com/PhysicsEngine/cpi-stats/master/results/ave.png" alt="ave" /></p>




<p>赤い太線が各推定曲線の平均。sin関数に見える！！</p>




<p>このことからバリアンスが大きな表現力の高いモデルの平均はいつもでもないにせよ、有益な推定結果をもたらすこともあるかもしれない。(PRMLの受け売りだけどね)</p>


  </p>
  <span class="meta">
    written 








  



<time datetime="2013-09-17T21:17:00+09:00" pubdate data-updated="true">Sep 17<span>th</span>, 2013</time>
    


  </span>

  
</article>

        </div>
      </div>
      
      
      <div class="row">
        <div class="col-md-offset-3 col-md-6">
          <article>
  <h2><a href="/blog/2013/09/16/scaladerozisuteikusuhui-gui/">Scalaでロジスティクス回帰</a></h2>
  
  <p>
    <p>PRMLをの勉強も兼ねて線形回帰モデルの構築をやってみたよ。
PRML本の内容と<a href="http://aidiary.hatenablog.com/entry/20100404/1270359720">ここ</a>を参考に書いてみたのでぜひ参考に。
リポジトリは<a href="https://github.com/PhysicsEngine/cpi-stats">こちら</a></p>




<h2>最尤推定</h2>




<p>基本的にはsin関数にガウスノイズを足した20個の訓練データからもとのsin関数が復元できるかということをやった。
1次元の多項式フィッティングの場合には最尤推定は最小二乗法でとけばいいだけなのでコードはこんな感じ。</p>


<p><figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'><span class="k">package</span> <span class="nn">com.PhysicsEngine.cpistats</span>
</span><span class='line'><span class="k">import</span> <span class="nn">breeze.linalg.<em></span>
</span><span class='line'>
</span><span class='line'><span class="k">object</span> <span class="nc">LeastSquares</span> <span class="o">{</span>
</span><span class='line'>  <span class="c1">// モデルパラメータの数 あとで正則化項を加えて計算したMAP推定と比較したいので割りとデカイ。over fittingしやすい</span>
</span><span class='line'>  <span class="k">val</span> <span class="n">M</span> <span class="k">=</span> <span class="mi">20</span>
</span><span class='line'>      <span class="k">def</span> <span class="n">estimate</span><span class="o">(</span><span class="n">dataList</span><span class="k">:</span><span class="kt">List</span><span class="o">[</span><span class="kt">Pair</span><span class="o">[</span><span class="kt">Double</span>,<span class="kt">Double</span><span class="o">]],</span> <span class="n">lam</span><span class="k">:</span><span class="kt">Double</span><span class="o">)</span> <span class="k">=</span> <span class="o">{</span>
</span><span class='line'>    <span class="c1">// The model parameter num</span>
</span><span class='line'>    <span class="k">val</span> <span class="n">dataLength</span> <span class="k">=</span> <span class="n">dataList</span><span class="o">.</span><span class="n">length</span>
</span><span class='line'>    <span class="c1">// AはM+1個の微分方程式の係数行列</span>
</span><span class='line'>    <span class="k">var</span> <span class="n">A</span> <span class="k">=</span> <span class="nc">DenseMatrix</span><span class="o">.</span><span class="n">zeros</span><span class="o">[</span><span class="kt">Double</span><span class="o">](</span><span class="n">M</span><span class="o">+</span><span class="mi">1</span><span class="o">,</span> <span class="n">M</span><span class="o">+</span><span class="mi">1</span><span class="o">)</span>
</span><span class='line'>    <span class="c1">// Tは目標値との掛け算</span>
</span><span class='line'>    <span class="c1">// 詳しくはPRMLの演習問題(1.1)を読んだ方がいいかも</span>
</span><span class='line'>    <span class="c1">// 要は微分して0とおいたときの連立方程式を解くための行列とベクトル</span>
</span><span class='line'>    <span class="k">var</span> <span class="n">T</span> <span class="k">=</span> <span class="nc">DenseVector</span><span class="o">.</span><span class="n">zeros</span><span class="o">[</span><span class="kt">Double</span><span class="o">](</span><span class="n">M</span><span class="o">+</span><span class="mi">1</span><span class="o">)</span>
</span><span class='line'><br/>
</span><span class='line'>    <span class="k">for</span><span class="o">(</span><span class="n">i</span> <span class="k">&lt;&ndash;</span> <span class="mi">0</span> <span class="n">to</span> <span class="n">M</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>      <span class="k">for</span><span class="o">(</span> <span class="n">j</span> <span class="k">&lt;&ndash;</span> <span class="mi">0</span> <span class="n">to</span> <span class="n">M</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>        <span class="k">var</span> <span class="n">temp</span> <span class="k">=</span> <span class="mf">0.0</span>
</span><span class='line'>        <span class="n">dataList</span><span class="o">.</span><span class="n">foreach</span> <span class="o">{</span>
</span><span class='line'>          <span class="n">dataPair</span> <span class="k">=&gt;</span> <span class="o">{</span>
</span><span class='line'>            <span class="n">temp</span> <span class="o">+=</span> <span class="nc">Math</span><span class="o">.</span><span class="n">pow</span><span class="o">(</span><span class="n">dataPair</span><span class="o">.</span><span class="n"></em>1</span><span class="o">,</span> <span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="o">)</span>
</span><span class='line'>          <span class="o">}</span>
</span><span class='line'>        <span class="o">}</span>
</span><span class='line'>        <span class="n">A</span><span class="o">(</span><span class="n">i</span><span class="o">,</span> <span class="n">j</span><span class="o">)</span> <span class="k">=</span> <span class="n">temp</span>
</span><span class='line'>      <span class="o">}</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>    <span class="c1">//print(A)</span>
</span><span class='line'><br/>
</span><span class='line'>    <span class="k">for</span><span class="o">(</span><span class="n">i</span> <span class="k">&lt;&ndash;</span> <span class="mi">0</span> <span class="n">to</span> <span class="n">M</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>        <span class="k">var</span> <span class="n">temp</span> <span class="k">=</span> <span class="mf">0.0</span>
</span><span class='line'>        <span class="n">dataList</span><span class="o">.</span><span class="n">foreach</span> <span class="o">{</span>
</span><span class='line'>          <span class="n">dataPair</span> <span class="k">=&gt;</span> <span class="o">{</span>
</span><span class='line'>              <span class="n">temp</span> <span class="o">+=</span> <span class="nc">Math</span><span class="o">.</span><span class="n">pow</span><span class="o">(</span><span class="n">dataPair</span><span class="o">.</span><span class="n"><em>1</span><span class="o">,</span> <span class="n">i</span><span class="o">)</span> <span class="o">*</span> <span class="n">dataPair</span><span class="o">.</span><span class="n"></em>2</span>
</span><span class='line'>          <span class="o">}</span>
</span><span class='line'>        <span class="o">}</span>
</span><span class='line'>        <span class="n">T</span><span class="o">(</span><span class="n">i</span><span class="o">)</span> <span class="k">=</span> <span class="n">temp</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>    <span class="c1">//print(T)</span>
</span><span class='line'><br/>
</span><span class='line'>    <span class="k">val</span> <span class="n">wlist</span> <span class="k">=</span> <span class="n">A</span> <span class="o">&lt;/span> <span class="n">T</span>
</span><span class='line'>    <span class="c1">// この連立方程式をとくとパラメータベクトルが得られる</span>
</span><span class='line'>    <span class="n">wlist</span>
</span><span class='line'>  <span class="o">}</span>
</span><span class='line'><br/>
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>これで解いた場合の回帰曲線がこれ
<img src="https://raw.github.com/PhysicsEngine/cpi-stats/master/results/LeastSquares_lambda.png" alt="LeastSquares_lambda" /></p>




<p>狙いどおり過学習しております。</p>




<h3>MAP推定</h3>




<p>過学習をふせぐために大きすぎるパラメータにペナルティを与える方法がある。これは正則化項とよばれる項を加えた上での誤差関数を最小化する方法。これはモデルパラメータの事後分布を最大化するようなものを選ぶ方法と同じ。だからMAP推定(Most a posterio)と呼ばれる。やりかたは簡単。さっきの行列Aの対角成分に正則化パラメータを加えればよい。</p>


<p><figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'><span class="c1">// これを A(i, j) = tempの前に書く</span>
</span><span class='line'><span class="c1">// lam = 0.00001くらいでいい</span>
</span><span class='line'><span class="k">if</span> <span class="o">(</span><span class="n">i</span> <span class="o">==</span> <span class="n">j</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>  <span class="n">temp</span> <span class="o">+=</span> <span class="n">lam</span>
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>結果は以下。</p>




<p><img src="https://raw.github.com/PhysicsEngine/cpi-stats/master/results/LeastSquares.png" alt="LeastSquares" /></p>




<p>正則化項の値はかなり小さいはずなのに結構効果がある。すごい。ただずれているところはかなりずれているようにも見える。</p>




<h2>ベイズ推定</h2>




<p>というわけでベイズ推定。上の２つは両方ともパラメータwを点推定で決めてしまう決定論的な手法であるのに対してベイズ推定はパラメータ事後分布から予測分布を求めることまでを行う。簡単にいうと各xの値に対してパラメータwはひとつには決めずにある分布に従う確率変数として扱い、目標値に対しても幅を持たせることになる。今回は各訓練データはガウス分布にしたがうノイズがのっているという仮定にもとづいて推定を行う。</p>


<p><figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'><span class="k">package</span> <span class="nn">com.PhysicsEngine.cpistats</span>
</span><span class='line'><span class="k">import</span> <span class="nn">breeze.linalg.<em></span>
</span><span class='line'>
</span><span class='line'><span class="k">object</span> <span class="nc">BayesEstimation</span> <span class="o">{</span>
</span><span class='line'>    <span class="c1">// モデルパラメータの数</span>
</span><span class='line'>  <span class="k">val</span> <span class="n">M</span> <span class="k">=</span> <span class="mi">20</span>
</span><span class='line'>  <span class="c1">// BETAとALPHAは事後分布の超パラメータ</span>
</span><span class='line'>  <span class="k">val</span> <span class="nc">BETA</span> <span class="k">=</span> <span class="mf">11.1</span>
</span><span class='line'>  <span class="k">val</span> <span class="nc">ALPHA</span> <span class="k">=</span> <span class="mf">0.005</span>
</span><span class='line'><br/>
</span><span class='line'>  <span class="c1">// 基底関数。今回は多項式関数をつかっている</span>
</span><span class='line'>  <span class="k">def</span> <span class="n">phi</span><span class="o">(</span><span class="n">x</span><span class="k">:</span><span class="kt">Double</span><span class="o">)</span> <span class="k">=</span> <span class="o">{</span>
</span><span class='line'>    <span class="k">var</span> <span class="n">T</span> <span class="k">=</span> <span class="nc">DenseVector</span><span class="o">.</span><span class="n">zeros</span><span class="o">[</span><span class="kt">Double</span><span class="o">](</span><span class="n">M</span><span class="o">+</span><span class="mi">1</span><span class="o">)</span>
</span><span class='line'>    <span class="k">for</span><span class="o">(</span><span class="n">i</span> <span class="k">&lt;&ndash;</span> <span class="mi">0</span> <span class="n">to</span> <span class="n">M</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>      <span class="n">T</span><span class="o">(</span><span class="n">i</span><span class="o">)</span> <span class="k">=</span> <span class="nc">Math</span><span class="o">.</span><span class="n">pow</span><span class="o">(</span><span class="n">x</span><span class="o">,</span> <span class="n">i</span><span class="o">)</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>    <span class="n">T</span>
</span><span class='line'>  <span class="o">}</span>
</span><span class='line'><br/>
</span><span class='line'>  <span class="c1">// 平均値を求める</span>
</span><span class='line'>  <span class="c1">// PRML(1.70)</span>
</span><span class='line'>  <span class="k">def</span> <span class="n">mean</span><span class="o">(</span><span class="n">x</span><span class="k">:</span><span class="kt">Double</span><span class="o">,</span> <span class="n">dataList</span><span class="k">:</span><span class="kt">List</span><span class="o">[</span><span class="kt">Pair</span><span class="o">[</span><span class="kt">Double</span>, <span class="kt">Double</span><span class="o">]],</span> <span class="n">S</span><span class="k">:</span><span class="kt">DenseMatrix</span><span class="o">[</span><span class="kt">Double</span><span class="o">])</span> <span class="k">=</span> <span class="o">{</span>
</span><span class='line'>    <span class="k">val</span> <span class="n">sums</span> <span class="k">=</span> <span class="nc">DenseVector</span><span class="o">.</span><span class="n">zeros</span><span class="o">[</span><span class="kt">Double</span><span class="o">](</span><span class="n">M</span><span class="o">+</span><span class="mi">1</span><span class="o">)</span>
</span><span class='line'>    <span class="k">for</span><span class="o">(</span><span class="n">i</span> <span class="k">&lt;&ndash;</span> <span class="mi">0</span> <span class="n">to</span> <span class="n">dataList</span><span class="o">.</span><span class="n">length</span><span class="o">&ndash;</span><span class="mi">1</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>      <span class="n">sums</span> <span class="o">+=</span> <span class="n">phi</span><span class="o">(</span><span class="n">dataList</span><span class="o">(</span><span class="n">i</span><span class="o">).</span><span class="n"></em>1</span><span class="o">)</span> <span class="o">:<em></span> <span class="n">dataList</span><span class="o">(</span><span class="n">i</span><span class="o">).</span><span class="n">_2</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>    <span class="nc">BETA</span> <span class="o"></em></span> <span class="n">phi</span><span class="o">(</span><span class="n">x</span><span class="o">).</span><span class="n">t</span> <span class="o"><em></span> <span class="n">S</span> <span class="o"></em></span> <span class="n">sums</span>
</span><span class='line'>  <span class="o">}</span>
</span><span class='line'><br/>
</span><span class='line'>  <span class="c1">// 各平均値からの精度</span>
</span><span class='line'>  <span class="c1">// PRML(1.71)  def variance(x:Double, dataList:List[Pair[Double, Double]], S:DenseMatrix[Double]) = {</span>
</span><span class='line'>    <span class="n">phi</span><span class="o">(</span><span class="n">x</span><span class="o">).</span><span class="n">t</span> <span class="o"><em></span> <span class="n">S</span> <span class="o"></em></span> <span class="n">phi</span><span class="o">(</span><span class="n">x</span><span class="o">)</span> <span class="o">+</span> <span class="o">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="nc">BETA</span><span class="o">)</span>
</span><span class='line'>  <span class="o">}</span>
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>これで推定した結果がこちら。</p>




<p><img src="https://raw.github.com/PhysicsEngine/cpi-stats/master/results/BayesEstimation.png" alt="BayesEstimation" /></p>




<p>緑実線が平均値の推定結果で、赤点線がそれぞれ平均値から1σ分だけ離れた曲線を表す。大体あてはまっていることがわかる。もっとパラメータの数を多くすると無理やり、範囲内に訓練データが入るような分布が得られた。
もう少し汎用的なものを作っていこうかなと思っています。</p>


  </p>
  <span class="meta">
    written 








  



<time datetime="2013-09-16T20:37:00+09:00" pubdate data-updated="true">Sep 16<span>th</span>, 2013</time>
    


  </span>

  
</article>

        </div>
      </div>
      
      
      <div class="row">
        <div class="col-md-offset-3 col-md-6">
          <article>
  <h2><a href="/blog/2013/09/14/scalanlpfalsetiyutoriaru/">ScalaNLPのチュートリアル</a></h2>
  
  <p>
    <p>ScalaNLPを触ってみたので、その時のチュートリアル。
ScalaNLPは基本的にはSBTの依存解決でライブラリをダウンロードできるのでそのとおりに行う。
build.sbtファイルに以下のように書いてupdateを行う</p>


<p><figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'><span class="n">libraryDependencies</span>  <span class="o">++=</span> <span class="nc">Seq</span><span class="o">(</span>
</span><span class='line'>            <span class="c1">// other dependencies here</span>
</span><span class='line'>            <span class="c1">// pick and choose:</span>
</span><span class='line'>            <span class="s">&quot;org.scalanlp&quot;</span> <span class="o">%</span> <span class="s">&quot;breeze-math_2.10&quot;</span> <span class="o">%</span> <span class="s">&quot;0.4&quot;</span><span class="o">,</span>
</span><span class='line'>            <span class="s">&quot;org.scalanlp&quot;</span> <span class="o">%</span> <span class="s">&quot;breeze-learn_2.10&quot;</span> <span class="o">%</span> <span class="s">&quot;0.4&quot;</span><span class="o">,</span>
</span><span class='line'>            <span class="s">&quot;org.scalanlp&quot;</span> <span class="o">%</span> <span class="s">&quot;breeze-process_2.10&quot;</span> <span class="o">%</span> <span class="s">&quot;0.4&quot;</span><span class="o">,</span>
</span><span class='line'>            <span class="s">&quot;org.scalanlp&quot;</span> <span class="o">%</span> <span class="s">&quot;breeze-viz_2.10&quot;</span> <span class="o">%</span> <span class="s">&quot;0.4&quot;</span>
</span><span class='line'><span class="o">)</span>
</span><span class='line'>
</span><span class='line'><span class="n">resolvers</span> <span class="o">++=</span> <span class="nc">Seq</span><span class="o">(</span>
</span><span class='line'>            <span class="c1">// other resolvers here</span>
</span><span class='line'>            <span class="c1">// if you want to use snapshot builds (currently 0.5-SNAPSHOT), use this.</span>
</span><span class='line'>            <span class="s">&quot;Sonatype Snapshots&quot;</span> <span class="n">at</span> <span class="s">&quot;<a href="https://oss.sonatype.org/content/repositories/snapshots/&amp;quot;">https://oss.sonatype.org/content/repositories/snapshots/&amp;quot;</a></span><span class="o">,</span>
</span><span class='line'>            <span class="s">&quot;Sonatype Snapshots&quot;</span> <span class="n">at</span> <span class="s">&quot;<a href="https://oss.sonatype.org/content/repositories/releases/&amp;quot;">https://oss.sonatype.org/content/repositories/releases/&amp;quot;</a></span>
</span><span class='line'><span class="o">)</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// Scala 2.9.2 is still supported for 0.2.1, but is dropped afterwards.</span>
</span><span class='line'><span class="n">scalaVersion</span> <span class="o">:=</span> <span class="s">&quot;2.10.2&quot;</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>でも以下のようなエラーが出てくる。0.4がないとかいうエラーが出てくる。ないらしいのでバージョンを下げてみる。</p>


<p><figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'><span class="n">libraryDependencies</span>  <span class="o">++=</span> <span class="nc">Seq</span><span class="o">(</span>
</span><span class='line'>            <span class="c1">// other dependencies here</span>
</span><span class='line'>            <span class="c1">// pick and choose:</span>
</span><span class='line'>            <span class="s">&quot;org.scalanlp&quot;</span> <span class="o">%</span> <span class="s">&quot;breeze-math_2.10&quot;</span> <span class="o">%</span> <span class="s">&quot;0.3&quot;</span><span class="o">,</span>
</span><span class='line'>            <span class="s">&quot;org.scalanlp&quot;</span> <span class="o">%</span> <span class="s">&quot;breeze-learn_2.10&quot;</span> <span class="o">%</span> <span class="s">&quot;0.3&quot;</span><span class="o">,</span>
</span><span class='line'>            <span class="s">&quot;org.scalanlp&quot;</span> <span class="o">%</span> <span class="s">&quot;breeze-process_2.10&quot;</span> <span class="o">%</span> <span class="s">&quot;0.3&quot;</span><span class="o">,</span>
</span><span class='line'>            <span class="s">&quot;org.scalanlp&quot;</span> <span class="o">%</span> <span class="s">&quot;breeze-viz_2.10&quot;</span> <span class="o">%</span> <span class="s">&quot;0.3&quot;</span>
</span><span class='line'><span class="o">)</span>
</span><span class='line'>
</span><span class='line'><span class="n">resolvers</span> <span class="o">++=</span> <span class="nc">Seq</span><span class="o">(</span>
</span><span class='line'>            <span class="c1">// other resolvers here</span>
</span><span class='line'>            <span class="c1">// if you want to use snapshot builds (currently 0.5-SNAPSHOT), use this.</span>
</span><span class='line'>            <span class="s">&quot;Sonatype Snapshots&quot;</span> <span class="n">at</span> <span class="s">&quot;<a href="https://oss.sonatype.org/content/repositories/snapshots/&amp;quot;">https://oss.sonatype.org/content/repositories/snapshots/&amp;quot;</a></span><span class="o">,</span>
</span><span class='line'>            <span class="s">&quot;Sonatype Snapshots&quot;</span> <span class="n">at</span> <span class="s">&quot;<a href="https://oss.sonatype.org/content/repositories/releases/&amp;quot;">https://oss.sonatype.org/content/repositories/releases/&amp;quot;</a></span>
</span><span class='line'><span class="o">)</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// Scala 2.9.2 is still supported for 0.2.1, but is dropped afterwards.</span>
</span><span class='line'><span class="n">scalaVersion</span> <span class="o">:=</span> <span class="s">&quot;2.10.2&quot;</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>入ったみたい。</p>


<p><figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'><span class="n">$</span> <span class="n">sbt</span>
</span><span class='line'><span class="o">&gt;</span> <span class="n">console</span>
</span><span class='line'><span class="o">[</span><span class="kt">warn</span><span class="o">]</span> <span class="nc">Multiple</span> <span class="n">resolvers</span> <span class="n">having</span> <span class="n">different</span> <span class="n">access</span> <span class="n">mechanism</span> <span class="n">configured</span> <span class="k">with</span> <span class="n">same</span> <span class="n">name</span> <span class="-Symbol">&#39;Sonatype</span> <span class="nc">Snapshots</span><span class="err">&#39;</span><span class="o">.</span> <span class="nc">To</span> <span class="n">avoid</span> <span class="n">conflict</span><span class="o">,</span> <span class="nc">Remove</span> <span class="n">duplicate</span> <span class="n">project</span> <span class="n">resolvers</span> <span class="o">(</span><span class="n"><code>resolvers</code></span><span class="o">)</span> <span class="n">or</span> <span class="n">rename</span> <span class="n">publishing</span> <span class="n">resolver</span> <span class="o">(</span><span class="n"><code>publishTo</code></span><span class="o">).</span>
</span><span class='line'><span class="o">[</span><span class="kt">info</span><span class="o">]</span> <span class="nc">Compiling</span> <span class="mi">1</span> <span class="nc">Scala</span> <span class="n">source</span> <span class="n">to</span> <span class="o">/</span><span class="nc">Users</span><span class="o">/</span><span class="n">sasakiumi</span><span class="o">/</span><span class="nc">MyWorks</span><span class="o">/</span><span class="n">scalanlp</span><span class="o">&ndash;</span><span class="n">tutorial</span><span class="o">/</span><span class="n">target</span><span class="o">/</span><span class="n">scala</span><span class="o">&ndash;</span><span class="mf">2.10</span><span class="o">/</span><span class="n">classes</span><span class="o">&hellip;</span>
</span><span class='line'><span class="o">[</span><span class="kt">info</span><span class="o">]</span> <span class="-Symbol">&#39;compiler</span><span class="o">&ndash;</span><span class="n">interface</span><span class="err">&#39;</span> <span class="n">not</span> <span class="n">yet</span> <span class="n">compiled</span> <span class="k">for</span> <span class="nc">Scala</span> <span class="mf">2.10</span><span class="o">.</span><span class="mf">2.</span> <span class="nc">Compiling</span><span class="o">&hellip;</span>
</span><span class='line'><span class="o">[</span><span class="kt">info</span><span class="o">]</span>   <span class="nc">Compilation</span> <span class="n">completed</span> <span class="n">in</span> <span class="mf">20.07</span> <span class="n">s</span>
</span><span class='line'><span class="o">[</span><span class="kt">info</span><span class="o">]</span> <span class="nc">Starting</span> <span class="n">scala</span> <span class="n">interpreter</span><span class="o">&hellip;</span>
</span><span class='line'><span class="o">[</span><span class="kt">info</span><span class="o">]</span>
</span><span class='line'><span class="nc">Welcome</span> <span class="n">to</span> <span class="nc">Scala</span> <span class="n">version</span> <span class="mf">2.10</span><span class="o">.</span><span class="mi">2</span> <span class="o">(</span><span class="nc">Java</span> <span class="nc">HotSpot</span><span class="o">(</span><span class="nc">TM</span><span class="o">)</span> <span class="mi">64</span><span class="o">&ndash;</span><span class="nc">Bit</span> <span class="nc">Server</span> <span class="nc">VM</span><span class="o">,</span> <span class="nc">Java</span> <span class="mf">1.6</span><span class="o">.</span><span class="mi">0</span><span class="n"><em>51</span><span class="o">).</span>
</span><span class='line'><span class="nc">Type</span> <span class="n">in</span> <span class="n">expressions</span> <span class="n">to</span> <span class="n">have</span> <span class="n">them</span> <span class="n">evaluated</span><span class="o">.</span>
</span><span class='line'><span class="nc">Type</span> <span class="k">:</span><span class="kt">help</span> <span class="kt">for</span> <span class="kt">more</span> <span class="kt">information.</span>
</span><span class='line'>
</span><span class='line'><span class="kt">scala&gt;</span> <span class="kt">import</span> <span class="kt">breeze.linalg.</em></span>
</span><span class='line'><span class="k">import</span> <span class="nn">breeze.linalg._</span>
</span></code></pre></td></tr></table></div></figure></p>

<p><a href="http://krrrr.hatenablog.com/entry/20130614/1371221935">ここ</a>を参考に基本的な演算の書き方を見てみる。</p>


<p><figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'><span class="k">package</span> <span class="nn">com.github.PhysicsEngine.scalanlptutorial</span>
</span><span class='line'><span class="k">import</span> <span class="nn">breeze.linalg.<em></span>
</span><span class='line'><span class="k">import</span> <span class="nn">breeze.numerics.</em></span>
</span><span class='line'>
</span><span class='line'><span class="k">object</span> <span class="nc">App</span> <span class="o">{</span>
</span><span class='line'>  <span class="k">def</span> <span class="n">main</span><span class="o">(</span><span class="n">args</span><span class="k">:</span> <span class="kt">Array</span><span class="o">[</span><span class="kt">String</span><span class="o">])</span> <span class="o">{</span>
</span><span class='line'>    <span class="c1">// 4<em>4 matrix</span>
</span><span class='line'>    <span class="k">val</span> <span class="n">T</span> <span class="k">=</span> <span class="nc">DenseMatrix</span><span class="o">((.</span><span class="mi">0</span><span class="o">,</span> <span class="o">.</span><span class="mi">0</span><span class="o">,</span> <span class="o">.</span><span class="mi">0</span><span class="o">,</span> <span class="o">.</span><span class="mi">0</span><span class="o">),</span> <span class="o">(</span><span class="mf">1.0</span><span class="o">,</span> <span class="o">.</span><span class="mi">0</span><span class="o">,</span> <span class="o">.</span><span class="mi">5</span><span class="o">,</span> <span class="o">.</span><span class="mi">0</span><span class="o">),</span> <span class="o">(.</span><span class="mi">0</span><span class="o">,</span> <span class="mf">1.0</span><span class="o">,</span> <span class="o">.</span><span class="mi">0</span><span class="o">,</span> <span class="o">.</span><span class="mi">0</span><span class="o">),</span> <span class="o">(.</span><span class="mi">0</span><span class="o">,</span> <span class="o">.</span><span class="mi">0</span><span class="o">,</span> <span class="o">.</span><span class="mi">5</span><span class="o">,</span> <span class="o">.</span><span class="mi">0</span><span class="o">))</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">val</span> <span class="n">d</span> <span class="k">=</span> <span class="mf">0.85</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">// Row number of T matrix</span>
</span><span class='line'>    <span class="k">val</span> <span class="n">N</span> <span class="k">=</span> <span class="n">T</span><span class="o">.</span><span class="n">rows</span>
</span><span class='line'>    <span class="c1">// Transposed matrix of [1/N, 1/N, 1/N, 1/N, 1/N] </span>
</span><span class='line'>    <span class="k">var</span> <span class="n">r</span> <span class="k">=</span> <span class="nc">DenseMatrix</span><span class="o">(</span><span class="nc">Array</span><span class="o">.</span><span class="n">fill</span><span class="o">(</span><span class="n">N</span><span class="o">)(</span><span class="mf">1.0</span><span class="o">/</span><span class="n">N</span><span class="o">)).</span><span class="n">t</span>
</span><span class='line'>        <br/>
</span><span class='line'>    <span class="k">val</span> <span class="n">u</span> <span class="k">=</span> <span class="n">r</span><span class="o">.</span><span class="n">copy</span>
</span><span class='line'>            <br/>
</span><span class='line'>    <span class="k">val</span> <span class="n">m</span> <span class="k">=</span> <span class="mi">20</span>
</span><span class='line'>                    <br/>
</span><span class='line'>    <span class="k">for</span><span class="o">(</span><span class="n">i</span> <span class="k">&lt;&ndash;</span> <span class="mi">1</span> <span class="n">to</span> <span class="n">m</span><span class="o">){</span>
</span><span class='line'>    <span class="n">r</span> <span class="k">=</span> <span class="n">d</span><span class="o"></em></span><span class="n">T</span><span class="o"><em></span><span class="n">r</span> <span class="o">+</span> <span class="o">(</span><span class="mi">1</span><span class="o">&ndash;</span><span class="n">d</span><span class="o">)</em></span><span class="n">u</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>                    <br/>
</span><span class='line'>    <span class="n">print</span><span class="o">(</span><span class="n">r</span><span class="o">)</span>
</span><span class='line'>  <span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure></p>

<h4>縦ベクトル</h4>


<p><figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'><span class="k">val</span> <span class="n">x</span> <span class="k">=</span> <span class="nc">DenseVector</span><span class="o">[</span><span class="kt">Double</span><span class="o">](</span><span class="mi">1</span><span class="o">,</span><span class="mi">2</span><span class="o">,</span><span class="mi">3</span><span class="o">,</span><span class="mi">4</span><span class="o">,</span><span class="mi">5</span><span class="o">)</span>
</span></code></pre></td></tr></table></div></figure></p>

<h4>横ベクトル</h4>


<p><figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'><span class="k">val</span> <span class="n">x</span> <span class="k">=</span> <span class="nc">DenseVector</span><span class="o">[</span><span class="kt">Double</span><span class="o">](</span><span class="mi">1</span><span class="o">,</span><span class="mi">2</span><span class="o">,</span><span class="mi">3</span><span class="o">,</span><span class="mi">4</span><span class="o">).</span><span class="n">t</span>
</span></code></pre></td></tr></table></div></figure></p>

<h4>N＊N行列</h4>


<p><figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'><span class="k">val</span> <span class="n">x</span> <span class="k">=</span> <span class="nc">DenseMatrix</span><span class="o">((</span><span class="mf">1.0</span><span class="o">,</span><span class="mf">2.0</span><span class="o">,</span><span class="mf">3.0</span><span class="o">),</span> <span class="o">(</span><span class="mf">4.0</span><span class="o">,</span><span class="mf">5.0</span><span class="o">,</span><span class="mf">6.0</span><span class="o">),</span> <span class="o">(</span><span class="mf">7.0</span><span class="o">,</span><span class="mf">8.0</span><span class="o">,</span><span class="mf">9.0</span><span class="o">))</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>行数と列数は</p>


<p><figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'><span class="o">(</span><span class="n">x</span><span class="o">.</span><span class="n">rows</span><span class="o">,</span> <span class="n">x</span><span class="o">.</span><span class="n">cols</span><span class="o">)</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>行の取得、列の取得には<code>::</code>を使う</p>


<p><figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'><span class="n">x</span><span class="o">(::,</span><span class="mi">2</span><span class="o">)</span> <span class="c1">// 2列目</span>
</span><span class='line'><span class="n">x</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="o">::)</span> <span class="c1">// 1行目</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>部分取得したい場合には<code>to</code>を使う</p>


<p><figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'><span class="n">x</span><span class="o">(</span><span class="mi">0</span> <span class="n">to</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">1</span> <span class="n">to</span> <span class="mi">2</span><span class="o">)</span> <span class="c1">//0行から1行、1列から2列で囲まれた部分を返す</span>
</span></code></pre></td></tr></table></div></figure></p>

<h4>行列に定義された四則演算</h4>


<p><figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'><span class="n">x</span> <span class="o">+</span> <span class="n">y</span>
</span><span class='line'><span class="n">x</span> <span class="o">*</span> <span class="n">y</span>
</span><span class='line'><span class="n">x</span> <span class="o">&ndash;</span> <span class="n">y</span>
</span></code></pre></td></tr></table></div></figure></p>

<h4>要素ごとの四則演算</h4>


<p><figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'><span class="n">x</span> <span class="o">:+</span> <span class="mf">1.0</span>  <span class="c1">// 全要素に1.0を加える</span>
</span><span class='line'><span class="n">x</span> <span class="o">:*</span> <span class="mf">2.0</span>  <span class="c1">// 全要素に2.0をかける</span>
</span><span class='line'><span class="n">x</span> <span class="o">:&ndash;</span> <span class="mf">3.0</span>  <span class="c1">// 全要素から3.0を引く</span>
</span></code></pre></td></tr></table></div></figure></p>

<h4>内積</h4>


<p><figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'><span class="n">x</span> <span class="n">dot</span> <span class="n">y</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>そのほかの使い勝手の良さそうなドキュメントは<a href="https://github.com/scalanlp/breeze/wiki/Breeze-Linear-Algebra">ここ</a></p>


  </p>
  <span class="meta">
    written 








  



<time datetime="2013-09-14T16:25:00+09:00" pubdate data-updated="true">Sep 14<span>th</span>, 2013</time>
    


  </span>

  
</article>

        </div>
      </div>
      
      
      <div class="row">
        <div class="col-md-offset-3 col-md-6">
          <article>
  <h2><a href="/blog/2013/09/13/sbttoeclipsedescalakai-fa-huan-jing/">SBTとEclipseでScala開発環境</a></h2>
  
  <p>
    <p>SBTの使い方がなんとなくわかってきたので、今度はEclipseにSBTプロジェクトを導入してみる。</p>




<h3>Eclipse plubin for SBTのinstall</h3>




<p>プロジェクトに必要なプラグインをインストールする。この場合は<code>project/plubins.sbt</code>に以下のように記述する。</p>


<p><figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'><span class="n">resolvers</span> <span class="o">+=</span> <span class="nc">Classpaths</span><span class="o">.</span><span class="n">typesafeResolver</span>
</span><span class='line'>
</span><span class='line'><span class="n">addSbtPlugin</span><span class="o">(</span><span class="s">&quot;com.typesafe.sbteclipse&quot;</span> <span class="o">%</span> <span class="s">&quot;sbteclipse-plugin&quot;</span> <span class="o">%</span> <span class="s">&quot;2.1.2&quot;</span><span class="o">)</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>ここで以下のコマンドを打てばこのプラグインがインストールされ、Eclipseプロジェクトに必要な.projectファイルができあがる</p>


<p><figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'><span class="n">$</span> <span class="n">sbt</span> <span class="n">eclipse</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>これをImportすればいい。Importの方法は</p>


<p><figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'><span class="nc">File</span> <span class="o">&ndash;&gt;</span> <span class="nc">Import</span> <span class="o">&ndash;&gt;</span> <span class="nc">General</span> <span class="o">&ndash;&gt;</span> <span class="nc">Existing</span> <span class="nc">Projects</span> <span class="n">into</span> <span class="nc">Workspace</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>でできる。</p>




<p>あともっと便利にSBTを使いたければ<a href="http://d.hatena.ne.jp/qtamaki/20121210/1355167655">ここ</a>に書いてある通りにやるとテンプレート展開のためのライブラリとかも入れられる。(g8っつうらしい)</p>




<p>でもどうやら実行とかテストはSBT上でやった方がいいみたい。Eclipseは純粋なエディタとして使う人が多いっぽい。
確かにJavaのプロジェクトと認識されてしまってうまくコンパイルできないや。</p>


  </p>
  <span class="meta">
    written 








  



<time datetime="2013-09-13T22:17:00+09:00" pubdate data-updated="true">Sep 13<span>th</span>, 2013</time>
    


  </span>

  
</article>

        </div>
      </div>
      
      
      <div class="row">
        <div class="col-md-offset-3 col-md-6">
          <article>
  <h2><a href="/blog/2013/09/10/sbtwoshi-tutapuroziekutozuo-cheng-2/">SBTを使ったプロジェクト作成(2)</a></h2>
  
  <p>
    <h3>スコープに関するお話</h3>




<p>昨日の続き。
実はSettingKeyにはスコープがあり、異なるプロジェクトではことなる値を使うことができる。そもそも同じ場所に置くなよという気はするがテスト用とかリリース用にビルドしたい場合に便利。このビルドの設定を分けるスコープの&#8221;軸&#8221;がSBTには３つある。</p>




<ul>
<li>プロジェクト</li>
<li>コンフィギュレーション</li>
<li>タスク</li>
</ul>




<h4>プロジェクト軸によるスコープ</h4>




<p>それぞれのプロジェクトに対して設定が必要という場合がこのケース。ビルド全体（全プロジェクト）でもよい。</p>




<h4>コンフィギュレーション軸によるスコープ</h4>




<p>ビルドの種類によるわけかた。テストとかリリース用とか、デバッグ用とか。</p>




<h4>タスク軸によるスコープ</h4>




<p>少しよくわからないけれど、他のタスクに影響を受けるようなスコープのことらしい。</p>




<p>スコープは<code>inspect</code>コマンドで調べられるらしい。</p>


<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ sbt
</span><span class='line'>&gt; inspect name
</span><span class='line'>[info] Setting: java.lang.String = hello
</span><span class='line'>[info] Description:
</span><span class='line'>[info]  Project name.
</span><span class='line'>[info] Provided by:
</span><span class='line'>[info]  {file:/Users/sasakiumi/MyWorks/hello/}default-6cbc7c/<em>:name
</span><span class='line'>[info] Defined at:
</span><span class='line'>[info]  /Users/sasakiumi/MyWorks/hello/build.sbt:1
</span><span class='line'>[info] Reverse dependencies:
</span><span class='line'>[info]  </em>:normalized-name
</span><span class='line'>[info]  <em>:project-info
</span><span class='line'>[info]  </em>:organization
</span><span class='line'>[info]  <em>:description
</span><span class='line'>[info]  </em>:on-load-message
</span><span class='line'>[info] Delegates:
</span><span class='line'>[info]  <em>:name
</span><span class='line'>[info]  {.}/</em>:name
</span><span class='line'>[info]  <em>/</em>:name
</span><span class='line'>&gt;</span></code></pre></td></tr></table></div></figure></p>

<p><code>Provided by</code>で書かれた部分を見ると</p>




<ul>
<li>{file:/Users/sasakiumi/MyWorks/hello/}default-6cbc7c/ → プロジェクト</li>
<li>アスタリスク → コンフィギュレーション</li>
<li>→なし</li>
</ul>




<p>ということらしい。</p>




<h3>ライブラリ依存性</h3>




<p>SBTはプロジェクトが必要なライブラリとかパッケージを管理してくれる。この依存ライブラリの管理には２つのタイプがある。</p>




<h4>アンマネージ依存性</h4>




<p>libディレクトリに直にjarファイルを入れるタイプ。特に管理とかされているわけではなく自分でダウンロードして、設置する必要があるのでアンマネージ。lib以下に入れるとプロジェクトのクラスパスに追加される。それだけだ！</p>




<h4>マネージ依存性</h4>




<p><strong>Apache Ivy</strong>を使ってライブラリの依存解決を行う。これを使うためには<code>libraryDependencies</code>キーに値を入れるだけでうまくいく。グループ、ライブラリ名、バージョンの順番だ。</p>


<p><figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'><span class="n">libraryDependencies</span> <span class="o">+=</span> <span class="s">&quot;org.apache.derby&quot;</span> <span class="o">%</span> <span class="s">&quot;derby&quot;</span> <span class="o">%</span> <span class="s">&quot;10.4.1.3&quot;</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>これをbuild.sbtに書いて<code>update</code>を打つと大体うまくいく。でも時折、参照先のリポジトリに欲しいパッケージがない場合がある。この場合はSBTにリポジトリを追加してやらないといけない。</p>


<p><figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'><span class="n">solvers</span> <span class="o">+=</span> <span class="s">&quot;Sonatype OSS Snapshots&quot;</span> <span class="n">at</span> <span class="s">&quot;<a href="https://oss.sonatype.org/content/repositories/snapshots&amp;quot;">https://oss.sonatype.org/content/repositories/snapshots&amp;quot;</a></span>
</span></code></pre></td></tr></table></div></figure></p>

<p><code>名前 at URL</code>というフォーマット。</p>




<h3>.scalaビルド設定</h3>




<p>build.sbt以外にもproject/に置いたscalaファイルでビルド設定できる。
厳密にはbuils.sbtは結局project/以下のビルド設定にマージされることになるので、単なる略記法という意味以上のものはない。とはいっても便利。具体例で説明。</p>


<p><figure class='code'><figcaption><span>project/Build.scala</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'><span class="k">import</span> <span class="nn">sbt.<em></span>
</span><span class='line'><span class="k">import</span> <span class="nn">Keys.</em></span>
</span><span class='line'>
</span><span class='line'><span class="k">object</span> <span class="nc">HelloBuild</span> <span class="k">extends</span> <span class="nc">Build</span> <span class="o">{</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">val</span> <span class="n">sampleKeyA</span> <span class="k">=</span> <span class="nc">SettingKey</span><span class="o">[</span><span class="kt">String</span><span class="o">](</span><span class="s">&quot;sample-a&quot;</span><span class="o">,</span> <span class="s">&quot;demo key A&quot;</span><span class="o">)</span>
</span><span class='line'>    <span class="k">val</span> <span class="n">sampleKeyB</span> <span class="k">=</span> <span class="nc">SettingKey</span><span class="o">[</span><span class="kt">String</span><span class="o">](</span><span class="s">&quot;sample-b&quot;</span><span class="o">,</span> <span class="s">&quot;demo key B&quot;</span><span class="o">)</span>
</span><span class='line'>    <span class="k">val</span> <span class="n">sampleKeyC</span> <span class="k">=</span> <span class="nc">SettingKey</span><span class="o">[</span><span class="kt">String</span><span class="o">](</span><span class="s">&quot;sample-c&quot;</span><span class="o">,</span> <span class="s">&quot;demo key C&quot;</span><span class="o">)</span>
</span><span class='line'>    <span class="k">val</span> <span class="n">sampleKeyD</span> <span class="k">=</span> <span class="nc">SettingKey</span><span class="o">[</span><span class="kt">String</span><span class="o">](</span><span class="s">&quot;sample-d&quot;</span><span class="o">,</span> <span class="s">&quot;demo key D&quot;</span><span class="o">)</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">override</span> <span class="k">lazy</span> <span class="k">val</span> <span class="n">settings</span> <span class="k">=</span> <span class="k">super</span><span class="o">.</span><span class="n">settings</span> <span class="o">++</span>
</span><span class='line'>        <span class="nc">Seq</span><span class="o">(</span><span class="n">sampleKeyA</span> <span class="o">:=</span> <span class="s">&quot;A: in Build.settings in Build.scala&quot;</span><span class="o">,</span> <span class="n">resolvers</span> <span class="o">:=</span> <span class="nc">Seq</span><span class="o">())</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">lazy</span> <span class="k">val</span> <span class="n">root</span> <span class="k">=</span> <span class="nc">Project</span><span class="o">(</span><span class="n">id</span> <span class="k">=</span> <span class="s">&quot;hello&quot;</span><span class="o">,</span>
</span><span class='line'>                            <span class="n">base</span> <span class="k">=</span> <span class="n">file</span><span class="o">(</span><span class="s">&quot;.&quot;</span><span class="o">),</span>
</span><span class='line'>                            <span class="n">settings</span> <span class="k">=</span> <span class="nc">Project</span><span class="o">.</span><span class="n">defaultSettings</span> <span class="o">++</span> <span class="nc">Seq</span><span class="o">(</span><span class="n">sampleKeyB</span> <span class="o">:=</span> <span class="s">&quot;B: in the root project settings in Build.scala&quot;</span><span class="o">))</span>
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>次にbuild.sbt</p>


<p><figure class='code'><figcaption><span>build.sbt</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'><span class="n">sampleKeyC</span> <span class="n">in</span> <span class="nc">ThisBuild</span> <span class="o">:=</span> <span class="s">&quot;C: in build.sbt scoped to ThisBuild&quot;</span>
</span><span class='line'><span class="n">sampleKeyD</span> <span class="o">:=</span> <span class="s">&quot;D: in build.sbt&quot;</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>ここでsbtインタラクティブモードで<code>inspect sample-a</code>とうつ</p>


<p><figure class='code'><figcaption><span>bash</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'><span class="n">$</span> <span class="n">sbt</span>
</span><span class='line'><span class="o">&gt;</span> <span class="n">inspect</span> <span class="n">sample</span><span class="o">&ndash;</span><span class="n">a</span>
</span><span class='line'><span class="o">[</span><span class="kt">info</span><span class="o">]</span> <span class="nc">Setting</span><span class="k">:</span> <span class="kt">java.lang.String</span> <span class="o">=</span> <span class="n">A</span><span class="k">:</span> <span class="kt">in</span> <span class="kt">Build.settings</span> <span class="kt">in</span> <span class="kt">Build.scala</span>
</span><span class='line'><span class="o">[</span><span class="kt">info</span><span class="o">]</span> <span class="nc">Provided</span> <span class="n">by</span><span class="k">:</span>
</span><span class='line'><span class="err">[</span><span class="kt">info</span><span class="err">]</span>  <span class="o">{</span><span class="kt">file:/home/hp/checkout/hello/</span><span class="o">}</span><span class="kt">/*:sample-a</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>続いてsample-c</p>


<p><figure class='code'><figcaption><span>bash</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'><span class="o">&gt;</span> <span class="n">inspect</span> <span class="n">sample</span><span class="o">&ndash;</span><span class="n">c</span>
</span><span class='line'><span class="o">[</span><span class="kt">info</span><span class="o">]</span> <span class="nc">Setting</span><span class="k">:</span> <span class="kt">java.lang.String</span> <span class="o">=</span> <span class="n">C</span><span class="k">:</span> <span class="kt">in</span> <span class="kt">build.sbt</span> <span class="kt">scoped</span> <span class="kt">to</span> <span class="kt">ThisBuild</span>
</span><span class='line'><span class="o">[</span><span class="kt">info</span><span class="o">]</span> <span class="nc">Provided</span> <span class="n">by</span><span class="k">:</span>
</span><span class='line'><span class="err">[</span><span class="kt">info</span><span class="err">]</span>  <span class="o">{</span><span class="kt">file:/home/hp/checkout/hello/</span><span class="o">}</span><span class="kt">/*:sample-c</span>
</span></code></pre></td></tr></table></div></figure></p>

<p><code>Provided by</code>で表示されるスコープは同じなため、.sbtと.scalaはどちらに何を設定しても同じということになる。</p>


<p><figure class='code'><figcaption><span>bash</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'><span class="o">&gt;</span> <span class="n">inspect</span> <span class="n">sample</span><span class="o">&ndash;</span><span class="n">b</span>
</span><span class='line'><span class="o">[</span><span class="kt">info</span><span class="o">]</span> <span class="nc">Setting</span><span class="k">:</span> <span class="kt">java.lang.String</span> <span class="o">=</span> <span class="n">B</span><span class="k">:</span> <span class="kt">in</span> <span class="kt">the</span> <span class="kt">root</span> <span class="kt">project</span> <span class="kt">settings</span> <span class="kt">in</span> <span class="kt">Build.scala</span>
</span><span class='line'><span class="o">[</span><span class="kt">info</span><span class="o">]</span> <span class="nc">Provided</span> <span class="n">by</span><span class="k">:</span>
</span><span class='line'><span class="err">[</span><span class="kt">info</span><span class="err">]</span>  <span class="o">{</span><span class="kt">file:/home/hp/checkout/hello/</span><span class="o">}</span><span class="kt">hello/<em>:sample-b</span>
</span><span class='line'><span class="o">&gt;</span> <span class="n">inspect</span> <span class="n">sample</span><span class="o">&ndash;</span><span class="n">d</span>
</span><span class='line'><span class="o">[</span><span class="kt">info</span><span class="o">]</span> <span class="nc">Setting</span><span class="k">:</span> <span class="kt">java.lang.String</span> <span class="o">=</span> <span class="n">D</span><span class="k">:</span> <span class="kt">in</span> <span class="kt">build.sbt</span>
</span><span class='line'><span class="o">[</span><span class="kt">info</span><span class="o">]</span> <span class="nc">Provided</span> <span class="n">by</span><span class="k">:</span>
</span><span class='line'><span class="err">[</span><span class="kt">info</span><span class="err">]</span>  <span class="o">{</span><span class="kt">file:/home/hp/checkout/hello/</span><span class="o">}</span><span class="kt">hello/</em>:sample-d</span>
</span></code></pre></td></tr></table></div></figure></p>

<p><code>sample-b</code>は異なるスコープになっていることがわかる。これは<code>sample-d</code>に対応していることがわかる。</p>




<p>あとはプラグインとかの話しがあったけれど、ここらで自分なりにプロジェクトを作ってみたいと思う。
まとめのページはここ。このページもGitHub Pagesでできてるのか。</p>




<p><a href="http://scalajp.github.io/sbt-getting-started-guide-ja/summary/">http://scalajp.github.io/sbt-getting-started-guide-ja/summary/</a>
でも開発がそんなに活発でないかも。Epicの開発はほぼ停止してるみたいだし。</p>


  </p>
  <span class="meta">
    written 








  



<time datetime="2013-09-10T21:23:00+09:00" pubdate data-updated="true">Sep 10<span>th</span>, 2013</time>
    


  </span>

  
</article>

        </div>
      </div>
      
      
      <div class="row">
        <div class="col-md-offset-3 col-md-6">
          <article>
  <h2><a href="/blog/2013/09/09/sbtwoshi-tutapuroziekutozuo-cheng/">SBTを使ったプロジェクト作成(1)</a></h2>
  
  <p>
    <p>SBT(Simple Build Tool)というScalaのビルドツールを使ってみる。
<a href="http://scalajp.github.io/sbt-getting-started-guide-ja/">ここ</a>を参考にした。</p>




<h3>インストール</h3>




<p>まずインストール。macの場合はHomebrewで用意されているみたい。</p>


<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ brew install sbt</span></code></pre></td></tr></table></div></figure></p>

<h3>プロジェクトの作成</h3>




<p>ひな形は自分で作る。ここではhelloプロジェクトを作ってみる。</p>


<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ mkdir hello
</span><span class='line'>$ echo &lsquo;object Hi { def main(args: Array[String]) = println(&ldquo;Hi!&rdquo;) }&rsquo; &gt; hw.scala
</span><span class='line'>$ sbt
</span><span class='line'># ここで必要なパッケージとか勝手にインストールしてビルドしてくれるみたい
</span><span class='line'>&gt; run
</span><span class='line'>・・・
</span><span class='line'>Hi!</span></code></pre></td></tr></table></div></figure></p>

<p>複雑なことはまだたくさんあるけれど、必要なことはこれだけだ。あとは蛇足と後学のため。でもきっと大事なことだ。</p>




<h3>ソースコード</h3>




<p>sbtではソースツリーはMavenと同じものを使うらしい。Maven知らない。</p>


<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>hello/
</span><span class='line'> build.sbt  (パッケージのmeta情報とかここにまとめる)
</span><span class='line'> project/
</span><span class='line'>   Build.scala (ビルド設定とかここに書く。Makefileみたいなもの？)
</span><span class='line'> src/
</span><span class='line'>   main/
</span><span class='line'>     resources/
</span><span class='line'>        &lt;メインの jar に含むファイル&gt;
</span><span class='line'>     scala/
</span><span class='line'>        &lt;メインの Scala ソース&gt;
</span><span class='line'>     java/
</span><span class='line'>        &lt;メインの Java ソース&gt;
</span><span class='line'>   test/
</span><span class='line'>     resources/
</span><span class='line'>        &lt;テストの jar に含むファイル&gt;
</span><span class='line'>     scala/
</span><span class='line'>        &lt;テストの Scala ソース&gt;
</span><span class='line'>     java/
</span><span class='line'>        &lt;テストの Java ソース&gt;</span></code></pre></td></tr></table></div></figure></p>

<p>これ以外は無視されるらしい。sbtコマンドでビルドが終わるとここにtargetディレクトリが追加されて、そこにできたclassファイルとかjarファイルが置かれる。Gitで管理したいなら<code>.gitignore</code>にはこう書くのが定石らしい。</p>


<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>target/</span></code></pre></td></tr></table></div></figure></p>

<h3>インタラクティブモード</h3>




<p>sbtを引数なしで実行するとインタラクティブモードになる。さっき<code>&gt;</code>が出てきて<code>run</code>と打ったらところで見ているはずだ。インタラクティブモードでは<code>compile</code>とか<code>run</code>が使える。みたまんまだ。</p>




<h3>バッチモード</h3>




<p>コマンド（さっきインタラクティブモードで一個一個打ってたやつ）を一度に実行できる。引数も与えられる。（test-onlyにはtestAとtestBを引数に与えている）</p>


<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ sbt compile run &ldquo;test-only testA testB&rdquo;</span></code></pre></td></tr></table></div></figure></p>

<h3>継続的ビルド</h3>




<p>ソースファイルの変更をトリガーに実行したければコマンドの先頭に<code>~</code>をつける。例えばインタラクティブモードで以下のようにすると、ソースをいじるたびに勝手にコンパイルしてくれるようになる。</p>


<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&gt; ~ compile</span></code></pre></td></tr></table></div></figure></p>

<ul>
<li><code>clean</code>: targetの削除 <code>make clean</code>みたいなもの</li>
<li><code>compile</code>: コンパイルする</li>
<li><code>test</code>: コンパイルして実行</li>
<li><code>console</code>: コンパイル済のソースを依存ライブラリにパスを通してscalaインタプリタに入る</li>
<li><code>run</code>: プロジェクトのメインクラスを実行</li>
<li><code>package</code>:  src/main/resources 内のファイルと src/main/scala からコンパイルされたクラスを含む jar を作る</li>
</ul>




<h3>build.sbtの書き方</h3>




<p>ここで何書いていいかわからなかった大事なbuild.sbtが出てくる。
はじめの方に書いたけれどビルド定義にはbuild.sbtとproject/<em>.scalaの２通りがある。ただ慣例的にはメインでbuild.sbtを使いそれでできないことを</em>.scalaファイルで行うことが多いらしい。さてビルド定義。</p>




<h4>ビルド定義って？</h4>




<blockquote><p>プロジェクトを調べ、全てのビルド定義ファイルを処理した後、sbt は、ビルドを記述した不可変マップ（キーと値のペア）を最終的に作る。例えば、name というキーがあり、それは文字列の値、つまり君のプロジェクト名に関連付けられる。<br/>ビルド定義ファイルは直接には sbt のマップに影響を与えない。その代わり、ビルド定義は、型が Setting[T] のオブジェクトを含んだ巨大なリストを作る。 T はマップ内の値の型だ。（Scala の Setting[T] は Java の Setting<T> と同様。） Setting は、新しいキーと値のペアや、既存の値への追加など、マップの変換を記述する。 （関数型プログラミングの精神に則り、変換は新しいマップを返し、古いマップは更新されない。）<br/>build.sbt では、プロジェクト名の Setting[String] を以下のように作る:</p><p>name := &#8220;hello&#8221;</p><p>この Setting[String] は name キーを追加（もしくは置換）して &#8220;hello&#8221; という値に設定することでマップを変換する。 変換されたマップは新しい sbt のマップとなる。マップを作るために、sbt はまず、同じキーへの変更が一緒に起き、かつ他のキーに依存する値の処理が依存するキーの後にくるように Setting のリストをソートする。 次に、sbt はソートされた Setting のリストを順番にみていって、一つづつマップに適用する。</p><p>まとめ: ビルド定義は Setting[T] のリストを定義し、Setting[T] は sbt のキー・値ペアへの変換を表し、T は値の型を指す。</p></blockquote>




<p>何言ってるかわからない。
例えば最初の方に出てきた<code>build.sbt</code>はこんなだった。</p>


<p><figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'><span class="n">name</span> <span class="o">:=</span> <span class="s">&quot;hello&quot;</span>
</span><span class='line'>
</span><span class='line'><span class="n">version</span> <span class="o">:=</span> <span class="s">&quot;1.0&quot;</span>
</span><span class='line'>
</span><span class='line'><span class="n">scalaVersion</span> <span class="o">:=</span> <span class="s">&quot;2.9.1&quot;</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>これは<code>:=</code>の左側がSetting[T]型のオブジェクトで右側がその値だ。これらの値は組み込み型で型が決まっているので</p>


<p><figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'><span class="n">name</span> <span class="o">:=</span> <span class="mi">42</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>とやるとコンパイルしてくれないそうな。
キーの種類にはSettingとTaskがあり、nameとかversionはSetting。packageとかcompileはTaskとなる。なんだかまだ良くわからないけれど、設定値と実行命令みたいなものに２種類を設定できるっぽい。
ライブラリ依存性とかを書く場合はこんな感じ。ほうほう。</p>


<p><figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='scala'><span class='line'><span class="n">libraryDependencies</span> <span class="o">+=</span> <span class="s">&quot;org.apache.derby&quot;</span> <span class="o">%</span> <span class="s">&quot;derby&quot;</span> <span class="o">%</span> <span class="s">&quot;10.4.1.3&quot;</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>今日は一旦このへんで。</p>


  </p>
  <span class="meta">
    written 








  



<time datetime="2013-09-09T21:29:00+09:00" pubdate data-updated="true">Sep 9<span>th</span>, 2013</time>
    


  </span>

  
</article>

        </div>
      </div>
      
      
      <div class="row">
        <div class="col-md-offset-3 col-md-6">
          <article>
  <h2><a href="/blog/2013/09/07/scalawoshi-ukotoni/">Scalaを使うことに</a></h2>
  
  <p>
    <p>汎用人工知能の開発をするにあたって使う言語とかを考えていた。汎用人工知能（まだそれが何を意味するのか明瞭にはわかってない)で必要なスペックは次のものなのではないかなとあげてみた。</p>




<ul>
<li>高速</li>
<li>並列処理に向いている</li>
<li>関数型（少なくとも副作用を前提としないプログラム）</li>
</ul>




<p>ここであげた条件には自分の好み、向き不向きが含まれているけれど漠然とした現状を考えるとこれが妥当なのではないかな。
高速であることはいうまでもない。多分CとかC++が一番よい。でもC、C++はメモリ管理とか大変そうで個人的にはデカイものを書くときには向いてない気がする。
並列処理に向いているというのは機械学習を行わせたいので今流行のMahoutもJubatusも並列で計算をおこなっているのでそれが向いているものがいい。ErlangとかScalaがいいらしい。特にScalaのActorアーキテクチャはデッドロックや並列計算での問題が解消されやすいみたい。</p>




<p><a href="http://www.atmarkit.co.jp/ait/articles/1209/06/news134.html">http://www.atmarkit.co.jp/ait/articles/1209/06/news134.html</a></p>




<p>あと関数型。副作用を前提とした言語だとプログラムを書いていてバグを埋め込みやすいのでできれば関数型言語を使いたい。Haskellなんかは純粋関数型言語で今流行だけど、ライブラリの数とかでは叶わない。あとはちょっとこてこてなのでSchemeとかかな。</p>




<p>というわけで選んだのは<strong>Scala</strong>です。一番バランスがよかったのでこの言語で作っていこうと思います。今はこちらでScalaの勉強中。</p>




<p><a href="http://www.atmarkit.co.jp/ait/articles/1202/10/news122.html">http://www.atmarkit.co.jp/ait/articles/1202/10/news122.html</a></p>


  </p>
  <span class="meta">
    written 








  



<time datetime="2013-09-07T23:22:00+09:00" pubdate data-updated="true">Sep 7<span>th</span>, 2013</time>
    

in
<span class="categories">
  
    <a class='category' href='/blog/categories/ai/'>AI</a>, <a class='category' href='/blog/categories/scala/'>Scala</a>
  
</span>


  </span>

  
</article>

        </div>
      </div>
      
    </div>
  </div>
</div>

    <footer id="footer" class="her-row">
  <div class="container">
    <div class="row">
      <div class="col-md-1">
  <a href="/"><h4>Home</h4></a>
</div>

<div class="col-md-2">
  <div class="social-icon-list">
    
    <a href="https://twitter.com/Lewuathe"><img src="/images/glyphicons_social_31_twitter.png"/></a>
    

    
    <a href="https://github.com/Lewuathe"><img src="/images/glyphicons_social_21_github.png"/></a>
    

    

    
  </div>
</div>

<div class="pull-right">
  <h4>Powered by <a href="http://octopress.org/">Octopress</a>. Designed by <a href="http://AdrianArtiles.com">Adrian Artiles</a>.</h4>
</div>


    </div>
  </div>
</footer>

  </body>
</html>
