
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Reference Configuration Library in Nodejs - The first cry of Atom</title>
  <meta name="author" content="Your Name">

  
  <meta name="description" content="I made npm module at the end of this year, readonly. lewuathe/readonly @GitHub readonly @npm readonly is a simple reference restriction library &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://Lewuathe.github.io/blog/2013/12/30/reference-configuration-library-in-nodejs">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="The first cry of Atom" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-44055098-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">The first cry of Atom</a></h1>
  
    <h2>The people who are crazy enough to think thay can change the world, are the ones who do</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:Lewuathe.github.io" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
  <li><a href="http://fotologue.jp/lewuathe">Pictures</a></li>
  <li><a href="https://github.com/Lewuathe">GitHub</a></li>
  <li><a href="https://twitter.com/Lewuathe">Twitter</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Reference Configuration Library in Nodejs</h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-12-30T20:24:00+09:00" pubdate data-updated="true">Dec 30<span>th</span>, 2013</time>
        
      </p>
    
  </header>


<div class="entry-content"><p>I made npm module at the end of this year, <em>readonly</em>.</p>

<p><a href="https://github.com/Lewuathe/readonly">lewuathe/readonly @GitHub</a></p>

<p><a href="https://npmjs.org/package/readonly">readonly @npm</a></p>

<p>readonly is a simple reference restriction library between custom modules in node object.
When you want to configure access control of specific object from respective modules, this is good option.
For example, you made two modules, both use the same object.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="c1">// obj is uses from moduleA and moduleB</span>
</span><span class='line'><span class="c1">// You want moduleA to read and update obj, but moduleB to read obj only.</span>
</span><span class='line'><span class="kd">var</span> <span class="nx">obj</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;A&#39;</span><span class="o">:</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;B&#39;</span><span class="o">:</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="s1">&#39;C&#39;</span><span class="o">:</span><span class="s1">&#39;c&#39;</span><span class="p">};</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// Embedded in moduleA</span>
</span><span class='line'><span class="kd">var</span> <span class="nx">moduleA</span> <span class="o">=</span> <span class="p">{};</span>
</span><span class='line'><span class="nx">moduleA</span><span class="p">.</span><span class="nx">obj</span> <span class="o">=</span> <span class="nx">obj</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// Readonly restriction of `obj` from moduleB</span>
</span><span class='line'><span class="kd">var</span> <span class="nx">moduleB</span> <span class="o">=</span> <span class="p">{};</span>
</span><span class='line'><span class="nx">moduleB</span><span class="p">.</span><span class="nx">obj</span> <span class="o">=</span> <span class="nx">readonly</span><span class="p">(</span><span class="nx">obj</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// You can update `obj` from moduleA</span>
</span><span class='line'><span class="nx">moduleA</span><span class="p">.</span><span class="nx">obj</span><span class="p">.</span><span class="nx">A</span> <span class="o">=</span> <span class="s2">&quot;d&quot;</span><span class="p">;</span>
</span><span class='line'><span class="c1">// But you cannot update `obj` from moduleB</span>
</span><span class='line'><span class="nx">moduleA</span><span class="p">.</span><span class="nx">obj</span><span class="p">.</span><span class="nx">B</span> <span class="o">=</span> <span class="s2">&quot;e&quot;</span><span class="p">;</span>  <span class="c1">// Error</span>
</span></code></pre></td></tr></table></div></figure>


<p>In this situation, you can use <strong>readonly</strong>.</p>

<h2>Install</h2>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="nx">$</span> <span class="nx">npm</span> <span class="nx">install</span> <span class="nx">readonly</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Usage</h2>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="kd">var</span> <span class="nx">readonly</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;readonly&#39;</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="kd">var</span> <span class="nx">obj</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;A&#39;</span><span class="o">:</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;B&#39;</span><span class="o">:</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="s1">&#39;C&#39;</span><span class="o">:</span><span class="s1">&#39;c&#39;</span><span class="p">};</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// Normal ACL. You can use `obj` through moduleA as you like</span>
</span><span class='line'><span class="kd">var</span> <span class="nx">moduleA</span> <span class="o">=</span> <span class="p">{};</span>
</span><span class='line'><span class="nx">moduleA</span><span class="p">.</span><span class="nx">obj</span> <span class="o">=</span> <span class="nx">obj</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// Readonly restriction of `obj` in moduleB</span>
</span><span class='line'><span class="kd">var</span> <span class="nx">moduleB</span> <span class="o">=</span> <span class="p">{};</span>
</span><span class='line'><span class="nx">moduleB</span><span class="p">.</span><span class="nx">obj</span> <span class="o">=</span> <span class="nx">readonly</span><span class="p">(</span><span class="nx">obj</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// You can update `obj` from moduleA</span>
</span><span class='line'><span class="nx">moduleA</span><span class="p">.</span><span class="nx">obj</span><span class="p">.</span><span class="nx">A</span> <span class="o">=</span> <span class="s2">&quot;d&quot;</span><span class="p">;</span>
</span><span class='line'><span class="c1">// This updates can be seen from moduleB</span>
</span><span class='line'><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">moduleB</span><span class="p">.</span><span class="nx">obj</span><span class="p">.</span><span class="nx">A</span><span class="p">);</span> <span class="c1">// --&gt; &quot;d&quot;</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// But if you update `obj` through moduleB, it will throws `UnableRewriteException`</span>
</span><span class='line'><span class="nx">moduleA</span><span class="p">.</span><span class="nx">obj</span><span class="p">.</span><span class="nx">B</span> <span class="o">=</span> <span class="s2">&quot;e&quot;</span><span class="p">;</span>  <span class="c1">// --&gt; UnableRewriteException: original cannot be rewrite</span>
</span></code></pre></td></tr></table></div></figure>


<p>With this library, you can access current property from restricted modules if original object is updates.
In above example, <code>moduleB.obj.A</code> returns <code>"d"</code>. Try it.
If you find any bugs, please inform me with <a href="https://github.com/Lewuathe/readonly/issues">GitHub</a></p>

<p>Enjoy <strong>readonly</strong> !</p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Kai Sasaki</span></span>

      








  


<time datetime="2013-12-30T20:24:00+09:00" pubdate data-updated="true">Dec 30<span>th</span>, 2013</time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/javascript/'>JavaScript</a>, <a class='category' href='/blog/categories/node/'>node</a>, <a class='category' href='/blog/categories/npm/'>npm</a>, <a class='category' href='/blog/categories/readonly/'>readonly</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  <a href="//twitter.com/share" class="twitter-share-button" data-url="http://Lewuathe.github.io/blog/2013/12/30/reference-configuration-library-in-nodejs/" data-via="Lewuathe" data-counturl="http://Lewuathe.github.io/blog/2013/12/30/reference-configuration-library-in-nodejs/" >Tweet</a>
  
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2013/12/23/how-to-start-krakenjs/" title="Previous Post: How to start KrakenJS">&laquo; How to start KrakenJS</a>
      
      
        <a class="basic-alignment right" href="/blog/2014/01/09/hack-tessel/" title="Next Post: Hack Tessel!">Hack Tessel! &raquo;</a>
      
    </p>
  </footer>
</article>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2014/02/15/yes-you-are-malala/">Yes, You Are Malala</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/02/14/nn-with-nodejs/">NN With Nodejs</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/02/05/restricted-boltzmann-machine-in-node/">Restricted Boltzmann Machine in Node</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/01/29/stacked-denoised-autoencoder-with-nodejs/">Stacked Denoised Autoencoder With Nodejs</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/01/26/autoencoder-with-node-dot-js/">Autoencoder With node.js</a>
      </li>
    
  </ul>
</section>





  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2014 - Your Name -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
