<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: Android | The first cry of Atom]]></title>
  <link href="http://lewuathe.github.io/blog/categories/android/atom.xml" rel="self"/>
  <link href="http://lewuathe.github.io/"/>
  <updated>2014-03-03T22:19:45+09:00</updated>
  <id>http://lewuathe.github.io/</id>
  <author>
    <name><![CDATA[Kai Sasaki]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Use JavaScriptInterface on Android]]></title>
    <link href="http://lewuathe.github.io/blog/2014/02/21/use-javascriptinterface-on-android/"/>
    <updated>2014-02-21T21:34:20+09:00</updated>
    <id>http://lewuathe.github.io/blog/2014/02/21/use-javascriptinterface-on-android</id>
    <content type="html"><![CDATA[<p>On Android, there is a system for calling Java method from JavaScript. This is called <a href="http://developer.android.com/reference/android/webkit/JavascriptInterface.html">JavaScriptInterface</a>.
With this class, you can call Java methods run on Android application from JavaScript written on any HTML file.</p>

<p>If you want, you can write good user interface with HTML and JavaScript. And backend logic can be written by Java, Android SDK.
So this is the potential way to write Android application. Today I&rsquo;d like to introduce this way.</p>

<!-- more -->


<h2>Attach WebView</h2>

<p>In order to render HTML, you need to use <a href="http://developer.android.com/reference/android/webkit/WebView.html">WebView</a>.
So first of all, attach WebView to your layout file.</p>

<p>```xml
&lt;?xml version=&ldquo;1.0&rdquo; encoding=&ldquo;utf-8&rdquo;?>
&lt;LinearLayout xmlns:android=&ldquo;<a href="http://schemas.android.com/apk/res/android">http://schemas.android.com/apk/res/android</a>&rdquo;</p>

<pre><code>          android:orientation="vertical"
          android:layout_width="fill_parent"
          android:layout_height="fill_parent" &gt;

&lt;WebView
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:id="@+id/webView" 
        android:layout_gravity="center_horizontal"/&gt;
</code></pre>

<p></LinearLayout>
```</p>

<h2>Write you HTML</h2>

<p>On previous WebView renders this html file. You need to write this file on your project directory so that an application can use it
from bundle files. My Sample looks like below.</p>

<p>```html
&lt;!DOCTYPE html>
<html>
<head></p>

<pre><code>&lt;title&gt;JSTest&lt;/title&gt;
</code></pre>

<p></head>
<body></p>

<pre><code>&lt;input type="button" value="Call Java" onclick="JSAction.action()" /&gt;
</code></pre>

<p></body>
</html></p>

<p>```</p>

<p><code>JSAction</code> is the Java class that implements JavaScriptInterface with annotation.
So last let&rsquo;s write down this interface class.</p>

<h2>Write JavaScriptInterface class</h2>

<p>```java
public class MyActivity extends Activity {</p>

<pre><code>/**
 * Called when the activity is first created.
 */
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    WebView webView = (WebView) findViewById(R.id.webView);
    webView.setWebViewClient(new WebViewClient());
    WebSettings settings = webView.getSettings();
    settings.setJavaScriptEnabled(true);

    webView.addJavascriptInterface(new JavaScriptAction(), "JSAction");
    webView.loadUrl("file:///android_asset/jstest.html");
}


// This is the JavaScriptInterface class
// All you need to do is write annotation for JavaScriptInterface. 
public class JavaScriptAction {
    @JavascriptInterface
    public void action() {
        Toast.makeText(MyActivity.this, 
                       "Called from JavaScript", 
                       Toast.LENGTH_SHORT).show();
    }
}
</code></pre>

<p>}
```</p>

<p><img src="/images/posts/2014-02-21-javascriptinterface-android/demo.png" alt="demo" /></p>

<p>That&rsquo;s all. When you click input button, a toast will show on screen.
By using JavaScriptInterface, you can easily separate UI design and business logic.
Definitely, this will be the useful option for your development.</p>

<p>If you want to look into the detail of these code, please access <a href="https://github.com/Lewuathe/JavaScriptInterface-sample">here</a>
This is my sample repository. I&rsquo;m glad to see this repository is used for further development.</p>

<p>Thank you.</p>
]]></content>
  </entry>
  
</feed>
