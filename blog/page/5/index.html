
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>The first cry of Atom</title>
  <meta name="author" content="Kai Sasaki">

  
  <meta name="description" content="The first cry of Atom
The people who are crazy enough to think thay can change the world, are the ones who do about me I’m a software engineer &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://lewuathe.github.io/blog/page/5">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="The first cry of Atom" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-44055098-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

  <body>
    <a href="/" class="home-icon">
      <img src="/images/home.png"/>
    </a>

    <div class="home-page">
  <div class="hero">
    <h1>The first cry of Atom</h1>
<p>The people who are crazy enough to think thay can change the world, are the ones who do</p>

  </div>

  <div class="home-field">
    <div class="home-landing her-row">
      <div class="container">
        <div class="row">
          <div id="about-me" class="col-md-offset-3 col-md-6">
  <h4>about me</h4>
  <p>I’m a software engineer living in Tokyo, Japan.I have a passion for developing the artificial intelligence that is the dream of humankind for a long time.I long for the world where technology supports our imcompleteness which is burdened since human was born. So I dedicate myself to realize these ideal some day.</p>
  <div class="social-icon-list">
  	
    <a title="Twitter" href="https://twitter.com/Lewuathe"><img src="/images/glyphicons_social_31_twitter.png"/></a>
    
    
    <a title="GitHub" href="https://github.com/Lewuathe"><img src="/images/glyphicons_social_21_github.png"/></a>
    
    
    
  </div>
</div>

        </div>
      </div>
    </div>

    <div class="article-list">
      <div class="container">
        
          
          <div class="row">
            <div class="col-md-offset-3 col-md-6">
              <article>
  <h2><a href="/blog/2013/12/09/agile-samurai-basecamp-in-tokyo/">Agile Samurai Basecamp in Tokyo <2></a></h2>
  
  <p>
    <p>This entry follows previous post.
The practical methods about TDD are explained in this section.</p>




<p>And also, it is written as an article of <a href="http://qiita.com/advent-calendar/2013/tddadventjp">TDD advent calendar on 10th day</a>.</p>




<h2>How to start TDD? Takuto Wada(twada)</h2>




<p>The left wing of agile is what about team environment, management, scrum, iteration and standup meeting. On the other hand, the right wing of agile is not perceived enough to ordinary people.
It&rsquo;s CI/CD and automation. These are also as important as the formers. There is apparent difference between making software and keeping making software. Agile programming always requires refactoring.
In TDD process, refactoring is the core process. You cannot say that you achieve TDD without refactoring your program.</p>




<h3>Write running code, and then write clean code</h3>




<p>Making Good design previously is difficult task. Besides we don&rsquo;t know what is good design on the system undefined yet. Software and program are too complex for us to understand perfectly.
So we cannot avoid progressing development with positivism notion. In other words, write code first! However we cannot solve all problems yet. The codes once confirmed as what runs with no bugs
are not willing to be refactored. We are afraid of changing running code. TDD enables us to pass over these fears. The concrete cycle of TDD is below.</p>




<h3>TDD cycle</h3>




<ol>
<li>Make TODO list</li>
<li>Write test code first</li>
<li>Running test and fail (<em>Red phase</em>)</li>
<li>Write product code</li>
<li>Running test and success (<em>Green phase</em>)</li>
<li>Refactoring product code with keeping Green</li>
<li>Repeat 1~6 process</li>
</ol>




<p>The most important process in these 7 phases is refactoring. If you result in failure of TDD, the main reason is to neglect refactoring your product code. It needs more power of the will.
So it is better to insert refactoring into TDD process. You don&rsquo;t do refactoring as an addition, but do as necessary process.</p>




<p><img src="/images/posts/2013-12-10-samurai-2/golden_cycle.jpg" alt="Golden Cycle" /></p>




<h3>The secrets of TDD</h3>




<p>To achive TDD, you should know how to start TDD at your daily work.</p>




<h3><em>Small start one by one</em></h3>




<p>You should make small TODO list as possible. It is good to reduce each task within the span which you can complete red, green and refactoring cycle in 15~30minutes.
The more fast you can complete, the better your TODO list is.</p>




<h3><em>Tackle one enemy in one time</em></h3>




<p>However, if you can reduce each task in small unit, starting all tasks at one time is not good work. As Samurai(Musashi Miyamoto) did, you have to also complete tasks one by one.
You can concentrate the essentials of each task,</p>




<h3><em>You are the first user</em></h3>




<p>When you write test code, you should take care of the usability. The interface of your product code is determined when you write your test code.
So before write your test code and while writing your test code, your should try and make the interface better bacause you are the first user of your product.
The only way to know how user friendly your product is using it yourself. In other words, let&rsquo;s test it.</p>




<h3><em>Test your uncertain</em></h3>




<p>The purpose of TDD is not mainly to guarantee software quality, but to take your ease in order to sleep peacefully. If there are no automatic test codes, it is horror.
The every time you release your products, you are to end up with praying for the success of the release. Or in order to assure that there are no bugs in your software,
you might have to many overtime work. That&rsquo;s too bad :(. To avoid this situation, test codes are selected and written under the criteria of how this test makes you peaceful.</p>




<h3><em>Knit a lifeline</em></h3>




<p>This is relevant to previous item. Compiled a lot of test codes will help you when you are in danger or crisis. This test codes become a lifeline knitted over many layers
It will support you in any situation strongly.</p>




<h3><em>The essencial goal of TDD</em></h3>




<p>The best goal of TDD is keeping your health. This means your code health, your team health and of course your code health. Bacause of TDD, all developers can go home early,
take a meal with your family and friends, make your product with peaceful mind. This is the essential goal of TDD for all software engineers. Conquering your anxiety and keeping you healthy.</p>




<h1>After session</h1>




<p>This goal made me realize why I am a software engineer again. Programming, writing code should always be fun. It should always be what makes me happy.
If you are unhappy with writing code as work, it mistakes the means for the end, doesn&rsquo;t it? TDD is the one way of making my life as software engineer more joyful.
That mind must not be forgot whenever I type my test code.</p>




<p>The each line of your test codes makes you happy, I believe.</p>


  </p>
  <span class="meta">
    written 








  



<time datetime="2013-12-09T20:16:00+09:00" pubdate data-updated="true">Dec 9<span>th</span>, 2013</time>
    

in
<span class="categories">
  
    <a class='category' href='/blog/categories/agile/'>Agile</a>, <a class='category' href='/blog/categories/samurai/'>Samurai</a>, <a class='category' href='/blog/categories/tdd/'>TDD</a>
  
</span>


  </span>

  
</article>

            </div>
          </div>
        
          
          <div class="row">
            <div class="col-md-offset-3 col-md-6">
              <article>
  <h2><a href="/blog/2013/12/08/whatt-going-on-at-agile-samurai-basecamp/">Agile Samurai Basecamp in Tokyo <1></a></h2>
  
  <p>
    <p>At work, I am a scrum padawan, not yet master :&ndash;)</p>




<p>Through developing with agile team, I was taught what scrum is, product backlog is, sprint is.</p>




<p>In order to accelerate this growth as an agile programmer, I took part in TDD section of <a href="http://www.agilesamuraibasecamp.org/">Agile Samurai Basecamp</a>.
TDD(Test Driven Development) is the most interesting method in my mind. So I wanted to know how to progress TDD in my daily work.
This article includes TDD core process which I study in basecamp and what I thought for the future career as a programmer.</p>




<h2>Keynote : Shintarou Kakutani</h2>




<p>He is the translator of <em><a href="http://pragprog.com/book/jtrap/the-agile-samurai">The Agile Samurai</a></em> .
He answered the questions  who is agile samurai, what agile teams are for.</p>




<h3>Who is agile samurai?</h3>




<p><img src="/images/posts/2013-12-08-samurai-1/samurai.jpg" alt="samurai" /></p>




<p>Agile team must keep to delivering valuable software every week. It doesn&rsquo;t mean just delivering lecture or lesson,
but codes which run as what you and your customer expects. To achieve this, it is very important to tackle problems as <em>&ldquo;whole one team&rdquo;</em>  which includes
your customers. Customers decide what you make, then your decide how you make. Delivering values to customer and tackling problems as whole one team is the
core concept of <em><a href="http://pragprog.com/book/jtrap/the-agile-samurai">The Agile Samurai</a></em> .</p>




<h3>Why did you write more Agile book?</h3>




<p>There were already many agile books in stores. Why another agile book is needed at that time?
In the past, there were no books which compiled main below 7 books which explains agile practice for detail.</p>




<ul>
<li><a href="http://www.amazon.co.jp/XP%E3%82%A8%E3%82%AF%E3%82%B9%E3%83%88%E3%83%AA%E3%83%BC%E3%83%A0%E3%83%BB%E3%83%97%E3%83%AD%E3%82%B0%E3%83%A9%E3%83%9F%E3%83%B3%E3%82%B0%E5%85%A5%E9%96%80%E2%80%95%E3%82%BD%E3%83%95%E3%83%88%E3%82%A6%E3%82%A7%E3%82%A2%E9%96%8B%E7%99%BA%E3%81%AE%E7%A9%B6%E6%A5%B5%E3%81%AE%E6%89%8B%E6%B3%95-%E3%82%B1%E3%83%B3%E3%83%88-%E3%83%99%E3%83%83%E3%82%AF/dp/489471275X">Extream programming explained</a></li>
<li><a href="http://www.amazon.co.jp/Refactoring-Improving-Existing-Addison-Wesley-Technology/dp/0201485672/ref=sr_1_1?s=english-books&amp;ie=UTF8&amp;qid=1386502275&amp;sr=1-1&amp;keywords=refactoring">Refactoring</a></li>
<li><a href="http://www.amazon.co.jp/XP%E3%82%A8%E3%82%AF%E3%82%B9%E3%83%88%E3%83%AA%E3%83%BC%E3%83%A0%E3%83%BB%E3%83%97%E3%83%AD%E3%82%B0%E3%83%A9%E3%83%9F%E3%83%B3%E3%82%B0%E5%AE%9F%E8%A1%8C%E8%A8%88%E7%94%BB-The-Series-%E3%82%B1%E3%83%B3%E3%83%88-%E3%83%99%E3%83%83%E3%82%AF/dp/4894713411/ref=sr_1_cc_1?s=aps&amp;ie=UTF8&amp;qid=1386502308&amp;sr=1-1-catcorr&amp;keywords=%E3%82%A8%E3%82%AF%E3%82%B9%E3%83%88%E3%83%AA%E3%83%BC%E3%83%A0%E3%83%97%E3%83%AD%E3%82%B0%E3%83%A9%E3%83%9F%E3%83%B3%E3%82%B0%E3%80%80%E5%AE%9F%E8%A1%8C%E8%A8%88%E7%94%BB">Extream programming planning</a></li>
<li><a href="http://www.amazon.co.jp/XP%E3%82%A8%E3%82%AF%E3%82%B9%E3%83%88%E3%83%AA%E3%83%BC%E3%83%A0%E3%83%BB%E3%83%97%E3%83%AD%E3%82%B0%E3%83%A9%E3%83%9F%E3%83%B3%E3%82%B0%E5%B0%8E%E5%85%A5%E7%B7%A8-XP%E5%AE%9F%E8%B7%B5%E3%81%AE%E6%89%8B%E5%BC%95%E3%81%8D-The-XP-Series/dp/4894714914/ref=sr_1_1?s=books&amp;ie=UTF8&amp;qid=1386502350&amp;sr=1-1&amp;keywords=%E3%82%A8%E3%82%AF%E3%82%B9%E3%83%88%E3%83%AA%E3%83%BC%E3%83%A0%E3%83%97%E3%83%AD%E3%82%B0%E3%83%A9%E3%83%9F%E3%83%B3%E3%82%B0%E3%80%80%E5%B0%8E%E5%85%A5%E7%B7%A8">Extream programming installed</a></li>
<li><a href="http://www.amazon.co.jp/%E3%83%86%E3%82%B9%E3%83%88%E9%A7%86%E5%8B%95%E9%96%8B%E7%99%BA%E5%85%A5%E9%96%80-%E3%82%B1%E3%83%B3%E3%83%88-%E3%83%99%E3%83%83%E3%82%AF/dp/4894717115/ref=sr_1_2?s=books&amp;ie=UTF8&amp;qid=1386502385&amp;sr=1-2&amp;keywords=Test+Driven+Development+by+example">Test Driven Development by example</a></li>
<li><a href="http://www.amazon.co.jp/User-Stories-Applied-Software-Development-ebook/dp/B0054KOL74/ref=sr_1_cc_1?s=aps&amp;ie=UTF8&amp;qid=1386502435&amp;sr=1-1-catcorr&amp;keywords=User+Stories+applied">User stories applied</a></li>
<li><a href="http://www.amazon.co.jp/%E3%82%A2%E3%82%B8%E3%83%A3%E3%82%A4%E3%83%AB%E3%81%AA%E8%A6%8B%E7%A9%8D%E3%82%8A%E3%81%A8%E8%A8%88%E7%94%BB%E3%81%A5%E3%81%8F%E3%82%8A-~%E4%BE%A1%E5%80%A4%E3%81%82%E3%82%8B%E3%82%BD%E3%83%95%E3%83%88%E3%82%A6%E3%82%A7%E3%82%A2%E3%82%92%E8%82%B2%E3%81%A6%E3%82%8B%E6%A6%82%E5%BF%B5%E3%81%A8%E6%8A%80%E6%B3%95~-Mike-Cohn/dp/4839924023/ref=sr_1_1?s=books&amp;ie=UTF8&amp;qid=1386502473&amp;sr=1-1&amp;keywords=%E3%82%A2%E3%82%B8%E3%83%A3%E3%82%A4%E3%83%AB%E3%81%AA%E8%A6%8B%E7%A9%8D%E3%82%82%E3%82%8A%E3%81%A8%E8%A8%88%E7%94%BB%E4%BD%9C%E3%82%8A">Agile Estimating and Planning</a></li>
</ul>




<p><em><a href="http://pragprog.com/book/jtrap/the-agile-samurai">The Agile Samurai</a></em> collects the essences of these books. In addition to these concepts, this book add new stuff.
So it&rsquo;s inception deck. If you want to know about inception deck, read this book. And the session of inception deck was also held at this bootcamp. This is important concept of agile practice.</p>




<h3>Why a hero in this book is called &ldquo;Samurai&rdquo;?</h3>




<p>The author, Jonathan Rasmusson likes <em>&ldquo;<a href="http://www.amazon.com/Way-Peaceful-Warrior-Changes-Lives/dp/0915811898">Peaceful Warrior</a>&rdquo;</em> . Initial title of &ldquo;Agile samurai&rdquo; was &ldquo;Agile peaceful warrior&rdquo; after this novel title. But it was not grasped by other people who have not read this book. So collaborators recommended him the word, &ldquo;Samurai&rdquo; which means same notion as peaceful warrior. &ldquo;Samurai&rdquo; is more perspicuous than &ldquo;peaceful warrior&rdquo; to the people of all over the world. Master sensei is also only the notion, not real samurai characters who lived in Japan.</p>




<h3>What is the agile practice?</h3>




<p>Agile development means the way of keeping feedback under the cooperative environment. To achieve team&rsquo;s goal, taking action requires cooperative environment of your team. All members must have the sense of ownership of their products. This thought makes good mood and necessary environment. But this practice can be accomplished only by your learning with on-the-job training. There is no secret ingredient. It&rsquo;s just you.</p>




<h3>Last but not least</h3>




<ol>
<li>Sharing what you learn with others</li>
<li>Keep searching the better answers</li>
<li>Enjoy!</li>
</ol>




<p>Enjoy your agile life!</p>


  </p>
  <span class="meta">
    written 








  



<time datetime="2013-12-08T19:29:00+09:00" pubdate data-updated="true">Dec 8<span>th</span>, 2013</time>
    

in
<span class="categories">
  
    <a class='category' href='/blog/categories/agile/'>Agile</a>, <a class='category' href='/blog/categories/basecaml/'>Basecaml</a>, <a class='category' href='/blog/categories/tdd/'>TDD&#8221;</a>
  
</span>


  </span>

  
</article>

            </div>
          </div>
        
          
          <div class="row">
            <div class="col-md-offset-3 col-md-6">
              <article>
  <h2><a href="/blog/2013/12/05/closure-with-async-dot-js/">Closure With Async.js</a></h2>
  
  <p>
    <p>You may use <a href="https://npmjs.org/package/async">Async.js</a> at least one time when you develop with nodejs.</p>




<blockquote><p>Async is a utility module which provides straight-forward, powerful functions for working with asynchronous JavaScript.</p></blockquote>




<p>So if you want to write asynchronous code with JavaScript, I recommend you to use it. It&rsquo;s easy to use, simple syntax.
However I had trouble with using Async.js in the context of giving dynamic task array. In this article, I want to share
how to write dynamic task array given to Async.js module.</p>




<h2>Problem</h2>




<p>I wrote like a below code with nodejs.</p>


<p><figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="kd">var</span> <span class="nx">async</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;async&#39;</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// Total task is 10 which is executed in parallel</span>
</span><span class='line'><span class="kd">var</span> <span class="nx">TASK_NUM</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// All task functions are put in taskList</span>
</span><span class='line'><span class="kd">var</span> <span class="nx">taskList</span> <span class="o">=</span> <span class="p">[];</span>
</span><span class='line'><span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">TASK_NUM</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">taskList</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">i</span><span class="p">);</span>
</span><span class='line'>        <span class="nx">callback</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="nx">i</span><span class="p">);</span>
</span><span class='line'>    <span class="p">});</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="nx">async</span><span class="p">.</span><span class="nx">parallel</span><span class="p">(</span><span class="nx">taskList</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">results</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">results</span><span class="p">);</span>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>When you run this code, I obtained below output.</p>


<p><figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="mi">10</span>
</span><span class='line'><span class="mi">10</span>
</span><span class='line'><span class="mi">10</span>
</span><span class='line'><span class="mi">10</span>
</span><span class='line'><span class="mi">10</span>
</span><span class='line'><span class="mi">10</span>
</span><span class='line'><span class="mi">10</span>
</span><span class='line'><span class="mi">10</span>
</span><span class='line'><span class="mi">10</span>
</span><span class='line'><span class="mi">10</span>
</span><span class='line'><span class="p">[</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span> <span class="p">]</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>This didn&rsquo;t fit my expectation. I thought all tasks should get i-th argument. So each task&rsquo;s output
is i-th number, if i-th task runs. However in this case, all task&rsquo;s output is 10. Why closure in function(In JavaScript, <code>function</code> makes variable scope, called closure) might not be effective?</p>




<h2>Answer</h2>




<p>There is answer in <a href="http://stackoverflow.com/questions/12472448/async-parallel-with-functions-dynamic-array">StackOverflow</a>.</p>




<blockquote><p>A closure doesn&rsquo;t &ldquo;trap&rdquo; the value that an outer variable had at the time it was created; it &ldquo;traps&rdquo; a reference to whatever value the outer variable has at the time it&rsquo;s executed (which in this case won&rsquo;t be until well after your for loop has finished.</p></blockquote>




<p>So in this case, closure does not make scope when it is <strong>declared</strong>, but <strong>executed</strong>. The variable <code>i</code> resulted in 10 after <code>for</code> loop in this code. And then each tasks will be executed under the condition that variable <code>i</code> is 10. I understood why these odd phenomenon was occured.</p>




<h2>How to write</h2>




<p>How should I write in order to execute this code as I expected in advance. Same page showed me the answer.</p>


<p><figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="kd">var</span> <span class="nx">deleteFunction</span> <span class="o">=</span> <span class="nx">makeDeleteFunction</span><span class="p">(</span><span class="nx">i</span><span class="p">,</span> <span class="nx">callback</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>Writing wrapper function which wraps my original tasks makes scope under given argument <code>i</code>. When you declare task, you should not make task function directly, but should give parameters which trapped in declaration context to the wrapper function. Here is my sample that is corresponds to above code.</p>


<p><figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="kd">var</span> <span class="nx">async</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;async&#39;</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// Wrapper function</span>
</span><span class='line'><span class="kd">function</span> <span class="nx">makeTask</span><span class="p">(</span><span class="nx">i</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">return</span> <span class="kd">function</span><span class="p">(</span><span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">i</span><span class="p">);</span>
</span><span class='line'>        <span class="nx">callback</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="nx">i</span><span class="p">);</span>
</span><span class='line'>    <span class="p">};</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// Total task is 10 which is executed in parallel</span>
</span><span class='line'><span class="kd">var</span> <span class="nx">TASK_NUM</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// All task functions are put in taskList</span>
</span><span class='line'><span class="kd">var</span> <span class="nx">taskList</span> <span class="o">=</span> <span class="p">[];</span>
</span><span class='line'><span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">TASK_NUM</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">taskList</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">makeTask</span><span class="p">(</span><span class="nx">i</span><span class="p">));</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="nx">async</span><span class="p">.</span><span class="nx">parallel</span><span class="p">(</span><span class="nx">taskList</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">results</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">results</span><span class="p">);</span>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>Then output is given as I expected.</p>


<p><figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="mi">0</span>
</span><span class='line'><span class="mi">1</span>
</span><span class='line'><span class="mi">2</span>
</span><span class='line'><span class="mi">3</span>
</span><span class='line'><span class="mi">4</span>
</span><span class='line'><span class="mi">5</span>
</span><span class='line'><span class="mi">6</span>
</span><span class='line'><span class="mi">7</span>
</span><span class='line'><span class="mi">8</span>
</span><span class='line'><span class="mi">9</span>
</span><span class='line'><span class="p">[</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span> <span class="p">]</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>If you write dynamic task function with Async.js, notice these fact.</p>


  </p>
  <span class="meta">
    written 








  



<time datetime="2013-12-05T20:29:00+09:00" pubdate data-updated="true">Dec 5<span>th</span>, 2013</time>
    

in
<span class="categories">
  
    <a class='category' href='/blog/categories/javascript/'>JavaScript</a>, <a class='category' href='/blog/categories/node/'>Node</a>, <a class='category' href='/blog/categories/async/'>async</a>
  
</span>


  </span>

  
</article>

            </div>
          </div>
        
          
          <div class="row">
            <div class="col-md-offset-3 col-md-6">
              <article>
  <h2><a href="/blog/2013/12/04/the-left-one/">The LEFT ONE</a></h2>
  
  <p>
    <iframe src="http://www.slideshare.net/slideshow/embed_code/28845284" width="427" height="356" frameborder="0" marginwidth="0" marginheight="0" scrolling="no" style="border:1px solid #CCC;border-width:1px 1px 0;margin-bottom:5px" allowfullscreen> </iframe>




<p> <div style="margin-bottom:5px"> <strong> <a href="https://www.slideshare.net/lewuathe/left-one" title="THE LEFT ONE" target="_blank">THE LEFT ONE</a> </strong> from <strong><a href="http://www.slideshare.net/lewuathe" target="_blank">Kai Sasaki</a></strong> </div></p>




<p>I decided to do. I always did so.
It&rsquo;s my challenge for my future, and my hapiness.</p>




<p>So I wrote it. Not to forget my footsteps.</p>


  </p>
  <span class="meta">
    written 








  



<time datetime="2013-12-04T23:07:00+09:00" pubdate data-updated="true">Dec 4<span>th</span>, 2013</time>
    

in
<span class="categories">
  
    <a class='category' href='/blog/categories/opnion/'>opnion</a>, <a class='category' href='/blog/categories/policy/'>policy</a>
  
</span>


  </span>

  
</article>

            </div>
          </div>
        
          
          <div class="row">
            <div class="col-md-offset-3 col-md-6">
              <article>
  <h2><a href="/blog/2013/12/01/how-do-i-change-my-homeland-with-open-data/">How Do I Change My Homeland With Open Data?</a></h2>
  
  <p>
    <p>Open data will change the world, and nations. How do I change my homeland with open data?</p>




<p>I find this article today
<a href="http://www.soumu.go.jp/menu_news/s-news/01ryutsu02_02000081.html">http://www.soumu.go.jp/menu_news/s-news/01ryutsu02_02000081.html</a></p>




<p>This is the software application contest using open data given by Ministry of Internal Affairs and Communications. I am interested in this content from two view points.</p>




<p>First, as a software developer, I am interested technologies used for mobile applications such as iOS or Android. For my engineer career and satisfying my interest, I want develop mobile applications this time.</p>




<p>Second, I want to develop an application which is able to answer social problems such as economic gap, social security, low birthrate and longevity. Open data enables us to develop such applications easily. I think all software should be developed and used for making our society good place. Solving all problems is real hacker mind. With open data, I want to make our homeland better place.</p>




<p>Given data listed below.</p>




<ol>
<li>Administration data stored local authorities.</li>
<li>Usability and cost of social capital</li>
<li>Information for travellers</li>
<li>Disaster prevention data</li>
<li>Information of transportation system</li>
<li>A large variety of statistics data</li>
</ol>




<p>I cannot understand what these data is completely. This contest deadline is February, 2014. There is not much time for me, but enough.</p>




<h2>My open data library.</h2>




<p>Already I have developed a library for iOS.</p>




<p><a href="https://github.com/Lewuathe/LEStatsRequest">https://github.com/Lewuathe/LEStatsRequest</a></p>




<p>LEStatsRequest is the API client of statistics of Japan government. This library contributes open data movement in Japan. You can obtain official data with this client espacially in iOS device. iOS device is restricted memory capacity, so this library parses response XML and make useful objects. With this library, you can use Japan open data easily. If you have some interest in open data, please check it.</p>




<p>In the future, open data surely changes our life. Our involvement with government and society will require our more positiveness. I think this is good thing for current closed our society.</p>




<p>I want to make the use of my ability for our society.</p>


  </p>
  <span class="meta">
    written 








  



<time datetime="2013-12-01T19:09:00+09:00" pubdate data-updated="true">Dec 1<span>st</span>, 2013</time>
    

in
<span class="categories">
  
    <a class='category' href='/blog/categories/data/'>data</a>, <a class='category' href='/blog/categories/open/'>open</a>
  
</span>


  </span>

  
</article>

            </div>
          </div>
        
          
          <div class="row">
            <div class="col-md-offset-3 col-md-6">
              <article>
  <h2><a href="/blog/2013/11/28/my-first-jenkins-plugin/">My First Jenkins Plugin</a></h2>
  
  <p>
    <p>Released my first Jenkins plugin</p>




<p><a href="https://github.com/jenkinsci/hckrnews-plugin">https://github.com/jenkinsci/hckrnews-plugin</a></p>




<p><img src="/images/posts/2013-11-28-hckrnews-plugin/screen-shot.png" alt="Screen shot" /></p>




<p>With this plugin, you can read hacker news top time line sitting in front of CI server.
So you can read top topics about technology and so on at the same time building your project. Does it sound good?</p>




<h2>How to publish Jenkins plugin?</h2>




<h3>Make GitHub repository</h3>




<p>Normal Maven project needs only src/ and pom.xml. Jenkins plugin project is not exception.
Write right .gitignore, and ignore target/ and work/ directory. These are not necessary.</p>




<h3>Create new jenkins-ci account</h3>




<p>Visit <a href="https://jenkins-ci.org/account/">here</a>. Create your new account.</p>




<h3>Write settings.xml your account information</h3>




<p>Your account name, and password got from above process should be written in <code>~/.m2/settings.xml</code> like below.</p>


<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;settings&gt;
</span><span class='line'> ・・・
</span><span class='line'>  &lt;servers&gt;
</span><span class='line'>    &lt;server&gt;
</span><span class='line'>      &lt;id&gt;maven.jenkins-ci.org&lt;/id&gt;
</span><span class='line'>      &lt;username&gt;XXXXXX&lt;/username&gt;
</span><span class='line'>      &lt;password&gt;XXXXXX&lt;/password&gt;
</span><span class='line'>    &lt;/server&gt;
</span><span class='line'>  &lt;/servers&gt;
</span><span class='line'>  ・・・
</span><span class='line'>&lt;/settings&gt;</span></code></pre></td></tr></table></div></figure></p>

<h3>Application for forking repository</h3>




<p>Send an email to community <a href="https://groups.google.com/forum/#!forum/jenkinsci-ja">mailing list</a> in Japan. If you want to send other community, search <a href="http://jenkins-ci.org/content/mailing-lists">here</a>
Soon your repository is forked to original jenkinsci organization.</p>




<h3>Modify pom.xml</h3>




<p>Add some line. SCM repository url should be written in your project <code>pom.xml</code></p>


<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;scm&gt;
</span><span class='line'>    &lt;connection&gt;scm:git:ssh://github.com/jenkinsci/XXXXXXXX.git&lt;/connection&gt;
</span><span class='line'>    &lt;developerConnection&gt;scm:git:ssh://git@github.com/jenkinsci/XXXXXXXX.git&lt;/developerConnection&gt;
</span><span class='line'>    &lt;url&gt;<a href="https://github.com/jenkinsci/XXXXXXXX.git&amp;lt;/url&amp;gt;">https://github.com/jenkinsci/XXXXXXXX.git&amp;lt;/url&amp;gt;</a>
</span><span class='line'>&lt;/scm&gt;</span></code></pre></td></tr></table></div></figure></p>

<h3>Release!</h3>




<p>Type below command.</p>


<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ mvn release:prepare release:perform</span></code></pre></td></tr></table></div></figure></p>

<p>One this your should pay attention to is not to add <code>-Dusername</code> and <code>-Dpassword</code> options. These are not used for GitHub but jenkinsci.org
Congratulations!!</p>




<h3>Future</h3>




<p>In fact, I make this plugin with no experience of writing Java, of course maven.
Therefore I have to study these tool and Java grammar. In addition to this, I learned how to write some design patterns with coding in accordance with OO programming.</p>




<p>I also wrote some test codes with JUnit in maven. TDD is the method with which I want to develop. In this time, first I wrote unit test code and second logic code. This is fun for me because my code&rsquo;s quality seems to be kept easily. I want to keep writing test code first. This is the best practice for my developing.</p>




<p>This plugin has only simple functions, however, this experience is sufficient value as software engineer.
In the future, I will seize the moment and make more my own plugins.</p>




<p>Ultimately, please use this plugin. It brings to you a new continuous integration life.</p>




<p>Thank you.</p>


  </p>
  <span class="meta">
    written 








  



<time datetime="2013-11-28T21:15:00+09:00" pubdate data-updated="true">Nov 28<span>th</span>, 2013</time>
    

in
<span class="categories">
  
    <a class='category' href='/blog/categories/java/'>Java</a>, <a class='category' href='/blog/categories/jenkins/'>Jenkins</a>, <a class='category' href='/blog/categories/maven/'>Maven</a>, <a class='category' href='/blog/categories/plugin/'>plugin</a>
  
</span>


  </span>

  
</article>

            </div>
          </div>
        
          
          <div class="row">
            <div class="col-md-offset-3 col-md-6">
              <article>
  <h2><a href="/blog/2013/11/22/maifalseriteiripoto/">マイノリティ・リポート</a></h2>
  
  <p>
    <p>この夏にあったことだ。</p>




<p><img src="/images/posts/2013-11-22-minority/tie.jpg" alt="tie" /></p>




<p>一般的に社会人が半ズボンを履いて会社へ行くことは「正しくない」ことだと考えられている。
でもこの夏はとっても暑かったので、半ズボンがどれだけ許されるのか知りたいということもありいろいろなズボンで会社に行ってみた。
長ズボン、七分丈、膝の見える短パン。長さや柄を混ぜこぜにして出勤してみた。</p>




<p>そうしたところ、柄やメーカーにかかわらず膝が見えると「それ、(会社に履いてくるの)大丈夫？」と聞いてくる人がいることがわかった。
なるほど、膝が見えるとダメらしい。というわけでいちいちめんどくさいので夏の後半はどんなに暑くても七分丈にすることにした。</p>




<h2>「正しい」と「正しくない」</h2>




<p>ところでどうして、短パンは「正しくない」と判断されて、長ズボンは「正しい」と判断されるんだろうか。
どうして、規則に「反している」、「反していない」と言われないんだろうか。あるいは規則がどうして「正しい」と判断されるんだろうか。
社会人としてスーツを着てくることが「正しい」と考える人は多いと思う。でもどうしてそれを「多くの人がやっているから」とか、「規則で決まっているから」
とか言わないんだろう。どうして「正しい」という価値が入ってしまうんだろう。</p>




<p>もし僕が社会人としてスーツは「正しくない」じゃないと言ったらどうなんだろう。</p>




<p>「そんな風に思うやつはお前だけだ」と言われるかもしれない。
だとしたら、スーツを着る理由は「正しい」からではなく、「大勢がそうしている」からだ。</p>




<p>「昔からそうだったんだ」と言われるかもしれない。
だとしたら、スーツを着る理由は「正しい」からではなく、「昔からそうしている」からだ。</p>




<p>「スーツには社会人として必要な機能が備わっているからだ」と言われるかもしれない。
だとしたら、スーツを着る理由は「正しい」からではなく、「社会人として必要な機能が備わっている」からだ。</p>




<p>僕が言いたいのは「正しい」、「正しくない」という価値判断をむやみに加えて論理的な理由付けをうやむやにしてしまうのは良くないことだと思うということ。</p>




<p>「正しい」、「正しくない」は人によって違う。
でもポケットがいっぱいあって便利というのはだれにとってもほぼ同じ感覚だ。</p>




<p>何か規則を決めたり、考えを広めるときに「正しい」というラベルをはらないとそれを広めることが難しいと感じることがある。
だから人はむやみにこれは「正しい」、あれは「正しくない」ということを必ず言ってしまうのだと思う。</p>




<p>別にいいと思う。「正しさ」なんて大義名分をはらなくても、理屈が通っていれば。
「便利だから」、「暖かいから」、「毎日着る洋服に迷うことがないから」、「どんなお店にも入れるから」。
それでいいじゃないか。</p>




<h2>桃太郎がいなければ鬼もいない</h2>




<p>結果として一緒じゃないかと思うかもしれない。理屈が通っていようが通っていまいが、お前がスーツを着ろと言われることは同じじゃないかと。
でも全然違うんだ。正義の味方は悪の秘密結社を必要とする。</p>




<p>アンパンマンはバイキンマンが必要だし名探偵コナンは殺人犯が必要だ。桃太郎では鬼がいなければ話ははじまらないし、ショッカー軍団がいなければ仮面ライダーは何もしないだろう。</p>




<p>「正しい」意見は必ず「正しくない」意見を必要とする。</p>




<p>彼らのせいで必ず悪者が作られる。確かに「作られる」。
本当は正義の反対側はもうひとつの正義にすぎない。「正しい」といった瞬間に「正しくない」意見ができる。そして、「正しくない」意見を排除しようとする。
本当はもうひとつの「正しさ」であるはずの意見が排除される理由になってしまう。</p>




<p>「暖かい洋服だから」という意見に「寒い洋服でいい」という意見が間違っているとも劣っているとも思わない。</p>




<p>ただ「正しいから」と言ってしまうと「正しくないものでいい」というのはなんだかおかしい。本人は正しくなくていいと思っているのかもしれないが、僕は言ってあげたい。</p>




<p>「君の意見も同じように正しいんだ」と。</p>




<p>だから決して「正しい」意見というものを言わないで欲しい。半ズボンを履くのも「不快に感じる人がいるから」とか、「風邪をひきやすいから」とかそう言って欲しい。
決してそれらが「正しい」わけではないけれど。</p>


  </p>
  <span class="meta">
    written 








  



<time datetime="2013-11-22T11:13:00+09:00" pubdate data-updated="true">Nov 22<span>nd</span>, 2013</time>
    

in
<span class="categories">
  
    <a class='category' href='/blog/categories/minority/'>minority</a>, <a class='category' href='/blog/categories/opnion/'>opnion</a>
  
</span>


  </span>

  
</article>

            </div>
          </div>
        
          
          <div class="row">
            <div class="col-md-offset-3 col-md-6">
              <article>
  <h2><a href="/blog/2013/11/16/developing-jenkins-plugin-on-vagrant/">Developing Jenkins Plugin on Vagrant</a></h2>
  
  <p>
    <p>Recently I investigate the scalability of Jenkins. In my idea, I want to make hot standby Jenkins server with NFS. So the plugins which enable us to do that are required. And for my study, I decided to develop on Vagrant and VirtualBox. It costs me very little because there is no need to get real server.  So in this post, I will describe how to set up your jenkins plugin environment on your vagrant Ubuntu.</p>




<h2>Start vagrant</h2>




<p>My <code>Vagrantfile</code> is below. Before this, you should download precise64 box on vagrant <a href="http://www.vagrantbox.es/">site</a></p>


<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># &ndash;<em>&ndash; mode: ruby &ndash;</em>&ndash;
</span><span class='line'># vi: set ft=ruby :
</span><span class='line'>
</span><span class='line'>Vagrant.configure(&ldquo;2&rdquo;) do |config|
</span><span class='line'>  # Every Vagrant virtual environment requires a box to build off of.
</span><span class='line'>  config.vm.box = &ldquo;ubuntu&rdquo;
</span><span class='line'>
</span><span class='line'>  # Create a forwarded port mapping which allows access to a specific port
</span><span class='line'>  # within the machine from a port on the host machine. In the example below,
</span><span class='line'>  # accessing &ldquo;localhost:8080&rdquo; will access port 80 on the guest machine.
</span><span class='line'>  config.vm.network :forwarded_port, guest: 8080, host: 8080
</span><span class='line'>
</span><span class='line'> end</span></code></pre></td></tr></table></div></figure></p>

<p>Jenkins plugin server starts on port 8080. So you need to write guest port 8080. Host port can be written any number.
And start vagrant.</p>


<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ vagrant up</span></code></pre></td></tr></table></div></figure></p>

<h2>Set up maven3</h2>




<p>Jenkins plugins are build with Maven. In this time, Maven3 can build sample plugin easily, so I recommend that you download maven3.</p>


<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ sudo apt-get install maven</span></code></pre></td></tr></table></div></figure></p>

<h2>Write settings.xml</h2>




<p>Write settings.xml as below.</p>


<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;settings&gt;
</span><span class='line'>  &lt;pluginGroups&gt;
</span><span class='line'>    &lt;pluginGroup&gt;org.jenkins-ci.tools&lt;/pluginGroup&gt;
</span><span class='line'>  &lt;/pluginGroups&gt;
</span><span class='line'>
</span><span class='line'>  &lt;profiles&gt;
</span><span class='line'>    &lt;!&mdash; Give access to Jenkins plugins &mdash;&gt;
</span><span class='line'>    &lt;profile&gt;
</span><span class='line'>      &lt;id&gt;jenkins&lt;/id&gt;
</span><span class='line'>      &lt;activation&gt;
</span><span class='line'>        &lt;activeByDefault&gt;true&lt;/activeByDefault&gt; &lt;!&mdash; change this to false, if you don&rsquo;t like to have it on per default &mdash;&gt;
</span><span class='line'>      &lt;/activation&gt;
</span><span class='line'>      &lt;repositories&gt;
</span><span class='line'>        &lt;repository&gt;
</span><span class='line'>          &lt;id&gt;repo.jenkins-ci.org&lt;/id&gt;
</span><span class='line'>          &lt;url&gt;<a href="http://repo.jenkins-ci.org/public/&amp;lt;/url&amp;gt;">http://repo.jenkins-ci.org/public/&amp;lt;/url&amp;gt;</a>
</span><span class='line'>        &lt;/repository&gt;
</span><span class='line'>      &lt;/repositories&gt;
</span><span class='line'>      &lt;pluginRepositories&gt;
</span><span class='line'>        &lt;pluginRepository&gt;
</span><span class='line'>          &lt;id&gt;repo.jenkins-ci.org&lt;/id&gt;
</span><span class='line'>          &lt;url&gt;<a href="http://repo.jenkins-ci.org/public/&amp;lt;/url&amp;gt;">http://repo.jenkins-ci.org/public/&amp;lt;/url&amp;gt;</a>
</span><span class='line'>        &lt;/pluginRepository&gt;
</span><span class='line'>      &lt;/pluginRepositories&gt;
</span><span class='line'>    &lt;/profile&gt;
</span><span class='line'>  &lt;/profiles&gt;
</span><span class='line'>  &lt;mirrors&gt;
</span><span class='line'>    &lt;mirror&gt;
</span><span class='line'>      &lt;id&gt;repo.jenkins-ci.org&lt;/id&gt;
</span><span class='line'>      &lt;url&gt;<a href="http://repo.jenkins-ci.org/public/&amp;lt;/url&amp;gt;">http://repo.jenkins-ci.org/public/&amp;lt;/url&amp;gt;</a>
</span><span class='line'>      &lt;mirrorOf&gt;m.g.o-public&lt;/mirrorOf&gt;
</span><span class='line'>    &lt;/mirror&gt;
</span><span class='line'>  &lt;/mirrors&gt;
</span><span class='line'>&lt;/settings&gt;</span></code></pre></td></tr></table></div></figure></p>

<h2>JDK!!</h2>




<p>I failed to create my plugin in this time bacause of lack of JDK. Ubuntu 12.04 LTS doesn&rsquo;t have JDK in own image. You have to install it.</p>


<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ sudo apt-get install default-jdk</span></code></pre></td></tr></table></div></figure></p>

<h2>Build plugin</h2>




<p>Building plugin with maven command.</p>


<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ mvn install</span></code></pre></td></tr></table></div></figure></p>

<p>And demonstrate your plugin.</p>


<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ mvn hpi:run</span></code></pre></td></tr></table></div></figure></p>

<p>You can see Jenkins web UI on <a href="http://localhost:8080/jenkins">http://localhost:8080/jenkins</a> unless maven command has not exit.
So now, I can get multi Jenkins server for mutual mount on NFS. My Jenkins study has been continued.</p>


  </p>
  <span class="meta">
    written 








  



<time datetime="2013-11-16T21:09:00+09:00" pubdate data-updated="true">Nov 16<span>th</span>, 2013</time>
    

in
<span class="categories">
  
    <a class='category' href='/blog/categories/jenkins/'>Jenkins</a>, <a class='category' href='/blog/categories/ubuntu/'>Ubuntu</a>, <a class='category' href='/blog/categories/vagrant/'>Vagrant</a>
  
</span>


  </span>

  
</article>

            </div>
          </div>
        
          
          <div class="row">
            <div class="col-md-offset-3 col-md-6">
              <article>
  <h2><a href="/blog/2013/11/10/nu-li-falseli-you/">頑張る理由</a></h2>
  
  <p>
    <p>読んだ。</p>




<p><a href="http://karigari.hatenablog.com/entry/2013/11/06/000000">http://karigari.hatenablog.com/entry/2013/11/06/000000</a></p>




<p>全く自分にとって新しいことでなくても、文字に起こされると驚くことがある。概念は知っていても言葉は知らない、そんな感じだ。自分が何か努力したり頑張ったり、そういったことを何のためにしているか。</p>




<p>答えは「自分のため」いつもそう答えていた。その答えは今でも変わらないけれど、その概念のエイリアスがあるとしたら、「やった事実はなくならないから」じゃないだろうか。</p>




<p>僕自身は今まで努力してきたことが報われることもあったし、報われないこともあった。努力でなんでも叶えられるとも思わないけれど、努力してやってやれないこともないんじゃないかと漠然と感じている。
だから僕はやりたいことがあったら努力したらいいんじゃないかと思う派だ（派閥があるとすればだけど）それが叶うとか叶わないとかあんまり関係なく頑張ってみればいいんじゃないかと体が知っているからだ。</p>




<p>でもだからそれを言葉にできない。もちろん言葉にできないから答えを知らないんだけれど、「やった事実はなくならない」という言葉はその答えなんじゃないかと感じた。</p>




<h3>やった事実はなくならない</h3>




<p>今までも頑張ってきていろんな結果が出てきたけれど、確かにやったことはなくなってないよなーって思う。受験勉強で覚えたこととか大体忘れたし、学生の時水泳もやっていたけれど、もうお腹だけぽっこり出始めてきたし運動してない。
それでもなくなってないよって思う。やっぱり体がそれを知っている。人間の体って1年の間にほぼ入れ替わるらしいからそれを知っていた体もほぼほぼなくなっているんだけど、それでもなくなってないよな。</p>




<p>多分、努力することの大切さを知っている人はこのことが分かっているんだと思う。夢は必ず叶うとか、諦めずにいればなんとかなるとか。本当はそういうことじゃなくてただ、「なくならないよ」って言いたいんだと思う。
結果はどうあれなくならない。それが失敗でも成功でも誰かに横取りされても盗まれても。自分が頑張った事実はなくならない。</p>




<p>そのなくならなかったものが役に立つとか全くわからない。けれどもなくならなかったものが体の中に幾つかあるっていうのはとても気持ちのいいものだ。なんて言うんだろう。体の中に金庫がある感じ。でも鍵は持ってない。
その中にいろいろ大事なものが入っているんだけれど自分にも開け方がわからなくてそれが使うこともできない。でも中に大事な何かが入っていることはわかって、頑張ったり努力したりするといつの間にかそこにものが入っていくことも
知っている。そういう感覚。</p>




<p>努力した結果はどうだか知らないけれど、努力した事実はなくならないことはわかってる。</p>




<p>多分そのことも努力した結果なくならなかった&#8221;事実&#8221;だと思う。</p>


  </p>
  <span class="meta">
    written 








  



<time datetime="2013-11-10T15:12:00+09:00" pubdate data-updated="true">Nov 10<span>th</span>, 2013</time>
    

in
<span class="categories">
  
    <a class='category' href='/blog/categories/life/'>Life</a>, <a class='category' href='/blog/categories/study/'>Study</a>
  
</span>


  </span>

  
</article>

            </div>
          </div>
        
          
          <div class="row">
            <div class="col-md-offset-3 col-md-6">
              <article>
  <h2><a href="/blog/2013/11/09/scikit-learndecross-validation/">scikit-learnでCross Validation</a></h2>
  
  <p>
    <p>だんだんとscikit-learnとMachine Learningに慣れてきた。
今回はCross ValidationとGrid Searchをやってみた。</p>




<h3>Cross Validation</h3>




<p>詳しいことは<a href="http://ja.wikipedia.org/wiki/%E4%BA%A4%E5%B7%AE%E6%A4%9C%E5%AE%9A">Wikipedia</a>に書いてある。
Cross Validationはモデルの妥当性を検証する方法のひとつ。一般的に開発用のデータは訓練データと検証データに分かれる。
しかし、このまま行ってしまうと折角の訓練データが減ってしまうことになる上に、訓練データの選び方によって汎化性能が下がってしまう可能性がある。
Wikipediaに書いてあるもののホールド・アウト検定がこれに当たる。一般にはこれはCross Validationにはあたらない。</p>




<p>ここに書いてあるK-分割交差検定がこれに当たる。K-分割交差検定では開発用のデータをK個に分割しK-1個を訓練用に、残りの一つを検証用に使いモデルの正当性を計算する。
これにより使える訓練データが増えると同時に、これらを訓練データを変えることにより、汎化性能を上げることができる。</p>




<p>scikit-learnで具体的にどのように行うのか書いてみた。訓練に使ったデータとしてはKaggleの<a href="http://www.kaggle.com/c/data-science-london-scikit-learn">Data Science London</a>で出されているものを用いた。</p>




<h3>SVM</h3>




<p>まずは単純にサポートベクターマシンでクラス分けをさせた時のコード</p>


<p><figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="c"># &ndash;<em>&ndash; coding: utf-8 &ndash;</em>&ndash;</span>
</span><span class='line'>
</span><span class='line'><span class="kn">import</span> <span class="nn">os</span>
</span><span class='line'><span class="kn">import</span> <span class="nn">sys</span>
</span><span class='line'><span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">svm</span>
</span><span class='line'><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
</span><span class='line'><span class="kn">import</span> <span class="nn">csv</span>
</span><span class='line'>
</span><span class='line'><span class="k">if</span> <span class="n"><strong>name</strong></span> <span class="o">==</span> <span class="s">&quot;<strong>main</strong>&quot;</span><span class="p">:</span>
</span><span class='line'>    <span class="n">train_feature_file</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">genfromtxt</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="s">&quot;../data/train.csv&quot;</span><span class="p">,</span> <span class="s">&quot;rb&quot;</span><span class="p">),</span> <span class="n">delimiter</span><span class="o">=</span><span class="s">&quot;,&quot;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
</span><span class='line'>    <span class="n">train_label_file</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">genfromtxt</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="s">&quot;../data/trainLabels.csv&quot;</span><span class="p">,</span> <span class="s">&quot;rb&quot;</span><span class="p">),</span> <span class="n">delimiter</span><span class="o">=</span><span class="s">&quot;,&quot;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">train_features</span> <span class="o">=</span> <span class="p">[]</span>
</span><span class='line'>    <span class="n">train_labels</span> <span class="o">=</span> <span class="p">[]</span>
</span><span class='line'>    <span class="k">for</span> <span class="n">train_feature</span><span class="p">,</span> <span class="n">train_label</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">train_feature_file</span><span class="p">,</span> <span class="n">train_label_file</span><span class="p">):</span>
</span><span class='line'>        <span class="n">train_features</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">train_feature</span><span class="p">)</span>
</span><span class='line'>        <span class="n">train_labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">train_label</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">train_features</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">train_features</span><span class="p">)</span>
</span><span class='line'>    <span class="n">train_labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">train_labels</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">clf</span> <span class="o">=</span> <span class="n">svm</span><span class="o">.</span><span class="n">SVC</span><span class="p">(</span><span class="n">C</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">cache_size</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">class_weight</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">coef0</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">degree</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">gamma</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">kernel</span><span class="o">=</span><span class="s">&quot;rbf&quot;</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=&ndash;</span><span class="mi">1</span><span class="p">,</span> <span class="n">probability</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span><span class="n">random_state</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">shrinking</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_features</span><span class="p">,</span> <span class="n">train_labels</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">test_feature_file</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">genfromtxt</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="s">&quot;../data/test.csv&quot;</span><span class="p">,</span> <span class="s">&quot;rb&quot;</span><span class="p">),</span> <span class="n">delimiter</span><span class="o">=</span><span class="s">&quot;,&quot;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">test_features</span> <span class="o">=</span> <span class="p">[]</span>
</span><span class='line'>    <span class="k">print</span> <span class="s">&quot;Id,Solution&quot;</span>
</span><span class='line'>    <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span>
</span><span class='line'>    <span class="k">for</span> <span class="n">test_feature</span> <span class="ow">in</span> <span class="n">test_feature_file</span><span class="p">:</span>
</span><span class='line'>        <span class="k">print</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;,&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test_feature</span><span class="p">)[</span><span class="mi">0</span><span class="p">]))</span>
</span><span class='line'>        <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>このモデルをCross Validationで検証してみる。</p>


<p><figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="k">def</span> <span class="nf">get_score</span><span class="p">(</span><span class="n">clf</span><span class="p">,</span> <span class="n">train_features</span><span class="p">,</span> <span class="n">train_labels</span><span class="p">):</span>
</span><span class='line'>    <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">cross_validation</span><span class="o">.</span><span class="n">train_test_split</span><span class="p">(</span><span class="n">train_features</span><span class="p">,</span> <span class="n">train_labels</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</span><span class='line'>    <span class="k">print</span> <span class="n">clf</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>cross_validation.train_test_splitは一定の割合が検証用データとなるように開発用データを分割する関数。この場合は<code>test_size=0.4</code>を指定したので、40%のデータを検証用として使うことになる。
<code>fit</code>が60%の訓練データで行うもので、scoreが残された40%のデータで検証を行いその正答率を出してくれる。これがこのモデルの、このテストデータにおける正当性となる。もちろんこれが高ければ高いほどよいが
汎化性能が高いかどうかはここからでは読み取ることができない。そのためK分割を行うことでK回の検証を行うことができる。これらのスコアを平均することで汎化性能も含めたモデルの正当性を表すことができる。</p>


<p><figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="k">def</span> <span class="nf">get_accuracy</span><span class="p">(</span><span class="n">clf</span><span class="p">,</span> <span class="n">train_features</span><span class="p">,</span> <span class="n">train_labels</span><span class="p">):</span>
</span><span class='line'>    <span class="n">scores</span> <span class="o">=</span> <span class="n">cross_validation</span><span class="o">.</span><span class="n">cross_val_score</span><span class="p">(</span><span class="n">clf</span><span class="p">,</span> <span class="n">train_features</span><span class="p">,</span> <span class="n">train_labels</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</span><span class='line'>    <span class="k">print</span><span class="p">(</span><span class="s">&quot;Accuracy: </span><span class="si">%0.2f</span><span class="s"> (+/&ndash; </span><span class="si">%0.2f</span><span class="s">)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">scores</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">scores</span><span class="o">.</span><span class="n">std</span><span class="p">()</span> <span class="o">*</span> <span class="mi">2</span><span class="p">))</span>
</span></code></pre></td></tr></table></div></figure></p>

<p><code>cross_validation_cross_val_score</code>でこれらの検証のすべてのscoreを得ることができる。<code>cv</code>はK分割の分割の個数を指定することができる。今回は開発用のデータを10個に分割し10回の検証を行う。
scoresには10個のscoreが入ったリストが返ってくる。これの平均をAccuracyとして出している。これで汎化性能も含めたモデルの正当性を得ることができるが、モデルパラメータのチューニングを手で行う必要がある。
手で調整して、Accuracyを計算するというのは非常に手間なのでGrid Searchというアルゴリズムでこのチューニングをある程度自動化することができる。</p>




<h3>Grid Search</h3>




<p>パラメータの範囲を指定することで経験的に最適なパラメータの組を探索する方法がGrid Search。Pythonで行うには以下のように書く。</p>


<p><figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="k">def</span> <span class="nf">grid_search</span><span class="p">(</span><span class="n">train_features</span><span class="p">,</span> <span class="n">train_labels</span><span class="p">):</span>
</span><span class='line'>    <span class="n">param_grid</span> <span class="o">=</span> <span class="p">[</span>
</span><span class='line'>        <span class="p">{</span><span class="s">&#39;C&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">1000</span><span class="p">],</span> <span class="s">&#39;kernel&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s">&#39;linear&#39;</span><span class="p">]},</span>
</span><span class='line'>        <span class="p">{</span><span class="s">&#39;C&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">1000</span><span class="p">],</span> <span class="s">&#39;gamma&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.001</span><span class="p">,</span> <span class="mf">0.0001</span><span class="p">],</span> <span class="s">&#39;kernel&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s">&#39;rbf&#39;</span><span class="p">]},</span>
</span><span class='line'>    <span class="p">]</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">clf</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">svm</span><span class="o">.</span><span class="n">SVC</span><span class="p">(</span><span class="n">C</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">param_grid</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=&ndash;</span><span class="mi">1</span><span class="p">)</span>
</span><span class='line'>    <span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_features</span><span class="p">,</span> <span class="n">train_labels</span><span class="p">)</span>
</span><span class='line'>    <span class="k">print</span> <span class="n">clf</span><span class="o">.</span><span class="n">best_estimator_</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>param_gridに指定することでこの範囲を指定することができる。n_jobsに並列に計算を行うプロセス数を指定することができる。-1を指定するとコア数をデフォルト選ぶようになっている。与えられた訓練データに対してGrid Searchを行う。
時間は少しかかるが、この訓練データに対して最もスコアが高くなるようなモデルパラメータを選ぶことができる。この訓練データを実際のテストデータに使うことができる。</p>




<h3>まとめ</h3>




<p>PRMLには実際の機械学習のプロセスみたいなものがあまり細かく書かれていないのでKaggleに提出されているコードとかを実際にみて、こういったプロセスが分かるようになってきた。
あとscikit-learnが便利すぎて、機械学習の学習アルゴリズムだけじゃなくて特徴抽出とかモデルパラメータの最適化なども整備されていたことに驚いた。</p>


  </p>
  <span class="meta">
    written 








  



<time datetime="2013-11-09T21:56:00+09:00" pubdate data-updated="true">Nov 9<span>th</span>, 2013</time>
    

in
<span class="categories">
  
    <a class='category' href='/blog/categories/cross-validation/'>Cross Validation</a>, <a class='category' href='/blog/categories/python/'>Python</a>, <a class='category' href='/blog/categories/scikit-learn/'>scikit-learn</a>
  
</span>


  </span>

  
</article>

            </div>
          </div>
        
      </div>
    </div>

    <hr class="divider-short"/>

    <div class="archive-link">
      <h3><a href="/posts/">All Posts</a></h3>
    </div>
  </div>
</div>

    <footer id="footer" class="her-row">
  <div class="container">
    <div class="row">
      <div class="col-md-1">
  <a href="/"><h4>Home</h4></a>
</div>

<div class="col-md-2">
  <div class="social-icon-list">
    
    <a href="https://twitter.com/Lewuathe"><img src="/images/glyphicons_social_31_twitter.png"/></a>
    

    
    <a href="https://github.com/Lewuathe"><img src="/images/glyphicons_social_21_github.png"/></a>
    

    

    
  </div>
</div>

<div class="pull-right">
  <h4>Powered by <a href="http://octopress.org/">Octopress</a>. Designed by <a href="http://AdrianArtiles.com">Adrian Artiles</a>.</h4>
</div>


    </div>
  </div>
</footer>

  </body>
</html>
