
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>The first cry of Atom</title>
  <meta name="author" content="Kai Sasaki">

  
  <meta name="description" content="Open data will change the world, and nations. How do I change my homeland with open data? I find this article today
http://www.soumu.go.jp/menu_news/ &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta property="og:title" content=" - The first cry of Atom" >
<meta property="og:description" content="Open data will change the world, and nations. How do I change my homeland with open data? I find this article today
http://www.soumu.go.jp/menu_news/ &hellip;" />
<meta property="og:url" content="http://lewuathe.com" />
<meta property="og:image" content="http://lewuathe.github.io/images/site_image.png" />
<meta property="og:author" content="lewuathe" />
<meta property="og:site_name" content="The first cry of Atom" />
<meta property="og:locale" content="ja_JP" />
<meta property="og:type" content="blog" />
<meta property="fb:app_id" content="212934732101925" />


  
  <link rel="canonical" href="http://lewuathe.github.io/blog/page/4">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="The first cry of Atom" type="application/atom+xml">
  <link href="/stylesheets/data-table.css" rel="stylesheet" type="text/css" />
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-44055098-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">The first cry of Atom</a></h1>
  
    <h2>The people who are crazy enough to think thay can change the world, are the ones who do</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:lewuathe.github.io" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/about.html">About</a></li>
  <li><a href="/blog/archives">Archives</a></li>
  <li><a href="http://fotologue.jp/lewuathe">Pictures</a></li>
  <li><a href="https://github.com/Lewuathe">GitHub</a></li>
  <li><a href="https://twitter.com/Lewuathe">Twitter</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/12/01/how-do-i-change-my-homeland-with-open-data/">How Do I Change My Homeland With Open Data?</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-12-01T19:09:00+09:00" pubdate data-updated="true">Dec 1<span>st</span>, 2013</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Open data will change the world, and nations. How do I change my homeland with open data?</p>

<p>I find this article today
<a href="http://www.soumu.go.jp/menu_news/s-news/01ryutsu02_02000081.html">http://www.soumu.go.jp/menu_news/s-news/01ryutsu02_02000081.html</a></p>

<p>This is the software application contest using open data given by Ministry of Internal Affairs and Communications. I am interested in this content from two view points.</p>

<p>First, as a software developer, I am interested technologies used for mobile applications such as iOS or Android. For my engineer career and satisfying my interest, I want develop mobile applications this time.</p>

<p>Second, I want to develop an application which is able to answer social problems such as economic gap, social security, low birthrate and longevity. Open data enables us to develop such applications easily. I think all software should be developed and used for making our society good place. Solving all problems is real hacker mind. With open data, I want to make our homeland better place.</p>

<p>Given data listed below.</p>

<ol>
<li>Administration data stored local authorities.</li>
<li>Usability and cost of social capital</li>
<li>Information for travellers</li>
<li>Disaster prevention data</li>
<li>Information of transportation system</li>
<li>A large variety of statistics data</li>
</ol>


<p>I cannot understand what these data is completely. This contest deadline is February, 2014. There is not much time for me, but enough.</p>

<h2>My open data library.</h2>

<p>Already I have developed a library for iOS.</p>

<p><a href="https://github.com/Lewuathe/LEStatsRequest">https://github.com/Lewuathe/LEStatsRequest</a></p>

<p>LEStatsRequest is the API client of statistics of Japan government. This library contributes open data movement in Japan. You can obtain official data with this client espacially in iOS device. iOS device is restricted memory capacity, so this library parses response XML and make useful objects. With this library, you can use Japan open data easily. If you have some interest in open data, please check it.</p>

<p>In the future, open data surely changes our life. Our involvement with government and society will require our more positiveness. I think this is good thing for current closed our society.</p>

<p>I want to make the use of my ability for our society.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/11/28/my-first-jenkins-plugin/">My First Jenkins Plugin</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-11-28T21:15:00+09:00" pubdate data-updated="true">Nov 28<span>th</span>, 2013</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Released my first Jenkins plugin</p>

<p><a href="https://github.com/jenkinsci/hckrnews-plugin">https://github.com/jenkinsci/hckrnews-plugin</a></p>

<p><img src="/images/posts/2013-11-28-hckrnews-plugin/screen-shot.png" alt="Screen shot" /></p>

<p>With this plugin, you can read hacker news top time line sitting in front of CI server.
So you can read top topics about technology and so on at the same time building your project. Does it sound good?</p>

<h2>How to publish Jenkins plugin?</h2>

<h3>Make GitHub repository</h3>

<p>Normal Maven project needs only src/ and pom.xml. Jenkins plugin project is not exception.
Write right .gitignore, and ignore target/ and work/ directory. These are not necessary.</p>

<h3>Create new jenkins-ci account</h3>

<p>Visit <a href="https://jenkins-ci.org/account/">here</a>. Create your new account.</p>

<h3>Write settings.xml your account information</h3>

<p>Your account name, and password got from above process should be written in <code>~/.m2/settings.xml</code> like below.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;settings&gt;
</span><span class='line'> ・・・
</span><span class='line'>  &lt;servers&gt;
</span><span class='line'>    &lt;server&gt;
</span><span class='line'>      &lt;id&gt;maven.jenkins-ci.org&lt;/id&gt;
</span><span class='line'>      &lt;username&gt;XXXXXX&lt;/username&gt;
</span><span class='line'>      &lt;password&gt;XXXXXX&lt;/password&gt;
</span><span class='line'>    &lt;/server&gt;
</span><span class='line'>  &lt;/servers&gt;
</span><span class='line'>  ・・・
</span><span class='line'>&lt;/settings&gt;</span></code></pre></td></tr></table></div></figure>


<h3>Application for forking repository</h3>

<p>Send an email to community <a href="https://groups.google.com/forum/#!forum/jenkinsci-ja">mailing list</a> in Japan. If you want to send other community, search <a href="http://jenkins-ci.org/content/mailing-lists">here</a>
Soon your repository is forked to original jenkinsci organization.</p>

<h3>Modify pom.xml</h3>

<p>Add some line. SCM repository url should be written in your project <code>pom.xml</code></p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;scm&gt;
</span><span class='line'>    &lt;connection&gt;scm:git:ssh://github.com/jenkinsci/XXXXXXXX.git&lt;/connection&gt;
</span><span class='line'>    &lt;developerConnection&gt;scm:git:ssh://git@github.com/jenkinsci/XXXXXXXX.git&lt;/developerConnection&gt;
</span><span class='line'>    &lt;url&gt;https://github.com/jenkinsci/XXXXXXXX.git&lt;/url&gt;
</span><span class='line'>&lt;/scm&gt;</span></code></pre></td></tr></table></div></figure>


<h3>Release!</h3>

<p>Type below command.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ mvn release:prepare release:perform</span></code></pre></td></tr></table></div></figure>


<p>One this your should pay attention to is not to add <code>-Dusername</code> and <code>-Dpassword</code> options. These are not used for GitHub but jenkinsci.org
Congratulations!!</p>

<h3>Future</h3>

<p>In fact, I make this plugin with no experience of writing Java, of course maven.
Therefore I have to study these tool and Java grammar. In addition to this, I learned how to write some design patterns with coding in accordance with OO programming.</p>

<p>I also wrote some test codes with JUnit in maven. TDD is the method with which I want to develop. In this time, first I wrote unit test code and second logic code. This is fun for me because my code&rsquo;s quality seems to be kept easily. I want to keep writing test code first. This is the best practice for my developing.</p>

<p>This plugin has only simple functions, however, this experience is sufficient value as software engineer.
In the future, I will seize the moment and make more my own plugins.</p>

<p>Ultimately, please use this plugin. It brings to you a new continuous integration life.</p>

<p>Thank you.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/11/22/maifalseriteiripoto/">マイノリティ・リポート</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-11-22T11:13:00+09:00" pubdate data-updated="true">Nov 22<span>nd</span>, 2013</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>この夏にあったことだ。</p>

<p><img src="/images/posts/2013-11-22-minority/tie.jpg" alt="tie" /></p>

<p>一般的に社会人が半ズボンを履いて会社へ行くことは「正しくない」ことだと考えられている。
でもこの夏はとっても暑かったので、半ズボンがどれだけ許されるのか知りたいということもありいろいろなズボンで会社に行ってみた。
長ズボン、七分丈、膝の見える短パン。長さや柄を混ぜこぜにして出勤してみた。</p>

<p>そうしたところ、柄やメーカーにかかわらず膝が見えると「それ、(会社に履いてくるの)大丈夫？」と聞いてくる人がいることがわかった。
なるほど、膝が見えるとダメらしい。というわけでいちいちめんどくさいので夏の後半はどんなに暑くても七分丈にすることにした。</p>

<h2>「正しい」と「正しくない」</h2>

<p>ところでどうして、短パンは「正しくない」と判断されて、長ズボンは「正しい」と判断されるんだろうか。
どうして、規則に「反している」、「反していない」と言われないんだろうか。あるいは規則がどうして「正しい」と判断されるんだろうか。
社会人としてスーツを着てくることが「正しい」と考える人は多いと思う。でもどうしてそれを「多くの人がやっているから」とか、「規則で決まっているから」
とか言わないんだろう。どうして「正しい」という価値が入ってしまうんだろう。</p>

<p>もし僕が社会人としてスーツは「正しくない」じゃないと言ったらどうなんだろう。</p>

<p>「そんな風に思うやつはお前だけだ」と言われるかもしれない。
だとしたら、スーツを着る理由は「正しい」からではなく、「大勢がそうしている」からだ。</p>

<p>「昔からそうだったんだ」と言われるかもしれない。
だとしたら、スーツを着る理由は「正しい」からではなく、「昔からそうしている」からだ。</p>

<p>「スーツには社会人として必要な機能が備わっているからだ」と言われるかもしれない。
だとしたら、スーツを着る理由は「正しい」からではなく、「社会人として必要な機能が備わっている」からだ。</p>

<p>僕が言いたいのは「正しい」、「正しくない」という価値判断をむやみに加えて論理的な理由付けをうやむやにしてしまうのは良くないことだと思うということ。</p>

<p>「正しい」、「正しくない」は人によって違う。
でもポケットがいっぱいあって便利というのはだれにとってもほぼ同じ感覚だ。</p>

<p>何か規則を決めたり、考えを広めるときに「正しい」というラベルをはらないとそれを広めることが難しいと感じることがある。
だから人はむやみにこれは「正しい」、あれは「正しくない」ということを必ず言ってしまうのだと思う。</p>

<p>別にいいと思う。「正しさ」なんて大義名分をはらなくても、理屈が通っていれば。
「便利だから」、「暖かいから」、「毎日着る洋服に迷うことがないから」、「どんなお店にも入れるから」。
それでいいじゃないか。</p>

<h2>桃太郎がいなければ鬼もいない</h2>

<p>結果として一緒じゃないかと思うかもしれない。理屈が通っていようが通っていまいが、お前がスーツを着ろと言われることは同じじゃないかと。
でも全然違うんだ。正義の味方は悪の秘密結社を必要とする。</p>

<p>アンパンマンはバイキンマンが必要だし名探偵コナンは殺人犯が必要だ。桃太郎では鬼がいなければ話ははじまらないし、ショッカー軍団がいなければ仮面ライダーは何もしないだろう。</p>

<p>「正しい」意見は必ず「正しくない」意見を必要とする。</p>

<p>彼らのせいで必ず悪者が作られる。確かに「作られる」。
本当は正義の反対側はもうひとつの正義にすぎない。「正しい」といった瞬間に「正しくない」意見ができる。そして、「正しくない」意見を排除しようとする。
本当はもうひとつの「正しさ」であるはずの意見が排除される理由になってしまう。</p>

<p>「暖かい洋服だから」という意見に「寒い洋服でいい」という意見が間違っているとも劣っているとも思わない。</p>

<p>ただ「正しいから」と言ってしまうと「正しくないものでいい」というのはなんだかおかしい。本人は正しくなくていいと思っているのかもしれないが、僕は言ってあげたい。</p>

<p>「君の意見も同じように正しいんだ」と。</p>

<p>だから決して「正しい」意見というものを言わないで欲しい。半ズボンを履くのも「不快に感じる人がいるから」とか、「風邪をひきやすいから」とかそう言って欲しい。
決してそれらが「正しい」わけではないけれど。</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/11/16/developing-jenkins-plugin-on-vagrant/">Developing Jenkins Plugin on Vagrant</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-11-16T21:09:00+09:00" pubdate data-updated="true">Nov 16<span>th</span>, 2013</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Recently I investigate the scalability of Jenkins. In my idea, I want to make hot standby Jenkins server with NFS. So the plugins which enable us to do that are required. And for my study, I decided to develop on Vagrant and VirtualBox. It costs me very little because there is no need to get real server.  So in this post, I will describe how to set up your jenkins plugin environment on your vagrant Ubuntu.</p>

<h2>Start vagrant</h2>

<p>My <code>Vagrantfile</code> is below. Before this, you should download precise64 box on vagrant <a href="http://www.vagrantbox.es/">site</a></p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># -*- mode: ruby -*-
</span><span class='line'># vi: set ft=ruby :
</span><span class='line'>
</span><span class='line'>Vagrant.configure("2") do |config|
</span><span class='line'>  # Every Vagrant virtual environment requires a box to build off of.
</span><span class='line'>  config.vm.box = "ubuntu"
</span><span class='line'>
</span><span class='line'>  # Create a forwarded port mapping which allows access to a specific port
</span><span class='line'>  # within the machine from a port on the host machine. In the example below,
</span><span class='line'>  # accessing "localhost:8080" will access port 80 on the guest machine.
</span><span class='line'>  config.vm.network :forwarded_port, guest: 8080, host: 8080
</span><span class='line'>
</span><span class='line'> end</span></code></pre></td></tr></table></div></figure>


<p>Jenkins plugin server starts on port 8080. So you need to write guest port 8080. Host port can be written any number.
And start vagrant.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ vagrant up</span></code></pre></td></tr></table></div></figure>


<h2>Set up maven3</h2>

<p>Jenkins plugins are build with Maven. In this time, Maven3 can build sample plugin easily, so I recommend that you download maven3.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ sudo apt-get install maven</span></code></pre></td></tr></table></div></figure>


<h2>Write settings.xml</h2>

<p>Write settings.xml as below.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;settings&gt;
</span><span class='line'>  &lt;pluginGroups&gt;
</span><span class='line'>    &lt;pluginGroup&gt;org.jenkins-ci.tools&lt;/pluginGroup&gt;
</span><span class='line'>  &lt;/pluginGroups&gt;
</span><span class='line'>
</span><span class='line'>  &lt;profiles&gt;
</span><span class='line'>    &lt;!-- Give access to Jenkins plugins --&gt;
</span><span class='line'>    &lt;profile&gt;
</span><span class='line'>      &lt;id&gt;jenkins&lt;/id&gt;
</span><span class='line'>      &lt;activation&gt;
</span><span class='line'>        &lt;activeByDefault&gt;true&lt;/activeByDefault&gt; &lt;!-- change this to false, if you don't like to have it on per default --&gt;
</span><span class='line'>      &lt;/activation&gt;
</span><span class='line'>      &lt;repositories&gt;
</span><span class='line'>        &lt;repository&gt;
</span><span class='line'>          &lt;id&gt;repo.jenkins-ci.org&lt;/id&gt;
</span><span class='line'>          &lt;url&gt;http://repo.jenkins-ci.org/public/&lt;/url&gt;
</span><span class='line'>        &lt;/repository&gt;
</span><span class='line'>      &lt;/repositories&gt;
</span><span class='line'>      &lt;pluginRepositories&gt;
</span><span class='line'>        &lt;pluginRepository&gt;
</span><span class='line'>          &lt;id&gt;repo.jenkins-ci.org&lt;/id&gt;
</span><span class='line'>          &lt;url&gt;http://repo.jenkins-ci.org/public/&lt;/url&gt;
</span><span class='line'>        &lt;/pluginRepository&gt;
</span><span class='line'>      &lt;/pluginRepositories&gt;
</span><span class='line'>    &lt;/profile&gt;
</span><span class='line'>  &lt;/profiles&gt;
</span><span class='line'>  &lt;mirrors&gt;
</span><span class='line'>    &lt;mirror&gt;
</span><span class='line'>      &lt;id&gt;repo.jenkins-ci.org&lt;/id&gt;
</span><span class='line'>      &lt;url&gt;http://repo.jenkins-ci.org/public/&lt;/url&gt;
</span><span class='line'>      &lt;mirrorOf&gt;m.g.o-public&lt;/mirrorOf&gt;
</span><span class='line'>    &lt;/mirror&gt;
</span><span class='line'>  &lt;/mirrors&gt;
</span><span class='line'>&lt;/settings&gt;</span></code></pre></td></tr></table></div></figure>


<h2>JDK!!</h2>

<p>I failed to create my plugin in this time bacause of lack of JDK. Ubuntu 12.04 LTS doesn&rsquo;t have JDK in own image. You have to install it.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ sudo apt-get install default-jdk</span></code></pre></td></tr></table></div></figure>


<h2>Build plugin</h2>

<p>Building plugin with maven command.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ mvn install</span></code></pre></td></tr></table></div></figure>


<p>And demonstrate your plugin.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ mvn hpi:run</span></code></pre></td></tr></table></div></figure>


<p>You can see Jenkins web UI on <a href="http://localhost:8080/jenkins">http://localhost:8080/jenkins</a> unless maven command has not exit.
So now, I can get multi Jenkins server for mutual mount on NFS. My Jenkins study has been continued.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/11/10/nu-li-falseli-you/">頑張る理由</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-11-10T15:12:00+09:00" pubdate data-updated="true">Nov 10<span>th</span>, 2013</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>読んだ。</p>

<p><a href="http://karigari.hatenablog.com/entry/2013/11/06/000000">http://karigari.hatenablog.com/entry/2013/11/06/000000</a></p>

<p>全く自分にとって新しいことでなくても、文字に起こされると驚くことがある。概念は知っていても言葉は知らない、そんな感じだ。自分が何か努力したり頑張ったり、そういったことを何のためにしているか。</p>

<p>答えは「自分のため」いつもそう答えていた。その答えは今でも変わらないけれど、その概念のエイリアスがあるとしたら、「やった事実はなくならないから」じゃないだろうか。</p>

<p>僕自身は今まで努力してきたことが報われることもあったし、報われないこともあった。努力でなんでも叶えられるとも思わないけれど、努力してやってやれないこともないんじゃないかと漠然と感じている。
だから僕はやりたいことがあったら努力したらいいんじゃないかと思う派だ（派閥があるとすればだけど）それが叶うとか叶わないとかあんまり関係なく頑張ってみればいいんじゃないかと体が知っているからだ。</p>

<p>でもだからそれを言葉にできない。もちろん言葉にできないから答えを知らないんだけれど、「やった事実はなくならない」という言葉はその答えなんじゃないかと感じた。</p>

<h3>やった事実はなくならない</h3>

<p>今までも頑張ってきていろんな結果が出てきたけれど、確かにやったことはなくなってないよなーって思う。受験勉強で覚えたこととか大体忘れたし、学生の時水泳もやっていたけれど、もうお腹だけぽっこり出始めてきたし運動してない。
それでもなくなってないよって思う。やっぱり体がそれを知っている。人間の体って1年の間にほぼ入れ替わるらしいからそれを知っていた体もほぼほぼなくなっているんだけど、それでもなくなってないよな。</p>

<p>多分、努力することの大切さを知っている人はこのことが分かっているんだと思う。夢は必ず叶うとか、諦めずにいればなんとかなるとか。本当はそういうことじゃなくてただ、「なくならないよ」って言いたいんだと思う。
結果はどうあれなくならない。それが失敗でも成功でも誰かに横取りされても盗まれても。自分が頑張った事実はなくならない。</p>

<p>そのなくならなかったものが役に立つとか全くわからない。けれどもなくならなかったものが体の中に幾つかあるっていうのはとても気持ちのいいものだ。なんて言うんだろう。体の中に金庫がある感じ。でも鍵は持ってない。
その中にいろいろ大事なものが入っているんだけれど自分にも開け方がわからなくてそれが使うこともできない。でも中に大事な何かが入っていることはわかって、頑張ったり努力したりするといつの間にかそこにものが入っていくことも
知っている。そういう感覚。</p>

<p>努力した結果はどうだか知らないけれど、努力した事実はなくならないことはわかってる。</p>

<p>多分そのことも努力した結果なくならなかった&#8221;事実&#8221;だと思う。</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/11/09/scikit-learndecross-validation/">scikit-learnでCross Validation</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-11-09T21:56:00+09:00" pubdate data-updated="true">Nov 9<span>th</span>, 2013</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>だんだんとscikit-learnとMachine Learningに慣れてきた。
今回はCross ValidationとGrid Searchをやってみた。</p>

<h3>Cross Validation</h3>

<p>詳しいことは<a href="http://ja.wikipedia.org/wiki/%E4%BA%A4%E5%B7%AE%E6%A4%9C%E5%AE%9A">Wikipedia</a>に書いてある。
Cross Validationはモデルの妥当性を検証する方法のひとつ。一般的に開発用のデータは訓練データと検証データに分かれる。
しかし、このまま行ってしまうと折角の訓練データが減ってしまうことになる上に、訓練データの選び方によって汎化性能が下がってしまう可能性がある。
Wikipediaに書いてあるもののホールド・アウト検定がこれに当たる。一般にはこれはCross Validationにはあたらない。</p>

<p>ここに書いてあるK-分割交差検定がこれに当たる。K-分割交差検定では開発用のデータをK個に分割しK-1個を訓練用に、残りの一つを検証用に使いモデルの正当性を計算する。
これにより使える訓練データが増えると同時に、これらを訓練データを変えることにより、汎化性能を上げることができる。</p>

<p>scikit-learnで具体的にどのように行うのか書いてみた。訓練に使ったデータとしてはKaggleの<a href="http://www.kaggle.com/c/data-science-london-scikit-learn">Data Science London</a>で出されているものを用いた。</p>

<h3>SVM</h3>

<p>まずは単純にサポートベクターマシンでクラス分けをさせた時のコード</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="c"># -*- coding: utf-8 -*-</span>
</span><span class='line'>
</span><span class='line'><span class="kn">import</span> <span class="nn">os</span>
</span><span class='line'><span class="kn">import</span> <span class="nn">sys</span>
</span><span class='line'><span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">svm</span>
</span><span class='line'><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
</span><span class='line'><span class="kn">import</span> <span class="nn">csv</span>
</span><span class='line'>
</span><span class='line'><span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&quot;__main__&quot;</span><span class="p">:</span>
</span><span class='line'>    <span class="n">train_feature_file</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">genfromtxt</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="s">&quot;../data/train.csv&quot;</span><span class="p">,</span> <span class="s">&quot;rb&quot;</span><span class="p">),</span> <span class="n">delimiter</span><span class="o">=</span><span class="s">&quot;,&quot;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
</span><span class='line'>    <span class="n">train_label_file</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">genfromtxt</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="s">&quot;../data/trainLabels.csv&quot;</span><span class="p">,</span> <span class="s">&quot;rb&quot;</span><span class="p">),</span> <span class="n">delimiter</span><span class="o">=</span><span class="s">&quot;,&quot;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">train_features</span> <span class="o">=</span> <span class="p">[]</span>
</span><span class='line'>    <span class="n">train_labels</span> <span class="o">=</span> <span class="p">[]</span>
</span><span class='line'>    <span class="k">for</span> <span class="n">train_feature</span><span class="p">,</span> <span class="n">train_label</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">train_feature_file</span><span class="p">,</span> <span class="n">train_label_file</span><span class="p">):</span>
</span><span class='line'>        <span class="n">train_features</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">train_feature</span><span class="p">)</span>
</span><span class='line'>        <span class="n">train_labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">train_label</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">train_features</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">train_features</span><span class="p">)</span>
</span><span class='line'>    <span class="n">train_labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">train_labels</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">clf</span> <span class="o">=</span> <span class="n">svm</span><span class="o">.</span><span class="n">SVC</span><span class="p">(</span><span class="n">C</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">cache_size</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">class_weight</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">coef0</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">degree</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">gamma</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">kernel</span><span class="o">=</span><span class="s">&quot;rbf&quot;</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">probability</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span><span class="n">random_state</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">shrinking</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_features</span><span class="p">,</span> <span class="n">train_labels</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">test_feature_file</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">genfromtxt</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="s">&quot;../data/test.csv&quot;</span><span class="p">,</span> <span class="s">&quot;rb&quot;</span><span class="p">),</span> <span class="n">delimiter</span><span class="o">=</span><span class="s">&quot;,&quot;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">test_features</span> <span class="o">=</span> <span class="p">[]</span>
</span><span class='line'>    <span class="k">print</span> <span class="s">&quot;Id,Solution&quot;</span>
</span><span class='line'>    <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span>
</span><span class='line'>    <span class="k">for</span> <span class="n">test_feature</span> <span class="ow">in</span> <span class="n">test_feature_file</span><span class="p">:</span>
</span><span class='line'>        <span class="k">print</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;,&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test_feature</span><span class="p">)[</span><span class="mi">0</span><span class="p">]))</span>
</span><span class='line'>        <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
</span></code></pre></td></tr></table></div></figure>


<p>このモデルをCross Validationで検証してみる。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="k">def</span> <span class="nf">get_score</span><span class="p">(</span><span class="n">clf</span><span class="p">,</span> <span class="n">train_features</span><span class="p">,</span> <span class="n">train_labels</span><span class="p">):</span>
</span><span class='line'>    <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">cross_validation</span><span class="o">.</span><span class="n">train_test_split</span><span class="p">(</span><span class="n">train_features</span><span class="p">,</span> <span class="n">train_labels</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</span><span class='line'>    <span class="k">print</span> <span class="n">clf</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>cross_validation.train_test_splitは一定の割合が検証用データとなるように開発用データを分割する関数。この場合は<code>test_size=0.4</code>を指定したので、40%のデータを検証用として使うことになる。
<code>fit</code>が60%の訓練データで行うもので、scoreが残された40%のデータで検証を行いその正答率を出してくれる。これがこのモデルの、このテストデータにおける正当性となる。もちろんこれが高ければ高いほどよいが
汎化性能が高いかどうかはここからでは読み取ることができない。そのためK分割を行うことでK回の検証を行うことができる。これらのスコアを平均することで汎化性能も含めたモデルの正当性を表すことができる。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="k">def</span> <span class="nf">get_accuracy</span><span class="p">(</span><span class="n">clf</span><span class="p">,</span> <span class="n">train_features</span><span class="p">,</span> <span class="n">train_labels</span><span class="p">):</span>
</span><span class='line'>    <span class="n">scores</span> <span class="o">=</span> <span class="n">cross_validation</span><span class="o">.</span><span class="n">cross_val_score</span><span class="p">(</span><span class="n">clf</span><span class="p">,</span> <span class="n">train_features</span><span class="p">,</span> <span class="n">train_labels</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</span><span class='line'>    <span class="k">print</span><span class="p">(</span><span class="s">&quot;Accuracy: </span><span class="si">%0.2f</span><span class="s"> (+/- </span><span class="si">%0.2f</span><span class="s">)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">scores</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">scores</span><span class="o">.</span><span class="n">std</span><span class="p">()</span> <span class="o">*</span> <span class="mi">2</span><span class="p">))</span>
</span></code></pre></td></tr></table></div></figure>


<p><code>cross_validation_cross_val_score</code>でこれらの検証のすべてのscoreを得ることができる。<code>cv</code>はK分割の分割の個数を指定することができる。今回は開発用のデータを10個に分割し10回の検証を行う。
scoresには10個のscoreが入ったリストが返ってくる。これの平均をAccuracyとして出している。これで汎化性能も含めたモデルの正当性を得ることができるが、モデルパラメータのチューニングを手で行う必要がある。
手で調整して、Accuracyを計算するというのは非常に手間なのでGrid Searchというアルゴリズムでこのチューニングをある程度自動化することができる。</p>

<h3>Grid Search</h3>

<p>パラメータの範囲を指定することで経験的に最適なパラメータの組を探索する方法がGrid Search。Pythonで行うには以下のように書く。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="k">def</span> <span class="nf">grid_search</span><span class="p">(</span><span class="n">train_features</span><span class="p">,</span> <span class="n">train_labels</span><span class="p">):</span>
</span><span class='line'>    <span class="n">param_grid</span> <span class="o">=</span> <span class="p">[</span>
</span><span class='line'>        <span class="p">{</span><span class="s">&#39;C&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">1000</span><span class="p">],</span> <span class="s">&#39;kernel&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s">&#39;linear&#39;</span><span class="p">]},</span>
</span><span class='line'>        <span class="p">{</span><span class="s">&#39;C&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">1000</span><span class="p">],</span> <span class="s">&#39;gamma&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.001</span><span class="p">,</span> <span class="mf">0.0001</span><span class="p">],</span> <span class="s">&#39;kernel&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s">&#39;rbf&#39;</span><span class="p">]},</span>
</span><span class='line'>    <span class="p">]</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">clf</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">svm</span><span class="o">.</span><span class="n">SVC</span><span class="p">(</span><span class="n">C</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">param_grid</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
</span><span class='line'>    <span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_features</span><span class="p">,</span> <span class="n">train_labels</span><span class="p">)</span>
</span><span class='line'>    <span class="k">print</span> <span class="n">clf</span><span class="o">.</span><span class="n">best_estimator_</span>
</span></code></pre></td></tr></table></div></figure>


<p>param_gridに指定することでこの範囲を指定することができる。n_jobsに並列に計算を行うプロセス数を指定することができる。-1を指定するとコア数をデフォルト選ぶようになっている。与えられた訓練データに対してGrid Searchを行う。
時間は少しかかるが、この訓練データに対して最もスコアが高くなるようなモデルパラメータを選ぶことができる。この訓練データを実際のテストデータに使うことができる。</p>

<h3>まとめ</h3>

<p>PRMLには実際の機械学習のプロセスみたいなものがあまり細かく書かれていないのでKaggleに提出されているコードとかを実際にみて、こういったプロセスが分かるようになってきた。
あとscikit-learnが便利すぎて、機械学習の学習アルゴリズムだけじゃなくて特徴抽出とかモデルパラメータの最適化なども整備されていたことに驚いた。</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/11/03/tf-idfdetagufu-ke/">TF-IDFでタグ付け</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-11-03T22:28:00+09:00" pubdate data-updated="true">Nov 3<span>rd</span>, 2013</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Kaggleで挑戦できそうな問題があったのでチャレンジしてみた。</p>

<p><a href="http://www.kaggle.com/c/facebook-recruiting-iii-keyword-extraction">http://www.kaggle.com/c/facebook-recruiting-iii-keyword-extraction</a></p>

<p>Stack Exchange(Stack Overflowみたいなもの)にあるテキストとそのタグデータを訓練データとして
同様にStack Exchangeにあるページからタグを類推せよという問題。
多分キーワード抽出を行う方法がうまく行くんじゃないかと思いやってみた。</p>

<h2>TF-IDFアルゴリズム</h2>

<p><img src="/images/posts/2013-11-03-tfidf/equation.png" alt="Equation" /></p>

<p>基本的にはTF-IDFを使ってみる。これは文書中のtokenの重要度をその頻度と、他の文書にどれくらいないかの指標
の積として表すアルゴリズム。コードで書くと下のような感じ。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
</span><span class='line'><span class="n">term</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">Target</span> <span class="n">Term</span><span class="o">&gt;</span>
</span><span class='line'><span class="n">include_document_num</span> <span class="o">=</span> <span class="nb">len</span><span class="p">([</span><span class="n">d</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">all_documents</span> <span class="k">if</span> <span class="n">term</span> <span class="ow">in</span> <span class="n">d</span><span class="p">])</span>
</span><span class='line'><span class="n">word_score</span> <span class="o">=</span> <span class="n">term_frequency</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span> <span class="n">all_document_num</span> <span class="o">/</span> <span class="n">include_document_num</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>term_frquencyはその文書中にどれくらいその単語が出てきたか。多くの場合は正規化してある。
その後ろの項は全文書中にその単語を含む文書がどれくらいあるかの比の逆数。これは他の文書にその単語がなければないほど大きくなるので、その単語がその文書のキーワードとして十分に機能することを示唆している。
TF-IDFのTFはTerm FrequencyでIDFはInversed Document Frequencyの略だ。</p>

<p>今回はTestデータの各文書の単語として有効な単語(htmlタグや各種記法は省くようにした)についてword_scoreを計算し、その中から正規化されたscoreが10%を超えたものをその文書のキーワードとして抽出するようにしてみた。
プログラムのコアの部分は以下のような形になった。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="c"># 全テストデータ</span>
</span><span class='line'><span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">test_file</span><span class="p">:</span>
</span><span class='line'>    <span class="c"># テストデータとしてタイトルもあるのでこいつも利用してみる</span>
</span><span class='line'>    <span class="n">title_tokens</span> <span class="o">=</span> <span class="n">nltk</span><span class="o">.</span><span class="n">word_tokenize</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span class='line'>
</span><span class='line'>  <span class="c"># 英数字意外の文字を取り除いた</span>
</span><span class='line'>    <span class="n">tokens</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">r&quot;\W+&quot;</span><span class="p">,</span> <span class="n">nltk</span><span class="o">.</span><span class="n">clean_html</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
</span><span class='line'>
</span><span class='line'>  <span class="c"># ここは自分でかってに付け足した部分。タイトルに含まれる単語達は特別扱いして10個余分に足しておく</span>
</span><span class='line'>  <span class="c"># 本当はここは文書中の何%とかにした方が各文書でのタイトルの重要度にばらつきがでなくていいのかもしれない</span>
</span><span class='line'>    <span class="k">for</span> <span class="n">title_token</span> <span class="ow">in</span> <span class="n">title_tokens</span><span class="p">:</span>
</span><span class='line'>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">):</span>
</span><span class='line'>            <span class="n">tokens</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">title_token</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>  <span class="c"># 同じ単語のscoreを計算しても意味ないので重複を消しておく</span>
</span><span class='line'>    <span class="n">uniqTokens</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">tokens</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>  <span class="c"># 各tokenのscoreを計算。実際の計算はNLTKに任せた</span>
</span><span class='line'>    <span class="n">tf_idf_scores</span> <span class="o">=</span> <span class="p">{}</span>
</span><span class='line'>    <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">uniqTokens</span><span class="p">:</span>
</span><span class='line'>        <span class="n">tf_idf_scores</span><span class="p">[</span><span class="n">token</span><span class="p">]</span> <span class="o">=</span> <span class="n">collection</span><span class="o">.</span><span class="n">tf_idf</span><span class="p">(</span><span class="n">token</span><span class="p">,</span> <span class="n">tokens</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>  <span class="c"># scoreでソート</span>
</span><span class='line'>    <span class="n">sorted_tf_idf_scores</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">tf_idf_scores</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span class='line'>
</span><span class='line'>  <span class="c"># 10%を超えたものをkeywordsとして登録</span>
</span><span class='line'>    <span class="n">keywords</span> <span class="o">=</span> <span class="p">[</span> <span class="n">k</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">sorted_tf_idf_scores</span> <span class="k">if</span> <span class="n">v</span> <span class="o">&gt;</span> <span class="mf">0.1</span><span class="p">]</span>
</span><span class='line'>  <span class="c"># 1個もないのは変なので1番scoreが高いものだけでも抽出しておく</span>
</span><span class='line'>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">keywords</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
</span><span class='line'>        <span class="n">keywords</span> <span class="o">=</span> <span class="p">[</span> <span class="n">sorted_tf_idf_scores</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="p">]</span>
</span><span class='line'>
</span><span class='line'>  <span class="c"># ファイル出力</span>
</span><span class='line'>    <span class="n">result_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;</span><span class="si">%s</span><span class="s">,</span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;\n</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">keywords</span><span class="p">)))</span>
</span></code></pre></td></tr></table></div></figure>


<p>訓練データがあまりにもデカイので、ちょっと全部は訓練できない。
一部の訓練データに対して試してみて余分はかなり出てくるけれど、抜けは割りとない。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="err">推定キーワード</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span><span class="s">&quot;an without type file image check uploaded mime&quot;</span>
</span><span class='line'><span class="err">正解キーワード</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span><span class="s">&quot;php image-processing file-upload upload mime-types&quot;</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="err">推定キーワード</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span><span class="s">&quot;How ctrl press prevent firefox closing&quot;</span>
</span><span class='line'><span class="err">正解キーワード</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span><span class="s">&quot;firefox&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<p>image-processingとか、そもそもそういう単語を文書に含んでなかったらこの方法だと抽出できない。もっと関係抽出とか固有表現認識とかしないといけないかも。あとタイトルの重みを強くし過ぎたせいか&#8221;How&#8221;とか&#8221;Can&#8221;とかの単語も結構入ってきてしまう。Stack ExchangeとかStack Overflowって自分が書くときを考えてみてもそうだけど、単純に疑問文書くことも多いから単純にタイトルにキーワードが含まれているだろうという考えは甘いかも。</p>

<p>もう少しチューニングしてみる。あと訓練データが600万件近くあるのでできるだけたくさん利用できるように工夫したい。
(マシンスペックと時間を考えても100万件が今の限界・・・)</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/10/25/osswoshi-u%2C-zuo-ru/">OSSを使う、作る</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-10-25T21:53:00+09:00" pubdate data-updated="true">Oct 25<span>th</span>, 2013</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>昨日、以前作ったOSSのライブラリにpatchが送られてきた。</p>

<p><a href="https://github.com/Lewuathe/passport-yj">https://github.com/Lewuathe/passport-yj</a></p>

<p><img src="/images/posts/2013-10-25-oss/code.png" alt="passport-yj" /></p>

<p>友人とかなり昔に作ったので、存在を忘れていたとまではいかないがpatchが送られてきたときは驚いた。何したらいいんだろうという感じだった。
patchの内容はpassport-yjの依存しているpassportモジュールの仕様が変わったから対応したらーということで送ってくれた。</p>

<p>僕は正直passportの仕様をキャッチアップできていなかったので、こうやってpatchが送られてきて嬉しかった。</p>

<p>自分たちが作ったソフトウェアがよりよくなるということ、そして何よりどこかの誰かが使ってくれているということが目で見える形で分かったからだ。</p>

<p>patchを送ってくれた人は少なくとも日本人ではあるみたいだけれど僕とは縁もゆかりもない人だ。(もっとも顔写真もなにもないので、縁もゆかりも本当にないのかもよくわからない)
そんな人がどこかでこのライブラリを使って、改善点があったのでpatchを送ってくれた。送られたpatchを落としてきてテストして動作を確認する。僕自身も今までに大きなプロジェクト、小さなプロジェクトにちょこちょこpatchを送っていた。そこでディスカッションをしたり、取り込んでもらえたりもらえなかったり。そのコードはそういう意味で書いてあるのかと疑問が氷解したり。</p>

<p>そして気づいた。ああ、これがOSSへの貢献なんじゃないかと。</p>

<p>LinuxとかWebKitとか、大きなプロジェクトへの貢献を夢見てなんとなく憧れを抱いていたけど、今自分がやっていたことは紛れもなくOSS活動じゃないか。ずっとやりたいと思っていたことをいつの間にか僕はやっていた。誰かが仕事から帰ってちょこちょこっと作った小さなライブラリ僕が使い、僕が週末に作った小さなモジュールをどこかの誰かが使う。その誰かは日本の人かもしれないし、外国の人かもしれないし、人間ですらないかもしれない。(さっき見たら<a href="https://github.com/Lewuathe/node-jp">node-jp</a>はbotっぽいのにたくさんforkされてた)そういうコードを介した会話みたいなものはまさにソーシャルコーディングだし、僕はそれがやりたかった。</p>

<p>誰かが少しだけ世界を良くしようと思って作ったものを、他の誰かが使って実際に世界を少しだけ良くしている。大きさとか規模はあんまり関係なくて自分がそれを感じることができるかどうか。僕は見ず知らずの人からpatchが送られてくることでそれを感じた。</p>

<p>またいつでもpatchが来てもいいように、折角なので自動化テストを書いておこう。</p>

<p>きっと世界が少しだけ良くなると思う。</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/10/20/dockerwoshi-tutemiyou/">Dockerで仮想化をはじめよう</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-10-20T20:30:00+09:00" pubdate data-updated="true">Oct 20<span>th</span>, 2013</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>仮想環境構築の方法のひとつに<a href="http://www.docker.io/">Docker</a>を使ってみた。いままではVirtualBoxを使ってVagrantからつないでいく方法をやってみたけれど、仮想マシンをいちいち立ち上げる方法はどうも遅いのでDockerというもので試してみた。</p>

<p>Dockerの特徴は以下記事から抜粋。</p>

<p><a href="http://apatheia.info/blog/2013/06/17/docker/">http://apatheia.info/blog/2013/06/17/docker/</a></p>

<ul>
<li>仮想マシンを立ち上げるわけではなく、ホスト内の隔離された環境で動作するため起動が速い。<a href="http://linuxcontainers.org/">LXC</a>という技術のことらしい。ここでこの隔離されたシステムのことを <strong>コンテナ</strong> という。</li>
<li>AUFSを使っている。起動したときはディレクトリを重ねあわせておいて、更新の際に別の場所に書き込むというファイルシステムっぽい。立ち上げ時にイメージコピーがいらないので起動が軽い。</li>
</ul>


<h2>動かしてみた</h2>

<p>環境は以下で行った</p>

<ul>
<li>MacOSX 10.8</li>
<li>VirtualBox 4.2</li>
<li>vagrant 1.2.4</li>
</ul>


<p>他にUbuntu LTS12.04が入ったマシンを持っていたのでVagrant使わずにそっちでトライしたら32bitだとだめらしい。どうもUbuntu日本語コミュニティには32bitイメージしかなかったのでぼけーっと入れたらそっちになってしまったみたい。また入れなおすのもとりあえずめんどくさいのでMacのVagrantにUbuntu仮想マシンを立ち上げてその上にDockerを起動させるという構成。</p>

<p><a href="http://docs.docker.io/en/latest/installation/vagrant/">ここ</a>に従えば特に問題なくいけた。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ git clone https://github.com/dotcloud/docker.git
</span><span class='line'>$ cd docker
</span><span class='line'>$ vagrant up</span></code></pre></td></tr></table></div></figure>


<p>ここまでで10minくらいかかる。でも悪いのはVirtualBoxとvagrant。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># dockerが起動するか見てみる
</span><span class='line'>$ docker
</span><span class='line'># サブコマンドがだーっと出る</span></code></pre></td></tr></table></div></figure>


<h2>イメージをダウンロード</h2>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ sudo docker pull ubuntu</span></code></pre></td></tr></table></div></figure>


<h2>先ほどのコンテナ内でスクリプトを動作させる</h2>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># sudo docker run &lt;実行対象コンテナ&gt; &lt;コマンド(引数あってもいい)&gt;
</span><span class='line'>$ sudo docker run ubuntu /bin/echo hello world</span></code></pre></td></tr></table></div></figure>


<p>別にsudoはなくてもいい
これらはDockerのコンテナ内で実行されているコマンドだが、いまいち仮想ホスト立てている感じにならない。それを感じるためにはDockerをdaemon化させる必要がある。</p>

<h2>コマンドをdaemon化させる</h2>

<p>走らせるコマンドを定義する。このコマンドはコンテナのIDを返す。このIDをもとにそのコンテナで何がおきているかを見る
-dはコマンドをdaemon化させるオプション</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ CONTAINER_ID=$(sudo docker run -d ubuntu /bin/sh -c "while true; do echo hello world; sleep 1; done")</span></code></pre></td></tr></table></div></figure>


<p>そして起動させる。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ sudo docker logs $CONTAINER_ID</span></code></pre></td></tr></table></div></figure>


<p>さっきのコンテナIDが返ってくるのでこいつを<code>docker logs</code>に渡してやると実行されているコマンドの値が見えるようになる。たただしこれは実行が終わったら返ってくるのでリアルタイムにコマンドの結果を見たければ<code>attach</code>を使う</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ sudo docker attach $CONTAINER_ID</span></code></pre></td></tr></table></div></figure>


<p>ここまで適当にやっていったら、いっぱいコンテナができてしまったので確認してみる。dockerが起動したコマンドたちを確認する場合は<code>ps</code>サブコマンドを使う。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ docker ps
</span><span class='line'>ID                  IMAGE               COMMAND                CREATED             STATUS              PORTS
</span><span class='line'>4841794938a7        ubuntu:12.04        /bin/sh -c while tru   7 minutes ago       Up 7 minutes            
</span><span class='line'>79b862e271bc        ubuntu:12.04        /bin/sh -c while tru   8 minutes ago       Up 8 minutes                  
</span><span class='line'>bee9d7a00611        ubuntu:12.04        /bin/sh -c while tru   9 minutes ago       Up 9 minutes           </span></code></pre></td></tr></table></div></figure>


<p>こいつらをとめたければ<code>stop</code>を使う</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ sudo docker stop 4841794938a7 
</span><span class='line'>4841794938a7 
</span><span class='line'>
</span><span class='line'>$ sudo docker ps
</span><span class='line'>ID                  IMAGE               COMMAND                CREATED             STATUS              PORTS
</span><span class='line'>79b862e271bc        ubuntu:12.04        /bin/sh -c while tru   13 minutes ago      Up 13 minutes             
</span><span class='line'>bee9d7a00611        ubuntu:12.04        /bin/sh -c while tru   14 minutes ago      Up 14 minutes                    </span></code></pre></td></tr></table></div></figure>


<h2>まとめ</h2>

<p>今回のチュートリアルは<a href="http://docs.docker.io/en/latest/examples/hello_world/#running-examples">ここ</a>からすべてとった。Dockerかなり簡単だけれど、いまいちコマンドをひとつひとつ打っているだけな気がして仮想マシンをたてて、実行している感じがあまりしない。ここで実際にWebアプリとか作ることとかもできるっぽいのでもうちょっと見ていこうかと。</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/10/18/masutasenseihaxu-wotukanai/">マスターセンセイは嘘をつかない</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-10-18T22:25:00+09:00" pubdate data-updated="true">Oct 18<span>th</span>, 2013</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>仕事で、あるアジャイルプロジェクトに関わってきた。</p>

<p>スクラムマスターとなり、初めてのアジャイルプロジェクトを進めてもう3ヶ月ほどになる。</p>

<p>今日、アジャイルのススメ方についてこれまでも指導をくれていた人から幾つか言葉をもらったので
これまでの３ヶ月、これからのこと、アジャイルですすめることの本質とか考えてみたのでまとめる。</p>

<p>ちなみにこの人は僕の中ではマスターセンセイと呼んでいるので、以下同一人物。</p>

<h2>無理はしない</h2>

<p>アジャイルの根底にある本質を一言で表せと言われたらこの言葉になると思う。無理はしないというと消極的に思われるかもしれないので
足るを知ると言ってもいいかもしれない。自分たちに何ができて何ができないかをきちんと知ろうという姿勢はあるような気がする。
毎日のデイリースクラムに遅刻してくるメンバーがいたら彼が来られるようにしてあげるか、あるいは彼が来られる時間にしてあげるかだ。
もちろん無理はあってはいけないから彼が無理しなくては来られないのであれば前者はなしだ。プロジェクトを進める上で無理はあってはいけない。
それはリスクの増加につながるからだ。</p>

<p><img src="/images/posts/2013-10-18-agile_scrum/daily_scrum.png" alt="Daily Scrum" /></p>

<h2>「使うかもしれない」はきっと「使わない」</h2>

<p>今考えられるユーザストーリとか、タスクとか。スクラムにあったら便利かもと思うようなツールとかスキーマとか。そういうものを
必要になっていないのに取り出しはじめるのは良くないということ。具体的に言おう。僕達は各タスクに「優先度シール」なるものを
貼っていたときがある。これはプロダクトバックログがまだ優先度順に並んでいなくてコンポーネントごとに貼り付けてしまっていたことが
原因だった。（つまり優先順位順に並べることができなかった）その中でも何を優先するべきかを表示するラベルを僕達は作った。そして捨てた。
もうユーザストーリリストごとにタスクをリストアップできるようになったからだ。それでも「優先度シール」あっても良かったかもしれない。
だっていつか「使うかもしれない」。またプロダクトバックログの順序がばらばらになる時がくるかもしれない。
悩んでいるとマスターセンセイは教えてくれた。</p>

<blockquote><p>でもそれは捨てるべきなんだ。</p></blockquote>


<p><img src="/images/posts/2013-10-18-agile_scrum/rolex.png" alt="Trash" /></p>

<p>必要になったらまた作ればいい。アジャイルというのは小回りを効かせるために身軽さを求めるものなのかもしれない。
プロジェクトのフレームワークに必要のなくなった「もの」は基本的にはその場から捨ててしまうのがいい。
アジャイルをすすめる前に決めたインセプションデッキの問いのひとつにはこんなものがある。</p>

<p>「なぜ僕たちはここにいるのか」</p>

<p>この「使うかもしれない」を増やしていくとこの問に答えづらくなっていってしまうんじゃないかな。と僕は思う。</p>

<p>ちなみにマスターセンセイは『<a href="http://www.amazon.co.jp/%E3%83%88%E3%83%A8%E3%82%BF%E3%81%AE%E7%89%87%E3%81%A5%E3%81%91-OJT%E3%82%BD%E3%83%AA%E3%83%A5%E3%83%BC%E3%82%B7%E3%83%A7%E3%83%B3%E3%82%BA/dp/4806145483">トヨタの片付け</a>』という本も紹介してくれた。</p>

<h2>兼務はしない</h2>

<p>１人が１度に抱えるタスクは最大で２つまでだ。これは『<a href="http://www.amazon.co.jp/%E3%82%A2%E3%82%B8%E3%83%A3%E3%82%A4%E3%83%AB%E3%81%AA%E8%A6%8B%E7%A9%8D%E3%82%8A%E3%81%A8%E8%A8%88%E7%94%BB%E3%81%A5%E3%81%8F%E3%82%8A-~%E4%BE%A1%E5%80%A4%E3%81%82%E3%82%8B%E3%82%BD%E3%83%95%E3%83%88%E3%82%A6%E3%82%A7%E3%82%A2%E3%82%92%E8%82%B2%E3%81%A6%E3%82%8B%E6%A6%82%E5%BF%B5%E3%81%A8%E6%8A%80%E6%B3%95~-Mike-Cohn/dp/4839924023/ref=sr_1_1?s=books&amp;ie=UTF8&amp;qid=1382104183&amp;sr=1-1&amp;keywords=%E3%82%A2%E3%82%B8%E3%83%A3%E3%82%A4%E3%83%AB%E3%81%AA%E8%A6%8B%E7%A9%8D%E3%82%82%E3%82%8A%E3%81%A8%E8%A8%88%E7%94%BB%E3%81%A5%E3%81%8F%E3%82%8A">アジャイルな見積もりと計画づくり</a>』の中で語られているデータにもとづいている。その中で語られていることはこうだ。</p>

<ul>
<li>マルチタスク化は生産性に甚大な悪影響を与える</li>
<li>クラークとウィールライトによるマルチタスク化の研究で、個人が3つ以上の作業を並行して進めると、価値を生み出す作業に使える時間が大幅に減少することがわかった</li>
<li>2つの作業を変更に進めると、片方の作業が進められなくなったときに、もう片方の作業に切り替えることができるため、効率があがる</li>
</ul>


<p>僕達はずっと兼務を続けていた。しかも兼務をしているにもかかわらずアジャイルの中でのタスク割り振りまで重複して行ってしまっていた。これはまずい。
これは理由はどうあれ効率が落ちるからだ。データが示している。タスクAとタスクBをこなす必要があるのであれば、必ずAの次にBだ(もちろんBの次にAでもいいが同時はダメだ)
本の中では2つのタスクは気分転換の意味もあり、少しではあるが１０%ほど効率があがると書いてあるが、僕達はそもそもが兼務で集まったチームなのでダメだ。
人間は最大のパフォーマンスを発揮して且つ１度にできることは１つなのだと思う。マスターセンセイはこう言っていた。</p>

<blockquote><p>僕達みたいな普通の人がマルチタスクで片手間に作ったものなんて大したものができないんだよ</p></blockquote>


<p><img src="/images/posts/2013-10-18-agile_scrum/enough.png" alt="Enough!" /></p>

<p>非凡な才能溢れる人間でない限りは複数のことを１度に進めてはいけない。</p>

<h2>おまじないなんてない</h2>

<p>アジャイルで進めているプラクティスはどれもデータにもとづいて考えられたものだ。だからそこにおまじないはない。「どうしてこれをやっているんだろう」と思ったら
それは調べるべきだ。きっと答えはある。僕達はバーンダウンチャートを書いていく上で正規のタスク見積もり線の上に３掛けした線をもう一本引いていた。
どうしてかって。僕達がお手本にしていたプロジェクトが行っていたからだ。でもその理由は知らない。さりげなくそのことについてマスターセンセイに聞いた。</p>

<blockquote><p>上の線は本来はメンバーの持てるのすべての時間を表す。そこから７掛けして見積もり線を出せば各タスクのバッファを考えずにスプリント単位でずれを吸収してくれるんだよ</p></blockquote>


<p>なるほど、そういうことだったのか。</p>

<p>ちなみにこの７割という数字も多くのプロジェクトを研究して出した数字らしい。</p>

<p><img src="/images/posts/2013-10-18-agile_scrum/magic.png" alt="magic" /></p>

<p>教訓：疑問に思ったら調べろ</p>

<h2>まとめ</h2>

<p>３ヶ月で何が分かるかというぐらいアジャイルは奥深い。けれど最後に書いたようにアジャイルスクラムは魔法のメソッドなんてものではなくて、自分で考え試行錯誤していかなくちゃいけないものだとわかった。</p>

<p>でもひとつ大事なことは、アジャイルには「無理をしない」という点で１つ筋が通っているような気がした。できるものはできないし、できないものはできない。そのことをなんとなしに言ってしまうのではなくきちんと計測可能な数値で考えることができるフレームワークがアジャイルスクラムなのだと思う。</p>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/blog/page/5/">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/blog/page/3/">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2014/03/10/difference-between-pca-and-da/">Difference Between PCA and dA</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/03/09/logistics-regression-with-sparse-vector/">Logistics Regression With Sparse Vector</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/03/08/memento-pattern-in-java/">Memento Pattern in Java</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/03/06/how-is-hashtable-written-in-java/">How Is HashMap Written in Java</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/03/03/topcoder-with-intellij-idea/">TopCoder With IntelliJ IDEA</a>
      </li>
    
  </ul>
</section>





  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2014 - Kai Sasaki -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id; js.async = true;
  js.src = "//connect.facebook.net/ja_JP/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>





  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
